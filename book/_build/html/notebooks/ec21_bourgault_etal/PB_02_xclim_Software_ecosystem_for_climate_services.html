
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>xclim: Software ecosystem for climate services &#8212; EarthCube 2021 Call for Notebooks</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="cf-xarray: Scale your analysis across datasets with less data wrangling and more metadata handling" href="../ec21_cherian_etal/DC_01_cf-xarray.html" />
    <link rel="prev" title="xclim : Software ecosystem for climate services" href="README.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.webp" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">EarthCube 2021 Call for Notebooks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/about.html">
   Call for Notebooks
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   2021 Notebooks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_anil_etal/README.html">
     ec21_binder_anil
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_anil_etal/SA_01_Argo_Data_Exploration.html">
       Interactive Jupyter notebook for hydrographic ocean data exploration, retrieval and visualization via the Argovis API
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_balwada_etal/README.html">
     ec2021_balwada_etal
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_balwada_etal/DB_01_Glider_Viz_Panel.html">
       Glider Viz Panel
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_beckley_etal/README.html">
     Programmatic Access to OpenTopography’s Cloud Optimized Geotiff (COG) Global Datasets
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_beckley_etal/OT_01_BulkAccessCOGs.html">
       Programmatic Access to OpenTopography’s Cloud Optimized GeoTIFF (COG) Global Datasets
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="README.html">
     xclim : Software ecosystem for climate services
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       xclim: Software ecosystem for climate services
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_cherian_etal/DC_01_cf-xarray.html">
     cf-xarray: Scale your analysis across datasets with less data wrangling and more metadata handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_cych_etal/BC_01%20Bias%20Corrected%20Estimation%20of%20Paleointensity.html">
     BC_01 Bias Corrected Estimation of Paleointensity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_dye_etal/README.html">
     Toward autonomous detection of anomalous GNSS data via applied unsupervised artificial intelligence
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_garzon_etal/README.html">
     Exploring Research Data Repositories with geoextent.
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_garzon_etal/showcase/SG_01_Exploring_Research_Data_Repositories_with_geoextent.html">
       Exploring Research Data Repositories with geoextent
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_gray_etal/README.html">
     Leveraging satellite data and pangeo to investigate the role of Gulf Stream frontal dynamics in ocean productivity
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_gray_etal/PG_01_gulf_stream_dynamics_role_in_productivity.html">
       Leveraging satellite data and pangeo to investigate the role of Gulf Stream frontal dynamics in ocean productivity
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_hu_etal/README.html">
     Machine Learning Guided Weather Analogs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_hu_etal/WH_01_Spatio-Temporal_Deep_Analogs_2021.html">
       WH_01_Spatio-Temporal_Deep_Analogs_2021
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_lopez_etal/README.html">
     ITS_LIVE Explorer
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_lopez_etal/notebooks/itslive-notebook-rendered.html">
       Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_lopez_etal/notebooks/itslive-notebook.html">
       Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_lopez_etal/notebooks/LL_01_ITS_LIVE_global_glacier_velocity_exploration_and_analysis.html">
       <strong>
        ITS_LIVE
       </strong>
       Global Glacier Velocity Exploration and Analysis
       <a class="anchor" id="chapter_1">
       </a>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_martin_etal/README.html">
     Frequency-domain analysis of large datasets
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_martin_etal/PM_01_Frequency-Domain_Analysis_of_Large_Datasets.html">
       Frequency-Domain Analysis of Large Datasets
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_mason_etal/README.html">
     Volcanic Activity Detection
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_maussion_etal/README.html">
     OGGM-edu EarthCube notebook
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_maussion_etal/FM_01_OGGM-Edu_learn_and_teach_about_glaciers.html">
       OGGM-Edu - Jupyter notebooks to learn and teach about glaciers
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_potnis_etal/README.html">
     JP_01_Real_Time_Alignment_and_Distribution_of_Weather_Radar_Data_with_Rain_Gauge_Data_for_Deep_Learn
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_potnis_etal/JP_01_Real_Time_Alignment_and_Distribution_of_Weather_Radar_Data_with_Rain_Gauge_Data_for_Deep_Learning_using_CHORDS.html">
       Real Time Alignment and Distribution of Weather Radar Data with Rain Gauge Data for Deep Learning using CHORDS
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_seijo_etal/README.html">
     click Binder badge to launch notebook on Binder (no need to install environment):
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_shi_etal/README.html">
     EC2021: Automated Machine Learning for Earth Science via AutoGluon
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_shi_etal/Xingjian_Shi_01_Automated_Machine_Learning_for_Earth_Science_via_AutoGluon.html">
       Automated Machine Learning for Earth Science via AutoGluon
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_uchida_etal/notebooks/TU_05_Diagnosing-the-Eliassen-Palm-flux-from-a-quasi-geostrophic-double-gyre-ensemble.html">
     Diagnosing the Eliassen-Palm flux from a quasi-geostrophic double gyre ensemble
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../ec21_zheng_etal/README.html">
     EZ-FeatureTrack
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../ec21_zheng_etal/notebooks/WZ_01_mapping_ice_flow_velocity.html">
       Mapping ice flow velocity using an easy and interactive feature tracking workflow
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/ec21_bourgault_etal/PB_02_xclim_Software_ecosystem_for_climate_services.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/earthcube2021/ec21_book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/earthcube2021/ec21_book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/ec21_bourgault_etal/PB_02_xclim_Software_ecosystem_for_climate_services.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/earthcube2021/ec21_book/master?urlpath=tree/book/notebooks/ec21_bourgault_etal/PB_02_xclim_Software_ecosystem_for_climate_services.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   xclim: Software ecosystem for climate services
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#author-s">
     Author(s)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#purpose">
     Purpose
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#technical-contributions">
     Technical contributions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#methodology">
     Methodology
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#results">
     Results
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#funding">
     Funding
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#keywords">
     Keywords
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#citation">
     Citation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#suggested-next-steps">
     Suggested next steps
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acknowledgements">
     Acknowledgements
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#library-import">
     Library import
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-import">
   Data import
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-processing-and-analysis">
   Data processing and analysis
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#climate-indices-computation-and-ensemble-statistics">
     Climate indices computation and ensemble statistics
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#creating-the-ensemble-dataset">
       Creating the ensemble dataset
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-climate-indicators">
       Compute climate indicators
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ensemble-statistics">
       Ensemble statistics
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bias-adjustment">
     Bias-adjustment
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#simple-quantile-mapping">
       Simple quantile mapping
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finch-xclim-as-a-service">
     Finch : xclim as a service
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#what-is-a-wps">
       What is a WPS?
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#chain-computations">
       Chain computations
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Ensemble statistics
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Bias-adjustment
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#software-used">
     Software used
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="xclim-software-ecosystem-for-climate-services">
<h1>xclim: Software ecosystem for climate services<a class="headerlink" href="#xclim-software-ecosystem-for-climate-services" title="Permalink to this headline">¶</a></h1>
<div class="section" id="author-s">
<h2>Author(s)<a class="headerlink" href="#author-s" title="Permalink to this headline">¶</a></h2>
<p>List authors, their current affiliations,  up-to-date contact information, and ORCID if available. Add as many author lines as you need.</p>
<ul class="simple">
<li><p>Author1 = {“name”: “Pascal Bourgault”, “affiliation”: “Ouranos Inc”, “email”: “<a class="reference external" href="mailto:bourgault&#46;pascal&#37;&#52;&#48;ouranos&#46;ca">bourgault<span>&#46;</span>pascal<span>&#64;</span>ouranos<span>&#46;</span>ca</a>”, “orcid”: “0000-0003-1192-0403”}</p></li>
<li><p>Author2 = {“name”: “Travis Logan”, “affiliation”: “Ouranos Inc”, “email”: “<a class="reference external" href="mailto:logan&#46;travis&#37;&#52;&#48;ouranos&#46;ca">logan<span>&#46;</span>travis<span>&#64;</span>ouranos<span>&#46;</span>ca</a>”, “orcid”: “0000-0002-2212-9580”}</p></li>
<li><p>Author3 = {“name”: “David Huard”, “affiliation”: “Ouranos Inc”, “email”: “<a class="reference external" href="mailto:huard&#46;david&#37;&#52;&#48;ouranos&#46;ca">huard<span>&#46;</span>david<span>&#64;</span>ouranos<span>&#46;</span>ca</a>”, “orcid”: “0000-0003-0311-5498”}</p></li>
<li><p>Author4 = {“name”: “Trevor J. Smith”, “affiliation”: “Ouranos Inc”, “email”: “<a class="reference external" href="mailto:smith&#46;trevorj&#37;&#52;&#48;ouranos&#46;ca">smith<span>&#46;</span>trevorj<span>&#64;</span>ouranos<span>&#46;</span>ca</a>”, “orcid”: “0000-0001-5393-8359”}</p></li>
</ul>
<h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#xclim:-Software-ecosystem-for-climate-services" data-toc-modified-id="xclim:-Software-ecosystem-for-climate-services-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>xclim: Software ecosystem for climate services</a></span><ul class="toc-item"><li><span><a href="#Author(s)" data-toc-modified-id="Author(s)-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Author(s)</a></span></li><li><span><a href="#Purpose" data-toc-modified-id="Purpose-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Purpose</a></span></li><li><span><a href="#Technical-contributions" data-toc-modified-id="Technical-contributions-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Technical contributions</a></span></li><li><span><a href="#Methodology" data-toc-modified-id="Methodology-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>Methodology</a></span></li><li><span><a href="#Results" data-toc-modified-id="Results-1.5"><span class="toc-item-num">1.5&nbsp;&nbsp;</span>Results</a></span></li><li><span><a href="#Funding" data-toc-modified-id="Funding-1.6"><span class="toc-item-num">1.6&nbsp;&nbsp;</span>Funding</a></span></li><li><span><a href="#Keywords" data-toc-modified-id="Keywords-1.7"><span class="toc-item-num">1.7&nbsp;&nbsp;</span>Keywords</a></span></li><li><span><a href="#Citation" data-toc-modified-id="Citation-1.8"><span class="toc-item-num">1.8&nbsp;&nbsp;</span>Citation</a></span></li><li><span><a href="#Suggested-next-steps" data-toc-modified-id="Suggested-next-steps-1.9"><span class="toc-item-num">1.9&nbsp;&nbsp;</span>Suggested next steps</a></span></li><li><span><a href="#Acknowledgements" data-toc-modified-id="Acknowledgements-1.10"><span class="toc-item-num">1.10&nbsp;&nbsp;</span>Acknowledgements</a></span></li></ul></li><li><span><a href="#Setup" data-toc-modified-id="Setup-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Setup</a></span><ul class="toc-item"><li><span><a href="#Library-import" data-toc-modified-id="Library-import-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Library import</a></span></li></ul></li><li><span><a href="#Data-import" data-toc-modified-id="Data-import-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Data import</a></span></li><li><span><a href="#Data-processing-and-analysis" data-toc-modified-id="Data-processing-and-analysis-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Data processing and analysis</a></span><ul class="toc-item"><li><span><a href="#Climate-indices-computation-and-ensemble-statistics" data-toc-modified-id="Climate-indices-computation-and-ensemble-statistics-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Climate indices computation and ensemble statistics</a></span><ul class="toc-item"><li><span><a href="#Creating-the-ensemble-dataset" data-toc-modified-id="Creating-the-ensemble-dataset-4.1.1"><span class="toc-item-num">4.1.1&nbsp;&nbsp;</span>Creating the ensemble dataset</a></span></li><li><span><a href="#Compute-climate-indicators" data-toc-modified-id="Compute-climate-indicators-4.1.2"><span class="toc-item-num">4.1.2&nbsp;&nbsp;</span>Compute climate indicators</a></span></li><li><span><a href="#Ensemble-statistics" data-toc-modified-id="Ensemble-statistics-4.1.3"><span class="toc-item-num">4.1.3&nbsp;&nbsp;</span>Ensemble statistics</a></span></li></ul></li><li><span><a href="#Bias-adjustment" data-toc-modified-id="Bias-adjustment-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Bias-adjustment</a></span><ul class="toc-item"><li><span><a href="#Simple-quantile-mapping" data-toc-modified-id="Simple-quantile-mapping-4.2.1"><span class="toc-item-num">4.2.1&nbsp;&nbsp;</span>Simple quantile mapping</a></span></li></ul></li><li><span><a href="#Finch-:-xclim-as-a-service" data-toc-modified-id="Finch-:-xclim-as-a-service-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>Finch : xclim as a service</a></span><ul class="toc-item"><li><ul class="toc-item"><li><span><a href="#What-is-a-WPS?" data-toc-modified-id="What-is-a-WPS?-4.3.0.1"><span class="toc-item-num">4.3.0.1&nbsp;&nbsp;</span>What is a WPS?</a></span></li></ul></li><li><span><a href="#Chain-computations" data-toc-modified-id="Chain-computations-4.3.1"><span class="toc-item-num">4.3.1&nbsp;&nbsp;</span>Chain computations</a></span></li><li><span><a href="#Ensemble-statistics" data-toc-modified-id="Ensemble-statistics-4.3.2"><span class="toc-item-num">4.3.2&nbsp;&nbsp;</span>Ensemble statistics</a></span></li></ul></li></ul></li><li><span><a href="#References" data-toc-modified-id="References-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>References</a></span><ul class="toc-item"><li><ul class="toc-item"><li><span><a href="#Bias-adjustment" data-toc-modified-id="Bias-adjustment-5.0.1"><span class="toc-item-num">5.0.1&nbsp;&nbsp;</span>Bias-adjustment</a></span></li></ul></li></ul></li></ul></div></div>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>This notebook presents <a class="reference external" href="https://xclim.readthedocs.io/en/stable/"><code class="docutils literal notranslate"><span class="pre">xclim</span></code></a>, a python package allowing easy manipulation and analysis of N-D climate dataset. It goes in details on what tools xclim provides, and how it simplifies and standardizes climate analyses workflows. The notebook also demontrates how xclim functionality can be exposed as a Web Processing Service (<a class="reference external" href="http://opengeospatial.github.io/e-learning/wps/text/basic-main.html">WPS</a>) through <a class="reference external" href="https://pavics-sdi.readthedocs.io/projects/finch/en/latest/"><code class="docutils literal notranslate"><span class="pre">finch</span></code></a>. This notebook was developped for Python 3.7+, but expects a special python environment and a running instance of finch. The configuration is optimized for running on <code class="docutils literal notranslate"><span class="pre">binder</span></code>.</p>
</div>
<div class="section" id="technical-contributions">
<h2>Technical contributions<a class="headerlink" href="#technical-contributions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Development of a climate analysis library regrouping many different tools, with special attention to community standards (especially <a class="reference external" href="https://cfconventions.org/">CF</a>) and computationally efficient implementations.</p>
<ul>
<li><p>Numerically efficient climate indices algorithms yielding standard-compliant outputs;</p></li>
<li><p>Model ensemble statistics and robustness metrics</p></li>
<li><p>Bias-adjustment algorithms</p></li>
<li><p>Other tools (not shown in this notebook) (subsetting, spatial analogs, calendar conversions)</p></li>
</ul>
</li>
<li><p>Development of a web service exposing climate analysis processes through OGC’s WPS protocol.</p></li>
</ul>
</div>
<div class="section" id="methodology">
<h2>Methodology<a class="headerlink" href="#methodology" title="Permalink to this headline">¶</a></h2>
<p>This notebook shows two examples of climate analysis workflows:</p>
<ol class="simple">
<li><p>Calculating climate indices on an ensemble of simulation data, then computing ensemble statistics;</p></li>
<li><p>Bias-adjustment of model data.</p></li>
<li><p>Calculating climate indices through a web service (<code class="docutils literal notranslate"><span class="pre">finch</span></code>).</p></li>
</ol>
<p>The examples interleave code and markdown cells to describe what is being done. They also include some graphics created with  holoviews, in order to give a clearer idea of what was achieved.</p>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>This notebook demontrates how the use of xclim can help simplify and standardize climate analysis workflows.</p>
</div>
<div class="section" id="funding">
<h2>Funding<a class="headerlink" href="#funding" title="Permalink to this headline">¶</a></h2>
<p>This project benefitted from direct and indirect funding from multiple sources, which are cited in the “Acknowledgements” section below.</p>
</div>
<div class="section" id="keywords">
<h2>Keywords<a class="headerlink" href="#keywords" title="Permalink to this headline">¶</a></h2>
<p>keywords=[“climate”, “xarray”, “bias-adjustment”, “wps”]</p>
</div>
<div class="section" id="citation">
<h2>Citation<a class="headerlink" href="#citation" title="Permalink to this headline">¶</a></h2>
<p>Bourgault, Pascal et al. Ouranos, 2021. xclim: Software ecosystem for climate services. Accessed 2021/05/15 at <a class="reference external" href="https://github.com/Ouranosinc/xclim/blob/earthcube-nb/docs/notebooks/PB_01_xclim_Software_ecosystem_for_climate_services.ipynb">https://github.com/Ouranosinc/xclim/blob/earthcube-nb/docs/notebooks/PB_01_xclim_Software_ecosystem_for_climate_services.ipynb</a></p>
</div>
<div class="section" id="suggested-next-steps">
<h2>Suggested next steps<a class="headerlink" href="#suggested-next-steps" title="Permalink to this headline">¶</a></h2>
<p>After reading through this notebook, we recommend looking at xclim’s documentation, especially the <a class="reference external" href="https://xclim.readthedocs.io/en/stable/notebooks/index.html">examples</a> page, where other notebooks extend the examples shown here. Xclim offers other features that are not shown here, but might be of interest to readers : <a class="reference external" href="https://xclim.readthedocs.io/en/stable/api.html#module-xclim.analog">a spatial analogs submodule</a> and <a class="reference external" href="https://xclim.readthedocs.io/en/stable/internationalization.html">internationalization utilities</a>, among others. The <a class="reference external" href="https://xclim.readthedocs.io/en/stable/indicators.html">list of indicators</a> is also a good stop, and is regularly updated with new algorithms. It covers most indicators from <a class="reference external" href="https://xclim.readthedocs.io/en/stable/indicators.html#icclim-indices">ECAD</a> to more complex and specialized one, like the <a class="reference external" href="https://xclim.readthedocs.io/en/stable/indices.html#fire-weather-indices-submodule">Fire Weather Indexes</a>.</p>
<p>The web service demontrated here is part of the <a class="reference external" href="http://bird-house.github.io/"><code class="docutils literal notranslate"><span class="pre">bird-house</span></code></a> ecosystem and project. It is used by different platforms, such as <a class="reference external" href="https://pavics.ouranos.ca/">PAVICS</a> and <a class="reference external" href="https://climatedata.ca">climatedata.ca</a>.</p>
</div>
<div class="section" id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>Much of the development work of xclim was done to support climate services delivery at <a class="reference external" href="https://ouranos.ca">Ouranos</a> and the <a class="reference external" href="https://www.canada.ca/en/environment-climate-change/services/climate-change/canadian-centre-climate-services.html">Canadian Centre for Climate Services</a>, and was funded by Environment and Climate Change Canada (ECCC). It has become a core component of the Power Analytics and Visualization for Climate Science (PAVICS) platform (Ouranos and CRIM 2021). PAVICS has been funded by <a class="reference external" href="https://canarie.ca">CANARIE</a> and the Québec Fonds Vert, and through other projects also benefits from the support of the Canadian Foundation for Innovation (CFI) and the Fonds de Recherche du Québec (FRQ). PAVICS is a joint effort of Ouranos and the Centre de Recherche en Informatique de Montréal (CRIM). xclim itself</p>
</div>
</div>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="library-import">
<h2>Library import<a class="headerlink" href="#library-import" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xclim</span>
<span class="c1"># Also import some submodules for direct access</span>
<span class="kn">import</span> <span class="nn">xclim.ensembles</span>  <span class="c1"># Ensemble creation and statistics</span>
<span class="kn">import</span> <span class="nn">xclim.sdba</span>  <span class="c1"># Bias-adjustment</span>

<span class="c1"># Data manipulation</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">xclim.testing</span>

<span class="c1"># For interacting with finch WPS</span>
<span class="kn">import</span> <span class="nn">birdy</span>

<span class="c1"># Visualizations and display</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">dask.diagnostics</span> <span class="kn">import</span> <span class="n">ProgressBar</span>

<span class="c1"># For handling file paths</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># Some little figure tweaking</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-deep&#39;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-darkgrid&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="data-import">
<h1>Data import<a class="headerlink" href="#data-import" title="Permalink to this headline">¶</a></h1>
<p>In the first part, we use the “Ouranos standard ensemble of bias-adjusted climate scenarios version 1.0”, bias-adjusted and downscaled data from Ouranos. It includes 11 simulations from different climate models, all produced in the RCP8.5 experiment of the CMIP5 project. More information can be found on <a class="reference external" href="https://pavics.ouranos.ca/datasets.html">this page</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>du -hs data/*.nc
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>852K	data/ACCESS1-3_rcp85_singlept_1950-2100.nc
852K	data/BNU-ESM_rcp85_singlept_1950-2100.nc
852K	data/CanESM2_rcp85_singlept_1950-2100.nc
852K	data/CMCC-CMS_rcp85_singlept_1950-2100.nc
852K	data/GFDL-ESM2M_rcp85_singlept_1950-2100.nc
840K	data/HadGEM2-CC_rcp85_singlept_1950-2100.nc
852K	data/INM-CM4_rcp85_singlept_1950-2100.nc
848K	data/IPSL-CM5A-LR_rcp85_singlept_1950-2100.nc
848K	data/IPSL-CM5B-LR_rcp85_singlept_1950-2100.nc
852K	data/MPI-ESM-LR_rcp85_singlept_1950-2100.nc
852K	data/NorESM1-M_rcp85_singlept_1950-2100.nc
</pre></div>
</div>
</div>
</div>
<p>The second example, dealing with bias-adjustment, will use two sources. The model data comes from the <a class="reference external" href="https://www.canada.ca/en/environment-climate-change/services/climate-change/science-research-data/modeling-projections-analysis/centre-modelling-analysis/models/second-generation-earth-system-model.html">CanESM2 model</a> of CCCma. The reference time series are extracted from the Adjusted and Homogenized Canadian Climate Data (<a class="reference external" href="https://open.canada.ca/data/en/dataset/9c4ebc00-3ea4-4fe0-8bf2-66cfe1cddd1d">AHCCD</a>), from Environment and Climate Change Canada. Both datasets are distributed under the Open Government Licence (Canada).
We chose three weather stations representative of a reasonable range of climatic conditions and extracted time series over those locations from the model data.</p>
<p>Finally, the third section will use two datasets. A first one extracted from ECMWF’s <a class="reference external" href="https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era5">ERA5 reanalysis</a> includes time series extracted on a few locations for multiple variables. The second dataset is a subset of Natural Resources Canada (NRCAN)’s  daily dataset derived from observational data. See <a class="reference external" href="https://cfs.nrcan.gc.ca/projects/3/4">https://cfs.nrcan.gc.ca/projects/3/4</a>.</p>
</div>
<div class="section" id="data-processing-and-analysis">
<h1>Data processing and analysis<a class="headerlink" href="#data-processing-and-analysis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="climate-indices-computation-and-ensemble-statistics">
<h2>Climate indices computation and ensemble statistics<a class="headerlink" href="#climate-indices-computation-and-ensemble-statistics" title="Permalink to this headline">¶</a></h2>
<p>A large part of climate data analytics is based on the computation and comparison of climate indices. Xclim’s main goal is to make it easier for researchers to process climate data and calculate those indices. It does so by providing a large library of climate indices, grouped in categories (CMIP’s “realms”) for convenience, but also by providing tools for all the small tweaks and pre- and post-processing steps that such workflows require.</p>
<p>xclim is built on <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">xarray</span></code></span>, which itself makes it easy to scale computations using <a class="reference external" href="https://dask.org"><code class="docutils literal notranslate"><span class="pre">dask</span></code></a>. While many indices are conceptually  simple, we aim to provide implementations that balance performance and code complexity. This allows for ease in understanding and extending the code base.</p>
<p>In the following steps we will use xclim to:</p>
<ul class="simple">
<li><p>create an ensemble dataset,</p></li>
<li><p>compute a few climate indices,</p></li>
<li><p>calculate ensemble statistics on the results.</p></li>
</ul>
<div class="section" id="creating-the-ensemble-dataset">
<h3>Creating the ensemble dataset<a class="headerlink" href="#creating-the-ensemble-dataset" title="Permalink to this headline">¶</a></h3>
<p>In xclim, an “ensemble dataset” is simply an xarray <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> where multiple realizations of the same climate have been concatenated along a “realization” dimension. In our case here, as presented above, the realizations are in fact simulations from different models, but all have been bias-adjusted with the same reference. All ensemble-related functions are in the <a class="reference external" href="https://xclim.readthedocs.io/en/stable/api.html#module-xclim.ensembles"><code class="docutils literal notranslate"><span class="pre">ensembles</span></code></a> module.</p>
<p>Given a list of files, creating the ensemble dataset is straightforward:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get a list of files in the `earthcube_data`:</span>
<span class="c1"># The sort is not important here, it only ensures a consistent notebook output for automated checks</span>
<span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*1950-2100.nc&#39;</span><span class="p">)))</span>

<span class="c1"># Open files into the ensemble</span>
<span class="n">ens</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">ensembles</span><span class="o">.</span><span class="n">create_ensemble</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
<span class="n">ens</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (realization: 11, time: 55152)
Coordinates:
  * time         (time) datetime64[ns] 1950-01-01 1950-01-02 ... 2100-12-31
    lat          float32 47.21
    lon          float32 -70.3
  * realization  (realization) int64 0 1 2 3 4 5 6 7 8 9 10
Data variables:
    pr           (realization, time) float32 dask.array&lt;chunksize=(1, 55152), meta=np.ndarray&gt;
    tasmax       (realization, time) float32 dask.array&lt;chunksize=(1, 55152), meta=np.ndarray&gt;
    tasmin       (realization, time) float32 dask.array&lt;chunksize=(1, 55152), meta=np.ndarray&gt;
Attributes:
    Conventions:     CF-1.5
    title:           ACCESS1-3 model output prepared for CMIP5 historical
    history:         CMIP5 compliant file produced from raw ACCESS model outp...
    institution:     CSIRO (Commonwealth Scientific and Industrial Research O...
    source:          ACCESS1-3 2011. Atmosphere: AGCM v1.0 (N96 grid-point, 1...
    redistribution:  Redistribution prohibited. For internal use only.</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a73aeaf1-10ac-4b31-82df-293c1f9664a6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a73aeaf1-10ac-4b31-82df-293c1f9664a6' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>realization</span>: 11</li><li><span class='xr-has-index'>time</span>: 55152</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-76f3db4b-f9a8-406d-929a-ac8da7511566' class='xr-section-summary-in' type='checkbox'  checked><label for='section-76f3db4b-f9a8-406d-929a-ac8da7511566' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1950-01-01 ... 2100-12-31</div><input id='attrs-c739fbdf-db15-4625-a337-9e864b552cef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c739fbdf-db15-4625-a337-9e864b552cef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f1f7e4e-3529-41f4-8574-275c46ed1faa' class='xr-var-data-in' type='checkbox'><label for='data-8f1f7e4e-3529-41f4-8574-275c46ed1faa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1950-01-01T00:00:00.000000000&#x27;, &#x27;1950-01-02T00:00:00.000000000&#x27;,
       &#x27;1950-01-03T00:00:00.000000000&#x27;, ..., &#x27;2100-12-29T00:00:00.000000000&#x27;,
       &#x27;2100-12-30T00:00:00.000000000&#x27;, &#x27;2100-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>47.21</div><input id='attrs-385d94c1-dfb9-4fdc-9010-0681e934371c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-385d94c1-dfb9-4fdc-9010-0681e934371c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-48571478-6f9d-4466-89c9-2cf11a02dad0' class='xr-var-data-in' type='checkbox'><label for='data-48571478-6f9d-4466-89c9-2cf11a02dad0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array(47.20742, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-70.3</div><input id='attrs-d08f3965-f582-414d-9598-557fdcaff0b5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d08f3965-f582-414d-9598-557fdcaff0b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-694dcc4d-f1d0-41c1-8772-ccdb85f83c2e' class='xr-var-data-in' type='checkbox'><label for='data-694dcc4d-f1d0-41c1-8772-ccdb85f83c2e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array(-70.29596, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>realization</span></div><div class='xr-var-dims'>(realization)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9 10</div><input id='attrs-c753f1ab-668d-46a0-8214-ba3d666940d1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c753f1ab-668d-46a0-8214-ba3d666940d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89e9f9cc-5ec1-4530-b9c4-3fe4c34ee47e' class='xr-var-data-in' type='checkbox'><label for='data-89e9f9cc-5ec1-4530-b9c4-3fe4c34ee47e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>E</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1f9ee960-07a8-48de-9dc1-3b7bcfca7315' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1f9ee960-07a8-48de-9dc1-3b7bcfca7315' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>pr</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 55152), meta=np.ndarray&gt;</div><input id='attrs-1b72105a-e5d6-4e65-bbc6-fe999a55d610' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1b72105a-e5d6-4e65-bbc6-fe999a55d610' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f11277e2-47cb-43a0-aab3-2f14cc263e1c' class='xr-var-data-in' type='checkbox'><label for='data-f11277e2-47cb-43a0-aab3-2f14cc263e1c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm s-1</dd><dt><span>long_name :</span></dt><dd>lwe_precipitation_rate</dd><dt><span>standard_name :</span></dt><dd>lwe_precipitation_rate</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.31 MiB </td> <td> 215.44 kiB </td></tr>
    <tr><th> Shape </th><td> (11, 55152) </td> <td> (1, 55152) </td></tr>
    <tr><th> Count </th><td> 85 Tasks </td><td> 11 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="4" x2="120" y2="4" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="18" x2="120" y2="18" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >55152</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">11</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tasmax</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 55152), meta=np.ndarray&gt;</div><input id='attrs-1b881d5f-3845-486a-9f61-5a85533bae10' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1b881d5f-3845-486a-9f61-5a85533bae10' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fdbf5868-9957-4a95-a2e1-c342aacaac6c' class='xr-var-data-in' type='checkbox'><label for='data-fdbf5868-9957-4a95-a2e1-c342aacaac6c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>air_temperature</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.31 MiB </td> <td> 215.44 kiB </td></tr>
    <tr><th> Shape </th><td> (11, 55152) </td> <td> (1, 55152) </td></tr>
    <tr><th> Count </th><td> 85 Tasks </td><td> 11 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="4" x2="120" y2="4" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="18" x2="120" y2="18" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >55152</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">11</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tasmin</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 55152), meta=np.ndarray&gt;</div><input id='attrs-1725276b-92a7-41c8-9d66-372791471f34' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1725276b-92a7-41c8-9d66-372791471f34' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7bda7050-7d41-4302-a76e-0aaaaeab2715' class='xr-var-data-in' type='checkbox'><label for='data-7bda7050-7d41-4302-a76e-0aaaaeab2715' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>air_temperature</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.31 MiB </td> <td> 215.44 kiB </td></tr>
    <tr><th> Shape </th><td> (11, 55152) </td> <td> (1, 55152) </td></tr>
    <tr><th> Count </th><td> 85 Tasks </td><td> 11 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="4" x2="120" y2="4" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="18" x2="120" y2="18" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >55152</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">11</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-1efd2250-e483-435d-a962-2a72929843f1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1efd2250-e483-435d-a962-2a72929843f1' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.5</dd><dt><span>title :</span></dt><dd>ACCESS1-3 model output prepared for CMIP5 historical</dd><dt><span>history :</span></dt><dd>CMIP5 compliant file produced from raw ACCESS model output using the ACCESS Post-Processor and CMOR2. 2012-04-03T13:44:54Z CMOR rewrote data to comply with CF standards and CMIP5 requirements. Fri Apr 13 09:55:30 2012: forcing attribute modified to correct value Fri Apr 13 12:29:45 2012: corrected model_id from ACCESS1-3 to ACCESS1.3 Mon Jul  2 11:13:41 2012: updated version number to v20120413.
2016-01-19T03:26:16: Interpolate to nrcan_livneh grid.
2016-02-10T09:50:00: Bias correction using nrcan_livneh.</dd><dt><span>institution :</span></dt><dd>CSIRO (Commonwealth Scientific and Industrial Research Organisation, Australia), and BOM (Bureau of Meteorology, Australia)</dd><dt><span>source :</span></dt><dd>ACCESS1-3 2011. Atmosphere: AGCM v1.0 (N96 grid-point, 1.875 degrees EW x approx 1.25 degree NS, 38 levels); ocean: NOAA/GFDL MOM4p1 (nominal 1.0 degree EW x 1.0 degrees NS, tripolar north of 65N, equatorial refinement to 1/3 degree from 10S to 10 N, cosine dependent NS south of 25S, 50 levels); sea ice: CICE4.1 (nominal 1.0 degree EW x 1.0 degrees NS, tripolar north of 65N, equatorial refinement to 1/3 degree from 10S to 10 N, cosine dependent NS south of 25S); land: CABLE1.0 (1.875 degree EW x 1.25 degree NS, 6 levels
30-day moving window 50-bins quantile mapping with detrending.</dd><dt><span>redistribution :</span></dt><dd>Redistribution prohibited. For internal use only.</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>(Note: similarly to <code class="docutils literal notranslate"><span class="pre">xarray.open_mfdataset</span></code>, used internally, the dataset attributes are actually from the first file only.)</p>
<p>But how is this different from <code class="docutils literal notranslate"><span class="pre">xarray.concat(files,</span> <span class="pre">concat_dim='realization)</span></code>? While only slighlty more shorter to write, the main difference is the handling of incompatible calendars. Different models often use different <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.8/cf-conventions.html#calendar">calendars</a> and this causes issues when merging/concatening their data in xarray. Xclim provides <a class="reference external" href="https://xclim.readthedocs.io/en/stable/api.html#xclim.core.calendar.convert_calendar"><code class="docutils literal notranslate"><span class="pre">xclim.core.calendar.convert_calendar</span></code></a> to handle this. For example, in this ensemble, we have a simulation of the <code class="docutils literal notranslate"><span class="pre">HadGEM2</span></code> model which uses the “360_day” calendar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds360</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/HadGEM2-CC_rcp85_singlept_1950-2100.nc&#39;</span><span class="p">)</span>
<span class="n">ds360</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">59</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(cftime.Datetime360Day(1950, 2, 30, 0, 0, 0, 0), dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to the `noleap` calendar, see doc for details on arguments.</span>
<span class="n">ds365</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">calendar</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="n">ds360</span><span class="p">,</span> <span class="s1">&#39;noleap&#39;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
<span class="n">ds365</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">59</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(cftime.DatetimeNoLeap(1950, 3, 2, 0, 0, 0, 0), dtype=object)
</pre></div>
</div>
</div>
</div>
<p>This conversion dropped the invalid days (for example: the 29th and 30th of February 1950) and convert the dtype of the time axis. This does alter the data, but it makes it possible to concatenate different model simulations into a single <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">create_ensemble</span></code>, all members are converted to a common calendar. By default, it uses the normal numpy/pandas data type (a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#timestamp-limitations">range-limited</a> calendar equivalent to <code class="docutils literal notranslate"><span class="pre">proleptic_gregorian</span></code>), but for this model ensemble, it’s better to use <code class="docutils literal notranslate"><span class="pre">noleap</span></code> (all years have 365 days), as it is the calendar used in most models included here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ens</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">ensembles</span><span class="o">.</span><span class="n">create_ensemble</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;noleap&#39;</span><span class="p">)</span>
<span class="n">ens</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (realization: 11, time: 55115)
Coordinates:
  * time         (time) object 1950-01-01 00:00:00 ... 2100-12-31 00:00:00
    lat          float32 47.21
    lon          float32 -70.3
  * realization  (realization) int64 0 1 2 3 4 5 6 7 8 9 10
Data variables:
    pr           (realization, time) float32 dask.array&lt;chunksize=(1, 55115), meta=np.ndarray&gt;
    tasmax       (realization, time) float32 dask.array&lt;chunksize=(1, 55115), meta=np.ndarray&gt;
    tasmin       (realization, time) float32 dask.array&lt;chunksize=(1, 55115), meta=np.ndarray&gt;
Attributes:
    Conventions:     CF-1.5
    title:           ACCESS1-3 model output prepared for CMIP5 historical
    history:         CMIP5 compliant file produced from raw ACCESS model outp...
    institution:     CSIRO (Commonwealth Scientific and Industrial Research O...
    source:          ACCESS1-3 2011. Atmosphere: AGCM v1.0 (N96 grid-point, 1...
    redistribution:  Redistribution prohibited. For internal use only.</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ffbfa167-0176-49a1-b99e-776fb6855a42' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ffbfa167-0176-49a1-b99e-776fb6855a42' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>realization</span>: 11</li><li><span class='xr-has-index'>time</span>: 55115</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4b279e3b-bbc1-4d4f-84cf-67da58a77d63' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4b279e3b-bbc1-4d4f-84cf-67da58a77d63' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1950-01-01 00:00:00 ... 2100-12-...</div><input id='attrs-0eec50ed-545d-4e97-bc9d-47371f83b59f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0eec50ed-545d-4e97-bc9d-47371f83b59f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-81de0455-9a26-4865-b344-c1c5a08e5a90' class='xr-var-data-in' type='checkbox'><label for='data-81de0455-9a26-4865-b344-c1c5a08e5a90' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeNoLeap(1950, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1950, 1, 2, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1950, 1, 3, 0, 0, 0, 0), ...,
       cftime.DatetimeNoLeap(2100, 12, 29, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2100, 12, 30, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2100, 12, 31, 0, 0, 0, 0)], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>47.21</div><input id='attrs-b5d18d1c-d670-4107-846a-1fef32b81a91' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b5d18d1c-d670-4107-846a-1fef32b81a91' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1a1d626c-62d1-4445-8633-bf64164f51f7' class='xr-var-data-in' type='checkbox'><label for='data-1a1d626c-62d1-4445-8633-bf64164f51f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array(47.20742, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-70.3</div><input id='attrs-a0db5990-df87-43d0-b46f-17d151a0a348' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a0db5990-df87-43d0-b46f-17d151a0a348' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3e7d7a9-e25c-46c6-b1cb-d0fa04efffbc' class='xr-var-data-in' type='checkbox'><label for='data-a3e7d7a9-e25c-46c6-b1cb-d0fa04efffbc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array(-70.29596, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>realization</span></div><div class='xr-var-dims'>(realization)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9 10</div><input id='attrs-cc92c978-c751-465e-b0c8-5acf4952da7e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cc92c978-c751-465e-b0c8-5acf4952da7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a5e40d4-ac9c-4779-b620-ef966c0af1d7' class='xr-var-data-in' type='checkbox'><label for='data-8a5e40d4-ac9c-4779-b620-ef966c0af1d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>E</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-74b077c5-0917-49d5-96cf-317beccd1079' class='xr-section-summary-in' type='checkbox'  checked><label for='section-74b077c5-0917-49d5-96cf-317beccd1079' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>pr</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 55115), meta=np.ndarray&gt;</div><input id='attrs-6f0cdad2-a2fb-455e-a3cd-0bc6af01dd8d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6f0cdad2-a2fb-455e-a3cd-0bc6af01dd8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cddc9bf0-e26f-4c28-8218-37f21fc35056' class='xr-var-data-in' type='checkbox'><label for='data-cddc9bf0-e26f-4c28-8218-37f21fc35056' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm s-1</dd><dt><span>long_name :</span></dt><dd>lwe_precipitation_rate</dd><dt><span>standard_name :</span></dt><dd>lwe_precipitation_rate</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.31 MiB </td> <td> 215.29 kiB </td></tr>
    <tr><th> Shape </th><td> (11, 55115) </td> <td> (1, 55115) </td></tr>
    <tr><th> Count </th><td> 63 Tasks </td><td> 11 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="4" x2="120" y2="4" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="18" x2="120" y2="18" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >55115</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">11</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tasmax</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 55115), meta=np.ndarray&gt;</div><input id='attrs-1b276b40-702e-422e-9c43-9fad7b56a125' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1b276b40-702e-422e-9c43-9fad7b56a125' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fbc63963-7272-4d77-85ab-22939aac5bba' class='xr-var-data-in' type='checkbox'><label for='data-fbc63963-7272-4d77-85ab-22939aac5bba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>air_temperature</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.31 MiB </td> <td> 215.29 kiB </td></tr>
    <tr><th> Shape </th><td> (11, 55115) </td> <td> (1, 55115) </td></tr>
    <tr><th> Count </th><td> 63 Tasks </td><td> 11 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="4" x2="120" y2="4" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="18" x2="120" y2="18" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >55115</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">11</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tasmin</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 55115), meta=np.ndarray&gt;</div><input id='attrs-0d21bd67-593b-4303-b593-e56daa847258' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0d21bd67-593b-4303-b593-e56daa847258' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0a149c7-f14f-4abe-a3b1-09b59ec94b16' class='xr-var-data-in' type='checkbox'><label for='data-d0a149c7-f14f-4abe-a3b1-09b59ec94b16' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>air_temperature</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 2.31 MiB </td> <td> 215.29 kiB </td></tr>
    <tr><th> Shape </th><td> (11, 55115) </td> <td> (1, 55115) </td></tr>
    <tr><th> Count </th><td> 63 Tasks </td><td> 11 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="4" x2="120" y2="4" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="9" x2="120" y2="9" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="18" x2="120" y2="18" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >55115</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">11</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-3eb47d47-d7a6-4ae1-a286-f01358a9e176' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3eb47d47-d7a6-4ae1-a286-f01358a9e176' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.5</dd><dt><span>title :</span></dt><dd>ACCESS1-3 model output prepared for CMIP5 historical</dd><dt><span>history :</span></dt><dd>CMIP5 compliant file produced from raw ACCESS model output using the ACCESS Post-Processor and CMOR2. 2012-04-03T13:44:54Z CMOR rewrote data to comply with CF standards and CMIP5 requirements. Fri Apr 13 09:55:30 2012: forcing attribute modified to correct value Fri Apr 13 12:29:45 2012: corrected model_id from ACCESS1-3 to ACCESS1.3 Mon Jul  2 11:13:41 2012: updated version number to v20120413.
2016-01-19T03:26:16: Interpolate to nrcan_livneh grid.
2016-02-10T09:50:00: Bias correction using nrcan_livneh.</dd><dt><span>institution :</span></dt><dd>CSIRO (Commonwealth Scientific and Industrial Research Organisation, Australia), and BOM (Bureau of Meteorology, Australia)</dd><dt><span>source :</span></dt><dd>ACCESS1-3 2011. Atmosphere: AGCM v1.0 (N96 grid-point, 1.875 degrees EW x approx 1.25 degree NS, 38 levels); ocean: NOAA/GFDL MOM4p1 (nominal 1.0 degree EW x 1.0 degrees NS, tripolar north of 65N, equatorial refinement to 1/3 degree from 10S to 10 N, cosine dependent NS south of 25S, 50 levels); sea ice: CICE4.1 (nominal 1.0 degree EW x 1.0 degrees NS, tripolar north of 65N, equatorial refinement to 1/3 degree from 10S to 10 N, cosine dependent NS south of 25S); land: CABLE1.0 (1.875 degree EW x 1.25 degree NS, 6 levels
30-day moving window 50-bins quantile mapping with detrending.</dd><dt><span>redistribution :</span></dt><dd>Redistribution prohibited. For internal use only.</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="compute-climate-indicators">
<h3>Compute climate indicators<a class="headerlink" href="#compute-climate-indicators" title="Permalink to this headline">¶</a></h3>
<p>Climate indicators are stored in <code class="docutils literal notranslate"><span class="pre">xclim.indicators.[realm]</span></code> and act as functions, taking <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> as input variables and returning one (or more) <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>. Most indicators also take keyword arguments to control various parameters. Under the hood, indicators are python objects, storing information on what the computation does, its inputs and its outputs. For example, let’s look at the <code class="docutils literal notranslate"><span class="pre">tropical_nights</span></code> indicator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TN</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">indicators</span><span class="o">.</span><span class="n">atmos</span><span class="o">.</span><span class="n">tropical_nights</span>

<span class="c1"># Print general information:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Title: &#39;</span><span class="p">,</span> <span class="n">TN</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;General description: &#39;</span><span class="p">,</span> <span class="n">TN</span><span class="o">.</span><span class="n">abstract</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Info on the inputs</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Inputs description:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">TN</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Info on the output</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Output description:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">TN</span><span class="o">.</span><span class="n">cf_attrs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Title:  Tropical nights.
General description:  The number of days with minimum daily temperature above threshold. 

Inputs description:
{&#39;ds&#39;: {&#39;default&#39;: None,
        &#39;description&#39;: &#39;A dataset with the variables given by name.&#39;,
        &#39;kind&#39;: &lt;InputKind.DATASET: 70&gt;},
 &#39;freq&#39;: {&#39;default&#39;: &#39;YS&#39;,
          &#39;description&#39;: &#39;Resampling frequency.&#39;,
          &#39;kind&#39;: &lt;InputKind.FREQ_STR: 3&gt;},
 &#39;tasmin&#39;: {&#39;default&#39;: &#39;tasmin&#39;,
            &#39;description&#39;: &#39;Minimum daily temperature.&#39;,
            &#39;kind&#39;: &lt;InputKind.VARIABLE: 0&gt;,
            &#39;units&#39;: &#39;[temperature]&#39;},
 &#39;thresh&#39;: {&#39;default&#39;: &#39;20.0 degC&#39;,
            &#39;description&#39;: &#39;Threshold temperature on which to base evaluation.&#39;,
            &#39;kind&#39;: &lt;InputKind.QUANTITY_STR: 2&gt;,
            &#39;units&#39;: &#39;[temperature]&#39;}}

Output description:
[{&#39;cell_methods&#39;: &#39;time: minimum within days time: sum over days&#39;,
  &#39;description&#39;: &#39;{freq} number of Tropical Nights : defined as days with &#39;
                 &#39;minimum daily temperature above {thresh}&#39;,
  &#39;long_name&#39;: &#39;Number of Tropical Nights (Tmin &gt; {thresh})&#39;,
  &#39;standard_name&#39;: &#39;number_of_days_with_air_temperature_above_threshold&#39;,
  &#39;units&#39;: &#39;days&#39;,
  &#39;var_name&#39;: &#39;tropical_nights&#39;}]
</pre></div>
</div>
</div>
</div>
<p>We use the indicator by calling it like a function with the variable and parameters. We will look at the <em>seasonal</em> number of “tropical nights” with a threshold of 5°C. For frequency arguments, we use the same syntax as <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects">pandas</a>. Here <code class="docutils literal notranslate"><span class="pre">QS-DEC</span></code> will resample to seasons of three (3) months, starting in December (so DJF, MMA, JJA, SON).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">indicators</span><span class="o">.</span><span class="n">atmos</span><span class="o">.</span><span class="n">tropical_nights</span><span class="p">(</span><span class="n">tasmin</span><span class="o">=</span><span class="n">ens</span><span class="o">.</span><span class="n">tasmin</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="s1">&#39;5 degC&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;QS-DEC&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/phobos/.conda/envs/xclim-demo/lib/python3.9/site-packages/xclim/indicators/atmos/_temperature.py:83: UserWarning: Variable does not have a `cell_methods` attribute.
  cfchecks.check_valid(tasmin, &quot;cell_methods&quot;, &quot;*time: minimum within days*&quot;)
</pre></div>
</div>
<div class="output text_html"><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 51.99 kiB </td> <td> 8 B </td></tr>
    <tr><th> Shape </th><td> (11, 605) </td> <td> (1, 1) </td></tr>
    <tr><th> Count </th><td> 127972 Tasks </td><td> 6655 Chunks </td></tr>
    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="78" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="12" x2="120" y2="12" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="18" x2="120" y2="18" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="25" x2="120" y2="25" />
  <line x1="0" y1="28" x2="120" y2="28" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="28" style="stroke-width:2" />
  <line x1="6" y1="0" x2="6" y2="28" />
  <line x1="12" y1="0" x2="12" y2="28" />
  <line x1="18" y1="0" x2="18" y2="28" />
  <line x1="25" y1="0" x2="25" y2="28" />
  <line x1="31" y1="0" x2="31" y2="28" />
  <line x1="37" y1="0" x2="37" y2="28" />
  <line x1="44" y1="0" x2="44" y2="28" />
  <line x1="50" y1="0" x2="50" y2="28" />
  <line x1="56" y1="0" x2="56" y2="28" />
  <line x1="63" y1="0" x2="63" y2="28" />
  <line x1="69" y1="0" x2="69" y2="28" />
  <line x1="75" y1="0" x2="75" y2="28" />
  <line x1="81" y1="0" x2="81" y2="28" />
  <line x1="88" y1="0" x2="88" y2="28" />
  <line x1="94" y1="0" x2="94" y2="28" />
  <line x1="100" y1="0" x2="100" y2="28" />
  <line x1="107" y1="0" x2="107" y2="28" />
  <line x1="113" y1="0" x2="113" y2="28" />
  <line x1="120" y1="0" x2="120" y2="28" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,28.499196557616223 0.0,28.499196557616223" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="48.499197" font-size="1.0rem" font-weight="100" text-anchor="middle" >605</text>
  <text x="140.000000" y="14.249598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,14.249598)">11</text>
</svg>
</td>
</tr>
</table></div><div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;tropical_nights&#x27; (realization: 11, time: 2)&gt;
array([[nan,  9.],
       [nan,  9.],
       [nan, 15.],
       [nan, 15.],
       [nan,  9.],
       [nan, nan],
       [nan, 12.],
       [nan,  2.],
       [nan, 20.],
       [nan, 15.],
       [nan, 17.]])
Coordinates:
  * time         (time) object 1949-12-01 00:00:00 1950-03-01 00:00:00
    lat          float32 47.21
    lon          float32 -70.3
  * realization  (realization) int64 0 1 2 3 4 5 6 7 8 9 10
Attributes:
    units:          days
    cell_methods:    time: minimum within days time: sum over days
    xclim_history:  [2021-06-07 17:30:27] tropical_nights: TROPICAL_NIGHTS(ta...
    standard_name:  number_of_days_with_air_temperature_above_threshold
    long_name:      Number of tropical nights (tmin &gt; 5 degc)
    description:    Seasonal number of tropical nights : defined as days with...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'tropical_nights'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>realization</span>: 11</li><li><span class='xr-has-index'>time</span>: 2</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c8422997-68f2-4a30-b6ff-5205d7f568e9' class='xr-array-in' type='checkbox' checked><label for='section-c8422997-68f2-4a30-b6ff-5205d7f568e9' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan 9.0 nan 9.0 nan 15.0 nan 15.0 ... 2.0 nan 20.0 nan 15.0 nan 17.0</span></div><div class='xr-array-data'><pre>array([[nan,  9.],
       [nan,  9.],
       [nan, 15.],
       [nan, 15.],
       [nan,  9.],
       [nan, nan],
       [nan, 12.],
       [nan,  2.],
       [nan, 20.],
       [nan, 15.],
       [nan, 17.]])</pre></div></div></li><li class='xr-section-item'><input id='section-46801b72-b3ff-43e6-8cf2-9614cf14e468' class='xr-section-summary-in' type='checkbox'  checked><label for='section-46801b72-b3ff-43e6-8cf2-9614cf14e468' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1949-12-01 00:00:00 1950-03-01 0...</div><input id='attrs-fbe95f0f-381a-4a0c-a11c-f9b317fd438d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fbe95f0f-381a-4a0c-a11c-f9b317fd438d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1b8fd0f-80ac-4c28-9be3-f49ee3e92f67' class='xr-var-data-in' type='checkbox'><label for='data-a1b8fd0f-80ac-4c28-9be3-f49ee3e92f67' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeNoLeap(1949, 12, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1950, 3, 1, 0, 0, 0, 0)], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>47.21</div><input id='attrs-d2a7be2e-4c43-4e40-a0a5-ab921b74f74d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d2a7be2e-4c43-4e40-a0a5-ab921b74f74d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ff69353-2d67-47d0-bb34-d5859112c000' class='xr-var-data-in' type='checkbox'><label for='data-4ff69353-2d67-47d0-bb34-d5859112c000' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array(47.20742, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-70.3</div><input id='attrs-3827fd78-9043-44f6-8e0d-328852d9d00c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3827fd78-9043-44f6-8e0d-328852d9d00c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54c6df88-ab8e-456c-85e8-052f7b359111' class='xr-var-data-in' type='checkbox'><label for='data-54c6df88-ab8e-456c-85e8-052f7b359111' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array(-70.29596, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>realization</span></div><div class='xr-var-dims'>(realization)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9 10</div><input id='attrs-415d875a-c7f5-4077-9ded-9c1c244376e4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-415d875a-c7f5-4077-9ded-9c1c244376e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1a53eca8-e383-4816-9891-4ee03eff61c4' class='xr-var-data-in' type='checkbox'><label for='data-1a53eca8-e383-4816-9891-4ee03eff61c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>E</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f51afdad-1833-42ba-81fb-16b44e04644e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f51afdad-1833-42ba-81fb-16b44e04644e' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>days</dd><dt><span>cell_methods :</span></dt><dd> time: minimum within days time: sum over days</dd><dt><span>xclim_history :</span></dt><dd>[2021-06-07 17:30:27] tropical_nights: TROPICAL_NIGHTS(tasmin=&lt;array&gt;, thresh=&#x27;5 degC&#x27;, freq=&#x27;QS-DEC&#x27;) - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>number_of_days_with_air_temperature_above_threshold</dd><dt><span>long_name :</span></dt><dd>Number of tropical nights (tmin &gt; 5 degc)</dd><dt><span>description :</span></dt><dd>Seasonal number of tropical nights : defined as days with minimum daily temperature above 5 degc</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Let’s talk about the many things that happened here:</p>
<ol>
<li><p><strong>Input checks</strong></p>
<p>Before the real computation, xclim performs some checks on the inputs. These can differ between indicators, but the most common are CF convention and input frequency checks. The former looks at the <code class="docutils literal notranslate"><span class="pre">standard_name</span></code> and <code class="docutils literal notranslate"><span class="pre">cell_methods</span></code> attributes of the input variable and raises warnings when they do not fit with what it expects. Here, the <code class="docutils literal notranslate"><span class="pre">standard_name</span></code> (“air_temperature”) is correct, but the variable is missing the <code class="docutils literal notranslate"><span class="pre">cell_methods</span></code> attribute that would normally indicate that this is indeed the <em>minimum</em> temperature within each days.</p>
<p>The second type of checks looks at the data itself. Most indicators expect data at a <strong>daily</strong> frequency, and if the input has a different frequency, the indicator checks will raise an error.</p>
</li>
<li><p><strong>Unit handling</strong></p>
<p>Another check on the inputs is performed to ensure the correct units were passed. Above, in the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> dictionary, we saw that <code class="docutils literal notranslate"><span class="pre">tropical_nights</span></code> expects <code class="docutils literal notranslate"><span class="pre">tasmin</span></code> and <code class="docutils literal notranslate"><span class="pre">thresh</span></code> to  both be “[temperature]” values. In the function, conversion are made to ensure compatible units. Here, <code class="docutils literal notranslate"><span class="pre">tasmin</span></code> is in Kelvin and <code class="docutils literal notranslate"><span class="pre">thresh</span></code> was given in Celsius. Under the hood, xclim uses <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">pint</span></code></span> to handle this, but with small modifications made so that CF-compliant unit strings are understood.</p>
</li>
<li><p><strong>Missing values handling</strong></p>
<p>After the computation, for indicators involving a resampling operation, periods where at least one value was missing (i.e. was a <code class="docutils literal notranslate"><span class="pre">np.NaN</span></code>) are masked out. Here the first period is masked for all realization since there was no data for the month of december 1949. This is the default behavior and it can be changed, as we will show further down.</p>
</li>
<li><p><strong>Metadata formatting</strong></p>
<p>The output’s attributes were formatted to include some information from the passed parameters. Notice how the description includes the given threshold and frequency (<em>Seasonal number of tropical nights […]</em>).</p>
</li>
<li><p><strong>Lazy computing</strong></p>
<p>This is not a feature inherent to xclim, but, by default, <code class="docutils literal notranslate"><span class="pre">create_ensemble</span></code> will open the ensemble dataset using the <code class="docutils literal notranslate"><span class="pre">dask</span></code> backend, one “chunk” for each file. This means that all further calculations are <em>lazy</em>, ie: python remembers the operations but doesn’t perform them as long as the result is not requested. This is why we needed to call <code class="docutils literal notranslate"><span class="pre">.load()</span></code> to see the first values of the output. This behaviour from <code class="docutils literal notranslate"><span class="pre">xarray</span></code> is extremely useful for computationally-intensive workflows as it allows <code class="docutils literal notranslate"><span class="pre">dask</span></code> to efficiently manage the memory and CPU ressources. Xclim aims to implement its indicators in a lazy and efficient way.</p>
</li>
</ol>
<p>Let’s compute a few indicators and merge them into another ensemble dataset. This time, we will change the missing values handling to a more relaxed method, where periods are masked when at least 5% of the elements are missing. Moreover, we will set an option so that CF-checks warnings are ignored.</p>
<p>If you want to know more about the indicators we are computing, you can use <code class="docutils literal notranslate"><span class="pre">help(indicator)</span></code> or <code class="docutils literal notranslate"><span class="pre">indicator?</span></code> (in ipython/jupyter) to print their docstrings, which include most information shown above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set options using a &quot;context&quot;. Options set here are reset to their defaults as soon as we exit the &quot;with&quot; block</span>
<span class="k">with</span> <span class="n">xclim</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">cf_compliance</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">check_missing</span><span class="o">=</span><span class="s1">&#39;pct&#39;</span><span class="p">,</span> <span class="n">missing_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pct&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;tolerance&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">}}):</span>

    <span class="c1"># Intermediate computation : Approximate mean daily temp by taking the mean of tasmin and tasmax</span>
    <span class="n">tas</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">indicators</span><span class="o">.</span><span class="n">atmos</span><span class="o">.</span><span class="n">tg</span><span class="p">(</span><span class="n">tasmin</span><span class="o">=</span><span class="n">ens</span><span class="o">.</span><span class="n">tasmin</span><span class="p">,</span> <span class="n">tasmax</span><span class="o">=</span><span class="n">ens</span><span class="o">.</span><span class="n">tasmax</span><span class="p">)</span>

    <span class="c1"># First day below, first day of the year where tasmin goes below &quot;thresh&quot; for at least &quot;window&quot; days</span>
    <span class="c1"># Note that we resample yearly, but starting in July, so that the full winter is included</span>
    <span class="n">out_fda</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">indicators</span><span class="o">.</span><span class="n">atmos</span><span class="o">.</span><span class="n">first_day_below</span><span class="p">(</span><span class="n">tasmin</span><span class="o">=</span><span class="n">ens</span><span class="o">.</span><span class="n">tasmin</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="s1">&#39;-5 degC&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS-JUL&#39;</span><span class="p">)</span>

    <span class="c1"># Number frost days : total number of days where tasmin &lt; 0 degC</span>
    <span class="n">out_nfd</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">indicators</span><span class="o">.</span><span class="n">atmos</span><span class="o">.</span><span class="n">frost_days</span><span class="p">(</span><span class="n">tasmin</span><span class="o">=</span><span class="n">ens</span><span class="o">.</span><span class="n">tasmin</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS-JUL&#39;</span><span class="p">)</span>

    <span class="c1"># Solid precipitation accumulation : total thickness of solid precipitation (estimated by pr when tas &lt; 0°C)</span>
    <span class="n">out_spa</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">indicators</span><span class="o">.</span><span class="n">atmos</span><span class="o">.</span><span class="n">solid_precip_accumulation</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="n">ens</span><span class="o">.</span><span class="n">pr</span><span class="p">,</span> <span class="n">tas</span><span class="o">=</span><span class="n">tas</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS-JUL&#39;</span><span class="p">)</span>

    <span class="c1"># Cold spell freq : Number of spells where tas is under &quot;thresh&quot; for at least &quot;window&quot; days.</span>
    <span class="n">out_csf</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">indicators</span><span class="o">.</span><span class="n">atmos</span><span class="o">.</span><span class="n">cold_spell_frequency</span><span class="p">(</span><span class="n">tas</span><span class="o">=</span><span class="n">tas</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="s1">&#39;-10 degC&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;AS-JUL&#39;</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">out_fda</span><span class="p">,</span> <span class="n">out_nfd</span><span class="p">,</span> <span class="n">out_spa</span><span class="p">,</span> <span class="n">out_csf</span><span class="p">])</span>
<span class="n">out</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:               (realization: 11, time: 152)
Coordinates:
  * time                  (time) object 1949-07-01 00:00:00 ... 2100-07-01 00...
    lat                   float32 47.21
    lon                   float32 -70.3
  * realization           (realization) int64 0 1 2 3 4 5 6 7 8 9 10
Data variables:
    first_day_below       (realization, time) float64 dask.array&lt;chunksize=(1, 1), meta=np.ndarray&gt;
    frost_days            (realization, time) float64 dask.array&lt;chunksize=(1, 1), meta=np.ndarray&gt;
    solidprcptot          (realization, time) float64 dask.array&lt;chunksize=(1, 1), meta=np.ndarray&gt;
    cold_spell_frequency  (realization, time) float64 dask.array&lt;chunksize=(1, 1), meta=np.ndarray&gt;
Attributes:
    units:          
    is_dayofyear:   1
    calendar:       noleap
    cell_methods:   
    xclim_history:  [2021-06-07 17:30:33] first_day_below: FIRST_DAY_BELOW(ta...
    standard_name:  day_of_year
    long_name:      First day of year with temperature below -5 degc
    description:    First day of year with temperature below -5 degc for at l...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-742fbdc5-c1ef-4060-8cc9-c3d03ab6895b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-742fbdc5-c1ef-4060-8cc9-c3d03ab6895b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>realization</span>: 11</li><li><span class='xr-has-index'>time</span>: 152</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b0bac1c0-9b48-4a7e-9bec-63a9b238bd54' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b0bac1c0-9b48-4a7e-9bec-63a9b238bd54' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1949-07-01 00:00:00 ... 2100-07-...</div><input id='attrs-0196a55d-2ff8-4efe-965f-6fc5452b8b57' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0196a55d-2ff8-4efe-965f-6fc5452b8b57' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71ff6065-ab45-436c-9052-e9a12ad4a12b' class='xr-var-data-in' type='checkbox'><label for='data-71ff6065-ab45-436c-9052-e9a12ad4a12b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeNoLeap(1949, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1950, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1951, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1952, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1953, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1954, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1955, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1956, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1957, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1958, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1959, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1960, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1961, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1962, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1963, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1964, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1965, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1966, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1967, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1968, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1969, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1970, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1971, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1972, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1973, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1974, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1975, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1976, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1977, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1978, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1979, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1980, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1981, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1982, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1983, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1984, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1985, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1986, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1987, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1988, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1989, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1990, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1991, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1992, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1993, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1994, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1995, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1996, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1997, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1998, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1999, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2000, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2001, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2002, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2003, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2004, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2005, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2006, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2007, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2008, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2009, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2010, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2011, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2012, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2013, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2014, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2015, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2016, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2017, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2018, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2019, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2020, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2021, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2022, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2023, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2024, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2025, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2026, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2027, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2028, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2029, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2030, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2031, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2032, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2033, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2034, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2035, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2036, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2037, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2038, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2039, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2040, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2041, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2042, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2043, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2044, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2045, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2046, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2047, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2048, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2049, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2050, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2051, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2052, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2053, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2054, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2055, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2056, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2057, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2058, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2059, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2060, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2061, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2062, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2063, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2064, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2065, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2066, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2067, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2068, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2069, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2070, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2071, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2072, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2073, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2074, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2075, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2076, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2077, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2078, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2079, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2080, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2081, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2082, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2083, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2084, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2085, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2086, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2087, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2088, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2089, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2090, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2091, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2092, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2093, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2094, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2095, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2096, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2097, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2098, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2099, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2100, 7, 1, 0, 0, 0, 0)], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>47.21</div><input id='attrs-2f99a682-bfc3-41ac-bf38-dd5c32eaa5f0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2f99a682-bfc3-41ac-bf38-dd5c32eaa5f0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-22d4a35f-4319-49d4-a373-24dffe80a962' class='xr-var-data-in' type='checkbox'><label for='data-22d4a35f-4319-49d4-a373-24dffe80a962' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array(47.20742, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-70.3</div><input id='attrs-6a1821ab-ef00-469b-8307-42cf30bc87ff' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6a1821ab-ef00-469b-8307-42cf30bc87ff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ea46c92-47df-4db5-a0f0-3dbb963ef1d7' class='xr-var-data-in' type='checkbox'><label for='data-3ea46c92-47df-4db5-a0f0-3dbb963ef1d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array(-70.29596, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>realization</span></div><div class='xr-var-dims'>(realization)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9 10</div><input id='attrs-6440e097-a278-4901-a1d0-39fd813c7f73' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6440e097-a278-4901-a1d0-39fd813c7f73' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c1bafdb8-9d88-467e-b5c9-dc4d55527517' class='xr-var-data-in' type='checkbox'><label for='data-c1bafdb8-9d88-467e-b5c9-dc4d55527517' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>E</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-66ad2f65-2ef7-4d72-a23b-e94298916408' class='xr-section-summary-in' type='checkbox'  checked><label for='section-66ad2f65-2ef7-4d72-a23b-e94298916408' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>first_day_below</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1), meta=np.ndarray&gt;</div><input id='attrs-1c6bf6c8-6c5b-4eeb-857f-4be8f28dcdbc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1c6bf6c8-6c5b-4eeb-857f-4be8f28dcdbc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27a1dbef-925e-4830-8989-bffd8eae7261' class='xr-var-data-in' type='checkbox'><label for='data-27a1dbef-925e-4830-8989-bffd8eae7261' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd><dt><span>is_dayofyear :</span></dt><dd>1</dd><dt><span>calendar :</span></dt><dd>noleap</dd><dt><span>cell_methods :</span></dt><dd></dd><dt><span>xclim_history :</span></dt><dd>[2021-06-07 17:30:33] first_day_below: FIRST_DAY_BELOW(tasmin=&lt;array&gt;, thresh=&#x27;-5 degC&#x27;, after_date=&#x27;07-01&#x27;, window=3, freq=&#x27;AS-JUL&#x27;) - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>day_of_year</dd><dt><span>long_name :</span></dt><dd>First day of year with temperature below -5 degc</dd><dt><span>description :</span></dt><dd>First day of year with temperature below -5 degc for at least 3 days.</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 13.06 kiB </td> <td> 8 B </td></tr>
    <tr><th> Shape </th><td> (11, 152) </td> <td> (1, 1) </td></tr>
    <tr><th> Count </th><td> 75835 Tasks </td><td> 1672 Chunks </td></tr>
    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="86" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="26" x2="120" y2="26" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="36" x2="120" y2="36" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="36" style="stroke-width:2" />
  <line x1="6" y1="0" x2="6" y2="36" />
  <line x1="12" y1="0" x2="12" y2="36" />
  <line x1="18" y1="0" x2="18" y2="36" />
  <line x1="25" y1="0" x2="25" y2="36" />
  <line x1="31" y1="0" x2="31" y2="36" />
  <line x1="37" y1="0" x2="37" y2="36" />
  <line x1="44" y1="0" x2="44" y2="36" />
  <line x1="50" y1="0" x2="50" y2="36" />
  <line x1="56" y1="0" x2="56" y2="36" />
  <line x1="63" y1="0" x2="63" y2="36" />
  <line x1="69" y1="0" x2="69" y2="36" />
  <line x1="75" y1="0" x2="75" y2="36" />
  <line x1="82" y1="0" x2="82" y2="36" />
  <line x1="88" y1="0" x2="88" y2="36" />
  <line x1="94" y1="0" x2="94" y2="36" />
  <line x1="101" y1="0" x2="101" y2="36" />
  <line x1="107" y1="0" x2="107" y2="36" />
  <line x1="113" y1="0" x2="113" y2="36" />
  <line x1="120" y1="0" x2="120" y2="36" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,36.73709529211189 0.0,36.73709529211189" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="56.737095" font-size="1.0rem" font-weight="100" text-anchor="middle" >152</text>
  <text x="140.000000" y="18.368548" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,18.368548)">11</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>frost_days</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1), meta=np.ndarray&gt;</div><input id='attrs-e218b25a-5910-4e1e-8d5f-ad18649e604a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e218b25a-5910-4e1e-8d5f-ad18649e604a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-858ccfaf-20ab-4a0c-9fa1-e7d7145891df' class='xr-var-data-in' type='checkbox'><label for='data-858ccfaf-20ab-4a0c-9fa1-e7d7145891df' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>days</dd><dt><span>cell_methods :</span></dt><dd> time: minimum within days time: sum over days</dd><dt><span>xclim_history :</span></dt><dd>[2021-06-07 17:30:41] frost_days: FROST_DAYS(tasmin=&lt;array&gt;, thresh=&#x27;0 degC&#x27;, freq=&#x27;AS-JUL&#x27;) - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>days_with_air_temperature_below_threshold</dd><dt><span>long_name :</span></dt><dd>Number of frost days (tmin &lt; 0c)</dd><dt><span>description :</span></dt><dd>Annual number of days with minimum daily temperature below 0℃.</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 13.06 kiB </td> <td> 8 B </td></tr>
    <tr><th> Shape </th><td> (11, 152) </td> <td> (1, 1) </td></tr>
    <tr><th> Count </th><td> 45677 Tasks </td><td> 1672 Chunks </td></tr>
    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="86" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="26" x2="120" y2="26" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="36" x2="120" y2="36" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="36" style="stroke-width:2" />
  <line x1="6" y1="0" x2="6" y2="36" />
  <line x1="12" y1="0" x2="12" y2="36" />
  <line x1="18" y1="0" x2="18" y2="36" />
  <line x1="25" y1="0" x2="25" y2="36" />
  <line x1="31" y1="0" x2="31" y2="36" />
  <line x1="37" y1="0" x2="37" y2="36" />
  <line x1="44" y1="0" x2="44" y2="36" />
  <line x1="50" y1="0" x2="50" y2="36" />
  <line x1="56" y1="0" x2="56" y2="36" />
  <line x1="63" y1="0" x2="63" y2="36" />
  <line x1="69" y1="0" x2="69" y2="36" />
  <line x1="75" y1="0" x2="75" y2="36" />
  <line x1="82" y1="0" x2="82" y2="36" />
  <line x1="88" y1="0" x2="88" y2="36" />
  <line x1="94" y1="0" x2="94" y2="36" />
  <line x1="101" y1="0" x2="101" y2="36" />
  <line x1="107" y1="0" x2="107" y2="36" />
  <line x1="113" y1="0" x2="113" y2="36" />
  <line x1="120" y1="0" x2="120" y2="36" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,36.73709529211189 0.0,36.73709529211189" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="56.737095" font-size="1.0rem" font-weight="100" text-anchor="middle" >152</text>
  <text x="140.000000" y="18.368548" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,18.368548)">11</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>solidprcptot</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1), meta=np.ndarray&gt;</div><input id='attrs-a793bc54-00d0-4272-b872-05370e803be3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a793bc54-00d0-4272-b872-05370e803be3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0b7f831c-08f9-40b7-887a-678a14dad026' class='xr-var-data-in' type='checkbox'><label for='data-0b7f831c-08f9-40b7-887a-678a14dad026' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd><dt><span>cell_methods :</span></dt><dd>tas:  time: mean within days time: sum within days time: sum over days</dd><dt><span>xclim_history :</span></dt><dd>pr: 
tas: 
[2021-06-07 17:30:43] solidprcptot: SOLIDPRCPTOT(pr=&lt;array&gt;, tas=&lt;array&gt;, thresh=&#x27;0 degC&#x27;, freq=&#x27;AS-JUL&#x27;, phase=&#x27;solid&#x27;) - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_snowfall_amount</dd><dt><span>long_name :</span></dt><dd>Total solid precipitation</dd><dt><span>description :</span></dt><dd>Annual total solid precipitation, estimated as precipitation when temperature &lt; 0 degc</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 13.06 kiB </td> <td> 8 B </td></tr>
    <tr><th> Shape </th><td> (11, 152) </td> <td> (1, 1) </td></tr>
    <tr><th> Count </th><td> 64229 Tasks </td><td> 1672 Chunks </td></tr>
    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="86" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="26" x2="120" y2="26" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="36" x2="120" y2="36" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="36" style="stroke-width:2" />
  <line x1="6" y1="0" x2="6" y2="36" />
  <line x1="12" y1="0" x2="12" y2="36" />
  <line x1="18" y1="0" x2="18" y2="36" />
  <line x1="25" y1="0" x2="25" y2="36" />
  <line x1="31" y1="0" x2="31" y2="36" />
  <line x1="37" y1="0" x2="37" y2="36" />
  <line x1="44" y1="0" x2="44" y2="36" />
  <line x1="50" y1="0" x2="50" y2="36" />
  <line x1="56" y1="0" x2="56" y2="36" />
  <line x1="63" y1="0" x2="63" y2="36" />
  <line x1="69" y1="0" x2="69" y2="36" />
  <line x1="75" y1="0" x2="75" y2="36" />
  <line x1="82" y1="0" x2="82" y2="36" />
  <line x1="88" y1="0" x2="88" y2="36" />
  <line x1="94" y1="0" x2="94" y2="36" />
  <line x1="101" y1="0" x2="101" y2="36" />
  <line x1="107" y1="0" x2="107" y2="36" />
  <line x1="113" y1="0" x2="113" y2="36" />
  <line x1="120" y1="0" x2="120" y2="36" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,36.73709529211189 0.0,36.73709529211189" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="56.737095" font-size="1.0rem" font-weight="100" text-anchor="middle" >152</text>
  <text x="140.000000" y="18.368548" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,18.368548)">11</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cold_spell_frequency</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1), meta=np.ndarray&gt;</div><input id='attrs-f3c0f46b-3a7f-432e-8d7d-3c3c9f363590' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f3c0f46b-3a7f-432e-8d7d-3c3c9f363590' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e251c5e7-207c-4697-8a33-0790de07c5fa' class='xr-var-data-in' type='checkbox'><label for='data-e251c5e7-207c-4697-8a33-0790de07c5fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd><dt><span>cell_methods :</span></dt><dd> time: mean within days</dd><dt><span>xclim_history :</span></dt><dd>[2021-06-07 17:30:46] cold_spell_frequency: COLD_SPELL_FREQUENCY(tas=&lt;array&gt;, thresh=&#x27;-10 degC&#x27;, window=3, freq=&#x27;AS-JUL&#x27;) - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>cold_spell_frequency</dd><dt><span>long_name :</span></dt><dd>Number of cold spell events</dd><dt><span>description :</span></dt><dd>Annual number cold spell events, defined as 3 or more consecutive days with mean daily temperature below  -10 degc.</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 13.06 kiB </td> <td> 8 B </td></tr>
    <tr><th> Shape </th><td> (11, 152) </td> <td> (1, 1) </td></tr>
    <tr><th> Count </th><td> 47418 Tasks </td><td> 1672 Chunks </td></tr>
    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="86" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="6" x2="120" y2="6" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="13" x2="120" y2="13" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="23" x2="120" y2="23" />
  <line x1="0" y1="26" x2="120" y2="26" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="33" x2="120" y2="33" />
  <line x1="0" y1="36" x2="120" y2="36" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="36" style="stroke-width:2" />
  <line x1="6" y1="0" x2="6" y2="36" />
  <line x1="12" y1="0" x2="12" y2="36" />
  <line x1="18" y1="0" x2="18" y2="36" />
  <line x1="25" y1="0" x2="25" y2="36" />
  <line x1="31" y1="0" x2="31" y2="36" />
  <line x1="37" y1="0" x2="37" y2="36" />
  <line x1="44" y1="0" x2="44" y2="36" />
  <line x1="50" y1="0" x2="50" y2="36" />
  <line x1="56" y1="0" x2="56" y2="36" />
  <line x1="63" y1="0" x2="63" y2="36" />
  <line x1="69" y1="0" x2="69" y2="36" />
  <line x1="75" y1="0" x2="75" y2="36" />
  <line x1="82" y1="0" x2="82" y2="36" />
  <line x1="88" y1="0" x2="88" y2="36" />
  <line x1="94" y1="0" x2="94" y2="36" />
  <line x1="101" y1="0" x2="101" y2="36" />
  <line x1="107" y1="0" x2="107" y2="36" />
  <line x1="113" y1="0" x2="113" y2="36" />
  <line x1="120" y1="0" x2="120" y2="36" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,36.73709529211189 0.0,36.73709529211189" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="56.737095" font-size="1.0rem" font-weight="100" text-anchor="middle" >152</text>
  <text x="140.000000" y="18.368548" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,18.368548)">11</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-20191d3a-5423-4a51-a6d5-c4e1b5bec6be' class='xr-section-summary-in' type='checkbox'  checked><label for='section-20191d3a-5423-4a51-a6d5-c4e1b5bec6be' class='xr-section-summary' >Attributes: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd><dt><span>is_dayofyear :</span></dt><dd>1</dd><dt><span>calendar :</span></dt><dd>noleap</dd><dt><span>cell_methods :</span></dt><dd></dd><dt><span>xclim_history :</span></dt><dd>[2021-06-07 17:30:33] first_day_below: FIRST_DAY_BELOW(tasmin=&lt;array&gt;, thresh=&#x27;-5 degC&#x27;, after_date=&#x27;07-01&#x27;, window=3, freq=&#x27;AS-JUL&#x27;) - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>day_of_year</dd><dt><span>long_name :</span></dt><dd>First day of year with temperature below -5 degc</dd><dt><span>description :</span></dt><dd>First day of year with temperature below -5 degc for at least 3 days.</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="ensemble-statistics">
<h3>Ensemble statistics<a class="headerlink" href="#ensemble-statistics" title="Permalink to this headline">¶</a></h3>
<p>All this is quite cool, but we still have a large amount of data to manage. In order to get an idea of the climatic evolution of our indicators and of the model uncertainty associated with it, we can compute ensemble percentiles. Here we extract the 10th, 50th (median) and 90th percentile of the distribution made up of the 11 members of the ensemble.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out_perc</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">ensembles</span><span class="o">.</span><span class="n">ensemble_percentiles</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">split</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">out_perc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:               (percentiles: 3, time: 152)
Coordinates:
  * time                  (time) object 1949-07-01 00:00:00 ... 2100-07-01 00...
    lat                   float32 47.21
    lon                   float32 -70.3
  * percentiles           (percentiles) int64 10 50 90
Data variables:
    first_day_below       (time, percentiles) float64 dask.array&lt;chunksize=(1, 3), meta=np.ndarray&gt;
    frost_days            (time, percentiles) float64 dask.array&lt;chunksize=(1, 3), meta=np.ndarray&gt;
    solidprcptot          (time, percentiles) float64 dask.array&lt;chunksize=(1, 3), meta=np.ndarray&gt;
    cold_spell_frequency  (time, percentiles) float64 dask.array&lt;chunksize=(1, 3), meta=np.ndarray&gt;
Attributes:
    units:          
    is_dayofyear:   1
    calendar:       noleap
    cell_methods:   
    xclim_history:  [2021-06-07 17:30:48] : Computation of the percentiles on...
    standard_name:  day_of_year
    long_name:      First day of year with temperature below -5 degc
    description:    First day of year with temperature below -5 degc for at l...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-cdee3c99-b11b-4efc-910d-c18027aa7a9f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cdee3c99-b11b-4efc-910d-c18027aa7a9f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>percentiles</span>: 3</li><li><span class='xr-has-index'>time</span>: 152</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d05e8e42-3261-4930-9ad6-b7c9ca1fb1ca' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d05e8e42-3261-4930-9ad6-b7c9ca1fb1ca' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1949-07-01 00:00:00 ... 2100-07-...</div><input id='attrs-bc33d801-3660-4520-a467-a639b5a13d0b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bc33d801-3660-4520-a467-a639b5a13d0b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-21dcd925-0648-4e72-a016-ad9ab8936cc2' class='xr-var-data-in' type='checkbox'><label for='data-21dcd925-0648-4e72-a016-ad9ab8936cc2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeNoLeap(1949, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1950, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1951, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1952, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1953, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1954, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1955, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1956, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1957, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1958, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1959, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1960, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1961, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1962, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1963, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1964, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1965, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1966, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1967, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1968, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1969, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1970, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1971, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1972, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1973, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1974, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1975, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1976, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1977, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1978, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1979, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1980, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1981, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1982, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1983, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1984, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1985, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1986, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1987, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1988, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1989, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1990, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1991, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1992, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1993, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1994, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1995, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1996, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1997, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1998, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(1999, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2000, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2001, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2002, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2003, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2004, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2005, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2006, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2007, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2008, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2009, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2010, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2011, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2012, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2013, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2014, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2015, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2016, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2017, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2018, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2019, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2020, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2021, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2022, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2023, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2024, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2025, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2026, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2027, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2028, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2029, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2030, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2031, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2032, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2033, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2034, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2035, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2036, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2037, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2038, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2039, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2040, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2041, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2042, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2043, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2044, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2045, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2046, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2047, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2048, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2049, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2050, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2051, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2052, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2053, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2054, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2055, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2056, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2057, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2058, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2059, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2060, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2061, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2062, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2063, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2064, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2065, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2066, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2067, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2068, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2069, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2070, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2071, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2072, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2073, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2074, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2075, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2076, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2077, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2078, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2079, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2080, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2081, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2082, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2083, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2084, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2085, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2086, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2087, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2088, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2089, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2090, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2091, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2092, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2093, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2094, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2095, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2096, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2097, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2098, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2099, 7, 1, 0, 0, 0, 0),
       cftime.DatetimeNoLeap(2100, 7, 1, 0, 0, 0, 0)], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>47.21</div><input id='attrs-6513d9e1-15d6-4cea-8d9f-7caf9deb889a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6513d9e1-15d6-4cea-8d9f-7caf9deb889a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2992b401-7835-420f-8004-58f206f1a294' class='xr-var-data-in' type='checkbox'><label for='data-2992b401-7835-420f-8004-58f206f1a294' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array(47.20742, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-70.3</div><input id='attrs-e5b6b799-17f4-47c7-aeee-90ae909fd49e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e5b6b799-17f4-47c7-aeee-90ae909fd49e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-44fd752f-ff85-4766-89dd-287053563169' class='xr-var-data-in' type='checkbox'><label for='data-44fd752f-ff85-4766-89dd-287053563169' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array(-70.29596, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>percentiles</span></div><div class='xr-var-dims'>(percentiles)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>10 50 90</div><input id='attrs-632aa300-2ba1-4645-9bfd-a9e0f7cbc883' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-632aa300-2ba1-4645-9bfd-a9e0f7cbc883' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f22894b6-6b89-49f5-a9a3-d3d5129cd9b1' class='xr-var-data-in' type='checkbox'><label for='data-f22894b6-6b89-49f5-a9a3-d3d5129cd9b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([10, 50, 90])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-334b0cc9-9f9d-430d-9f15-9c209a3e10fa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-334b0cc9-9f9d-430d-9f15-9c209a3e10fa' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>first_day_below</span></div><div class='xr-var-dims'>(time, percentiles)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 3), meta=np.ndarray&gt;</div><input id='attrs-3b00c2ed-e670-4389-b0da-7a92c9bf01a7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3b00c2ed-e670-4389-b0da-7a92c9bf01a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c0ec7f04-a2e2-4a5d-b86b-d6883cd6fb65' class='xr-var-data-in' type='checkbox'><label for='data-c0ec7f04-a2e2-4a5d-b86b-d6883cd6fb65' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd><dt><span>is_dayofyear :</span></dt><dd>1</dd><dt><span>calendar :</span></dt><dd>noleap</dd><dt><span>cell_methods :</span></dt><dd></dd><dt><span>xclim_history :</span></dt><dd>[2021-06-07 17:30:48] : Computation of the percentiles on 11 ensemble members. - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>day_of_year</dd><dt><span>long_name :</span></dt><dd>First day of year with temperature below -5 degc</dd><dt><span>description :</span></dt><dd>First day of year with temperature below -5 degc for at least 3 days.</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 3.56 kiB </td> <td> 24 B </td></tr>
    <tr><th> Shape </th><td> (152, 3) </td> <td> (1, 3) </td></tr>
    <tr><th> Count </th><td> 76595 Tasks </td><td> 152 Chunks </td></tr>
    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="78" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="28" y2="0" style="stroke-width:2" />
  <line x1="0" y1="6" x2="28" y2="6" />
  <line x1="0" y1="12" x2="28" y2="12" />
  <line x1="0" y1="18" x2="28" y2="18" />
  <line x1="0" y1="25" x2="28" y2="25" />
  <line x1="0" y1="31" x2="28" y2="31" />
  <line x1="0" y1="37" x2="28" y2="37" />
  <line x1="0" y1="44" x2="28" y2="44" />
  <line x1="0" y1="50" x2="28" y2="50" />
  <line x1="0" y1="56" x2="28" y2="56" />
  <line x1="0" y1="63" x2="28" y2="63" />
  <line x1="0" y1="69" x2="28" y2="69" />
  <line x1="0" y1="75" x2="28" y2="75" />
  <line x1="0" y1="82" x2="28" y2="82" />
  <line x1="0" y1="88" x2="28" y2="88" />
  <line x1="0" y1="94" x2="28" y2="94" />
  <line x1="0" y1="101" x2="28" y2="101" />
  <line x1="0" y1="107" x2="28" y2="107" />
  <line x1="0" y1="113" x2="28" y2="113" />
  <line x1="0" y1="120" x2="28" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="28" y1="0" x2="28" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 28.956184787186842,0.0 28.956184787186842,120.0 0.0,120.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="14.478092" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="48.956185" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,48.956185,60.000000)">152</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>frost_days</span></div><div class='xr-var-dims'>(time, percentiles)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 3), meta=np.ndarray&gt;</div><input id='attrs-42500d49-bcf7-403b-9e3f-e695ae6fa657' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-42500d49-bcf7-403b-9e3f-e695ae6fa657' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f01bcb1c-9e2d-48ca-b3d6-c8ad2f8aff8c' class='xr-var-data-in' type='checkbox'><label for='data-f01bcb1c-9e2d-48ca-b3d6-c8ad2f8aff8c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>days</dd><dt><span>cell_methods :</span></dt><dd> time: minimum within days time: sum over days</dd><dt><span>xclim_history :</span></dt><dd>[2021-06-07 17:30:48] : Computation of the percentiles on 11 ensemble members. - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>days_with_air_temperature_below_threshold</dd><dt><span>long_name :</span></dt><dd>Number of frost days (tmin &lt; 0c)</dd><dt><span>description :</span></dt><dd>Annual number of days with minimum daily temperature below 0℃.</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 3.56 kiB </td> <td> 24 B </td></tr>
    <tr><th> Shape </th><td> (152, 3) </td> <td> (1, 3) </td></tr>
    <tr><th> Count </th><td> 46437 Tasks </td><td> 152 Chunks </td></tr>
    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="78" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="28" y2="0" style="stroke-width:2" />
  <line x1="0" y1="6" x2="28" y2="6" />
  <line x1="0" y1="12" x2="28" y2="12" />
  <line x1="0" y1="18" x2="28" y2="18" />
  <line x1="0" y1="25" x2="28" y2="25" />
  <line x1="0" y1="31" x2="28" y2="31" />
  <line x1="0" y1="37" x2="28" y2="37" />
  <line x1="0" y1="44" x2="28" y2="44" />
  <line x1="0" y1="50" x2="28" y2="50" />
  <line x1="0" y1="56" x2="28" y2="56" />
  <line x1="0" y1="63" x2="28" y2="63" />
  <line x1="0" y1="69" x2="28" y2="69" />
  <line x1="0" y1="75" x2="28" y2="75" />
  <line x1="0" y1="82" x2="28" y2="82" />
  <line x1="0" y1="88" x2="28" y2="88" />
  <line x1="0" y1="94" x2="28" y2="94" />
  <line x1="0" y1="101" x2="28" y2="101" />
  <line x1="0" y1="107" x2="28" y2="107" />
  <line x1="0" y1="113" x2="28" y2="113" />
  <line x1="0" y1="120" x2="28" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="28" y1="0" x2="28" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 28.956184787186842,0.0 28.956184787186842,120.0 0.0,120.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="14.478092" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="48.956185" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,48.956185,60.000000)">152</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>solidprcptot</span></div><div class='xr-var-dims'>(time, percentiles)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 3), meta=np.ndarray&gt;</div><input id='attrs-dabcc97e-d412-41cc-9c5c-a0ede5f24793' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dabcc97e-d412-41cc-9c5c-a0ede5f24793' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-28a3f7a2-7c7e-4a4b-9e4e-6483ddf07d34' class='xr-var-data-in' type='checkbox'><label for='data-28a3f7a2-7c7e-4a4b-9e4e-6483ddf07d34' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd><dt><span>cell_methods :</span></dt><dd>tas:  time: mean within days time: sum within days time: sum over days</dd><dt><span>xclim_history :</span></dt><dd>[2021-06-07 17:30:48] : Computation of the percentiles on 11 ensemble members. - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_snowfall_amount</dd><dt><span>long_name :</span></dt><dd>Total solid precipitation</dd><dt><span>description :</span></dt><dd>Annual total solid precipitation, estimated as precipitation when temperature &lt; 0 degc</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 3.56 kiB </td> <td> 24 B </td></tr>
    <tr><th> Shape </th><td> (152, 3) </td> <td> (1, 3) </td></tr>
    <tr><th> Count </th><td> 64989 Tasks </td><td> 152 Chunks </td></tr>
    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="78" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="28" y2="0" style="stroke-width:2" />
  <line x1="0" y1="6" x2="28" y2="6" />
  <line x1="0" y1="12" x2="28" y2="12" />
  <line x1="0" y1="18" x2="28" y2="18" />
  <line x1="0" y1="25" x2="28" y2="25" />
  <line x1="0" y1="31" x2="28" y2="31" />
  <line x1="0" y1="37" x2="28" y2="37" />
  <line x1="0" y1="44" x2="28" y2="44" />
  <line x1="0" y1="50" x2="28" y2="50" />
  <line x1="0" y1="56" x2="28" y2="56" />
  <line x1="0" y1="63" x2="28" y2="63" />
  <line x1="0" y1="69" x2="28" y2="69" />
  <line x1="0" y1="75" x2="28" y2="75" />
  <line x1="0" y1="82" x2="28" y2="82" />
  <line x1="0" y1="88" x2="28" y2="88" />
  <line x1="0" y1="94" x2="28" y2="94" />
  <line x1="0" y1="101" x2="28" y2="101" />
  <line x1="0" y1="107" x2="28" y2="107" />
  <line x1="0" y1="113" x2="28" y2="113" />
  <line x1="0" y1="120" x2="28" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="28" y1="0" x2="28" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 28.956184787186842,0.0 28.956184787186842,120.0 0.0,120.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="14.478092" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="48.956185" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,48.956185,60.000000)">152</text>
</svg>
</td>
</tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cold_spell_frequency</span></div><div class='xr-var-dims'>(time, percentiles)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 3), meta=np.ndarray&gt;</div><input id='attrs-96c5b153-ab13-41d7-b315-41da9e07058e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-96c5b153-ab13-41d7-b315-41da9e07058e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6256348d-9be9-41d2-9ced-9907ceb8999b' class='xr-var-data-in' type='checkbox'><label for='data-6256348d-9be9-41d2-9ced-9907ceb8999b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd><dt><span>cell_methods :</span></dt><dd> time: mean within days</dd><dt><span>xclim_history :</span></dt><dd>[2021-06-07 17:30:48] : Computation of the percentiles on 11 ensemble members. - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>cold_spell_frequency</dd><dt><span>long_name :</span></dt><dd>Number of cold spell events</dd><dt><span>description :</span></dt><dd>Annual number cold spell events, defined as 3 or more consecutive days with mean daily temperature below  -10 degc.</dd></dl></div><div class='xr-var-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 3.56 kiB </td> <td> 24 B </td></tr>
    <tr><th> Shape </th><td> (152, 3) </td> <td> (1, 3) </td></tr>
    <tr><th> Count </th><td> 48178 Tasks </td><td> 152 Chunks </td></tr>
    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="78" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="28" y2="0" style="stroke-width:2" />
  <line x1="0" y1="6" x2="28" y2="6" />
  <line x1="0" y1="12" x2="28" y2="12" />
  <line x1="0" y1="18" x2="28" y2="18" />
  <line x1="0" y1="25" x2="28" y2="25" />
  <line x1="0" y1="31" x2="28" y2="31" />
  <line x1="0" y1="37" x2="28" y2="37" />
  <line x1="0" y1="44" x2="28" y2="44" />
  <line x1="0" y1="50" x2="28" y2="50" />
  <line x1="0" y1="56" x2="28" y2="56" />
  <line x1="0" y1="63" x2="28" y2="63" />
  <line x1="0" y1="69" x2="28" y2="69" />
  <line x1="0" y1="75" x2="28" y2="75" />
  <line x1="0" y1="82" x2="28" y2="82" />
  <line x1="0" y1="88" x2="28" y2="88" />
  <line x1="0" y1="94" x2="28" y2="94" />
  <line x1="0" y1="101" x2="28" y2="101" />
  <line x1="0" y1="107" x2="28" y2="107" />
  <line x1="0" y1="113" x2="28" y2="113" />
  <line x1="0" y1="120" x2="28" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="28" y1="0" x2="28" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 28.956184787186842,0.0 28.956184787186842,120.0 0.0,120.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="14.478092" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="48.956185" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,48.956185,60.000000)">152</text>
</svg>
</td>
</tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-81d914ea-70cc-48bf-ac85-e062ab323cef' class='xr-section-summary-in' type='checkbox'  checked><label for='section-81d914ea-70cc-48bf-ac85-e062ab323cef' class='xr-section-summary' >Attributes: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd><dt><span>is_dayofyear :</span></dt><dd>1</dd><dt><span>calendar :</span></dt><dd>noleap</dd><dt><span>cell_methods :</span></dt><dd></dd><dt><span>xclim_history :</span></dt><dd>[2021-06-07 17:30:48] : Computation of the percentiles on 11 ensemble members. - xclim version: 0.26.1.</dd><dt><span>standard_name :</span></dt><dd>day_of_year</dd><dt><span>long_name :</span></dt><dd>First day of year with temperature below -5 degc</dd><dt><span>description :</span></dt><dd>First day of year with temperature below -5 degc for at least 3 days.</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>However, the <code class="docutils literal notranslate"><span class="pre">first_day_below</span></code> indicator is problematic. The data is in a “day of year” (doy) format, an integer starting at <code class="docutils literal notranslate"><span class="pre">1</span></code> on January 1st and going to <code class="docutils literal notranslate"><span class="pre">365</span></code> on December 31st (in our <em>no leap</em> calendar). There might be years where the first day below 0°C happened <em>after</em> December 31st, meaning that taking the percentiles directly will give incorrect results. The trick is simply to convert the “day of year” data to a format where the numerical order reflects the temporal order within each period.</p>
<p>The next graph show the <em>incorrect</em> version. Notice how for the years where some members have values in January (<span class="math notranslate nohighlight">\(0 &lt; doy \le 31\)</span>), those “small” numerical values are classified into the <strong>10th</strong> percentile, while they are in fact <em>later dates</em>, so should be considered so and classified as the <strong>90th</strong> percentile.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="o">.</span><span class="n">first_day_below</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;realization&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">out_perc</span><span class="o">.</span><span class="n">first_day_below</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;percentiles&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Incorrect percentiles computation&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_25_0.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_25_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert &quot;doys&quot; to the number of days elapsed since the time coordinate (which is 1st of July)</span>
<span class="n">fda_days_since</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">calendar</span><span class="o">.</span><span class="n">doy_to_days_since</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">first_day_below</span><span class="p">)</span>

<span class="c1"># Take percentiles now that the numerical ordering is correct</span>
<span class="n">fda_days_since_perc</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">ensembles</span><span class="o">.</span><span class="n">ensemble_percentiles</span><span class="p">(</span><span class="n">fda_days_since</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">split</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Convert back to doys for meaningful values</span>
<span class="n">fda_doy_perc</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">calendar</span><span class="o">.</span><span class="n">days_since_to_doy</span><span class="p">(</span><span class="n">fda_days_since_perc</span><span class="p">)</span>

<span class="c1"># Replace the bad data with the good one</span>
<span class="n">out_perc</span><span class="p">[</span><span class="s1">&#39;first_day_below&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fda_doy_perc</span>
</pre></div>
</div>
</div>
</div>
<p>Voilà! Lets enjoy our work!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ProgressBar</span><span class="p">():</span>
    <span class="n">out_perc</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[########################################] | 100% Completed | 20.9s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">out_perc</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">var</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;percentiles&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_29_0.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_29_0.png" />
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_29_1.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_29_1.png" />
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_29_2.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_29_2.png" />
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_29_3.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_29_3.png" />
</div>
</div>
<p>Notice that the doy conversion trick did work for <code class="docutils literal notranslate"><span class="pre">first_day_below</span></code>, but plotting this kind of variable is not straightforward, and not the point of this notebook.</p>
</div>
</div>
<div class="section" id="bias-adjustment">
<h2>Bias-adjustment<a class="headerlink" href="#bias-adjustment" title="Permalink to this headline">¶</a></h2>
<p>Besides climate indicators, xclim comes with the <code class="docutils literal notranslate"><span class="pre">sdba</span></code> (statistical downscaling and bias-adjustment) module. The module tries to follow a “modular” approach instead of implementing published methods as black box functions. It comes with some pre- and post-processing function in <code class="docutils literal notranslate"><span class="pre">sdba.processing</span></code> and a few adjustment objects in <code class="docutils literal notranslate"><span class="pre">sdba.adjustment</span></code>. Adjustment algorithms all conform to the train - adjust scheme, formalized within <code class="docutils literal notranslate"><span class="pre">Adjustment</span></code> classes. Given a reference time series (<code class="docutils literal notranslate"><span class="pre">ref</span></code>), historical simulations (<code class="docutils literal notranslate"><span class="pre">hist</span></code>) and simulations to be adjusted (<code class="docutils literal notranslate"><span class="pre">sim</span></code>), any bias-adjustment method would be applied by first estimating the adjustment factors between the historical simulation and the observations series, and then applying these factors to <code class="docutils literal notranslate"><span class="pre">sim</span></code>, which could be a future simulation.</p>
<p>Most algorithms implemented also perform the adjustment separately on temporal groups. For example, for a <em>Quantile Mapping</em> method, one would compute quantiles and adjustment factors for each day of the year individually or within a moving window, so that seasonal variations do not interfere with the result.</p>
<div class="section" id="simple-quantile-mapping">
<h3>Simple quantile mapping<a class="headerlink" href="#simple-quantile-mapping" title="Permalink to this headline">¶</a></h3>
<p>Let’s start here with a simple <em>Empirical Quantile Mapping</em> adjustment for <code class="docutils literal notranslate"><span class="pre">pr</span></code>. Instead of adjusting a future period, we adjust the historical timeseries, so we can have a clear appreciation of the adjustment results. This adjustment method is based on [1].</p>
<p><strong>Multiplicative</strong> and <strong>Additive</strong> modes : In most of the literature, bias-adjustment involving <code class="docutils literal notranslate"><span class="pre">pr</span></code> is done in a <em>multiplicative</em> mode, in opposition to the <em>additive</em> mode used for temperatures. In xclim.sdba, this is controlled with the <code class="docutils literal notranslate"><span class="pre">kind</span></code> keyword, which defaults to <code class="docutils literal notranslate"><span class="pre">'+'</span></code> (additive). This means that <code class="docutils literal notranslate"><span class="pre">sim</span></code> values will be multiplied to the adjustment factors in the case <code class="docutils literal notranslate"><span class="pre">kind='*'</span></code>, and added (or subtracted) with <code class="docutils literal notranslate"><span class="pre">'+'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We are opening the datasets with xclim.testing.open_dataset</span>
<span class="c1"># a convenience function for accessing xclim&#39;s test and example datasets, stored in a github repository.</span>
<span class="n">dsref</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;sdba/ahccd_1950-2013.nc&#39;</span><span class="p">)</span>
<span class="n">dssim</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;sdba/CanESM2_1950-2100.nc&#39;</span><span class="p">)</span>

<span class="c1"># Extract 30 years of the daily data</span>
<span class="c1"># The data is made of 3 time series, we take only one &quot;location&quot;</span>
<span class="c1"># `ref` is given in Celsius, we must convert to Kelvin to fit with hist and sim</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">dsref</span><span class="o">.</span><span class="n">pr</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">),</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Vancouver&#39;</span><span class="p">)</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert_units_to</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="s1">&#39;mm/d&#39;</span><span class="p">)</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">dssim</span><span class="o">.</span><span class="n">pr</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">),</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Vancouver&#39;</span><span class="p">)</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert_units_to</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="s1">&#39;mm/d&#39;</span><span class="p">)</span>

<span class="c1"># We want to group data on a day-of-year basis with a 31-day moving window</span>
<span class="n">group_doy_31</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">sdba</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(</span><span class="s1">&#39;time.dayofyear&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>

<span class="c1"># Create the adjustment object</span>
<span class="n">EQM</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">sdba</span><span class="o">.</span><span class="n">EmpiricalQuantileMapping</span><span class="p">(</span><span class="n">nquantiles</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group_doy_31</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>

<span class="c1"># Train it</span>
<span class="n">EQM</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">hist</span><span class="p">)</span>

<span class="c1"># Adjust hist</span>
<span class="c1"># And we estimate correct adjustment factors by interpolating linearly between quantiles</span>
<span class="n">scen</span> <span class="o">=</span> <span class="n">EQM</span><span class="o">.</span><span class="n">adjust</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the season cycle</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ref</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.dayofyear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reference&#39;</span><span class="p">)</span>
<span class="n">hist</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.dayofyear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model - raw&#39;</span><span class="p">)</span>
<span class="n">scen</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.dayofyear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model - adjusted&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_32_0.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_32_0.png" />
</div>
</div>
<p>To inspect the trained adjustment data, we can access it with <code class="docutils literal notranslate"><span class="pre">EQM.ds</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">EQM</span><span class="o">.</span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (dayofyear: 365, quantiles: 17)
Coordinates:
  * quantiles  (quantiles) float64 1e-06 0.03333 0.1 0.1667 ... 0.9 0.9667 1.0
  * dayofyear  (dayofyear) int64 1 2 3 4 5 6 7 8 ... 359 360 361 362 363 364 365
Data variables:
    af         (dayofyear, quantiles) float64 nan 0.0 0.0 ... 1.377 1.684 1.686
    hist_q     (dayofyear, quantiles) float64 0.0 0.001463 ... 15.84 30.81
Attributes:
    _xclim_adjustment:  {&quot;py/object&quot;: &quot;xclim.sdba.adjustment.EmpiricalQuantil...
    adj_params:         EmpiricalQuantileMapping(nquantiles=15, kind=&#x27;*&#x27;, gro...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e0d38a44-48cb-4f4b-a0fe-47929bda49b4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e0d38a44-48cb-4f4b-a0fe-47929bda49b4' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>dayofyear</span>: 365</li><li><span class='xr-has-index'>quantiles</span>: 17</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-1bec9473-1cf6-4bf9-a48f-49c47eea1109' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1bec9473-1cf6-4bf9-a48f-49c47eea1109' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>quantiles</span></div><div class='xr-var-dims'>(quantiles)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e-06 0.03333 0.1 ... 0.9667 1.0</div><input id='attrs-089b74a3-04e3-4600-a548-80aada03f100' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-089b74a3-04e3-4600-a548-80aada03f100' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7c827c0-5aba-4213-b2f8-03bd7070833d' class='xr-var-data-in' type='checkbox'><label for='data-a7c827c0-5aba-4213-b2f8-03bd7070833d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.000000e-06, 3.333333e-02, 1.000000e-01, 1.666667e-01, 2.333333e-01,
       3.000000e-01, 3.666667e-01, 4.333333e-01, 5.000000e-01, 5.666667e-01,
       6.333333e-01, 7.000000e-01, 7.666667e-01, 8.333333e-01, 9.000000e-01,
       9.666667e-01, 9.999990e-01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>dayofyear</span></div><div class='xr-var-dims'>(dayofyear)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 361 362 363 364 365</div><input id='attrs-fc381ff7-cb5e-4b69-b360-04929bdb749d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fc381ff7-cb5e-4b69-b360-04929bdb749d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-944861a5-785c-47d5-8912-5101af42c2d9' class='xr-var-data-in' type='checkbox'><label for='data-944861a5-785c-47d5-8912-5101af42c2d9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3, ..., 363, 364, 365])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ccdd25c8-72af-40c5-af14-96f1ef66605b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ccdd25c8-72af-40c5-af14-96f1ef66605b' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>af</span></div><div class='xr-var-dims'>(dayofyear, quantiles)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan 0.0 0.0 ... 1.377 1.684 1.686</div><input id='attrs-37960165-0fb4-4a32-bd35-1a180406783c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-37960165-0fb4-4a32-bd35-1a180406783c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ade4f18-3c40-4dea-96c1-4f26efdbfe36' class='xr-var-data-in' type='checkbox'><label for='data-4ade4f18-3c40-4dea-96c1-4f26efdbfe36' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>group :</span></dt><dd>time.dayofyear</dd><dt><span>group_compute_dims :</span></dt><dd>[&#x27;time&#x27;, &#x27;window&#x27;]</dd><dt><span>group_window :</span></dt><dd>31</dd><dt><span>kind :</span></dt><dd>*</dd><dt><span>standard_name :</span></dt><dd>Adjustment factors</dd><dt><span>long_name :</span></dt><dd>Quantile mapping adjustment factors</dd></dl></div><div class='xr-var-data'><pre>array([[       nan, 0.        , 0.        , ..., 1.34326956, 1.6839163 ,
        1.68595758],
       [       nan, 0.        , 0.        , ..., 1.3399415 , 1.69931543,
        1.87782013],
       [       nan, 0.        , 0.        , ..., 1.38112983, 1.80769705,
        1.87790767],
       ...,
       [       nan, 0.        , 0.        , ..., 1.41380111, 1.64776177,
        1.68613026],
       [       nan, 0.        , 0.        , ..., 1.39573133, 1.75821816,
        1.68613019],
       [       nan, 0.        , 0.        , ..., 1.37734078, 1.6839163 ,
        1.68595758]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hist_q</span></div><div class='xr-var-dims'>(dayofyear, quantiles)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.001463 ... 15.84 30.81</div><input id='attrs-35f6b00c-1709-41d4-b0e5-bfe1563f8a40' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-35f6b00c-1709-41d4-b0e5-bfe1563f8a40' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-18fc0256-50db-4b04-b0d6-90a32c033409' class='xr-var-data-in' type='checkbox'><label for='data-18fc0256-50db-4b04-b0d6-90a32c033409' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>group :</span></dt><dd>time.dayofyear</dd><dt><span>group_compute_dims :</span></dt><dd>[&#x27;time&#x27;, &#x27;window&#x27;]</dd><dt><span>group_window :</span></dt><dd>31</dd><dt><span>standard_name :</span></dt><dd>Model quantiles</dd><dt><span>long_name :</span></dt><dd>Quantiles of model on the reference period</dd></dl></div><div class='xr-var-data'><pre>array([[0.00000000e+00, 1.46299199e-03, 2.51842570e-02, ...,
        1.17176781e+01, 1.58410487e+01, 3.08093478e+01],
       [0.00000000e+00, 1.43809352e-03, 2.41532803e-02, ...,
        1.18512636e+01, 1.59236673e+01, 3.08093458e+01],
       [0.00000000e+00, 1.25626475e-03, 1.96289500e-02, ...,
        1.17657295e+01, 1.59213626e+01, 3.08093437e+01],
       ...,
       [0.00000000e+00, 1.65549644e-03, 2.70511758e-02, ...,
        1.10475227e+01, 1.56050070e+01, 3.08091608e+01],
       [0.00000000e+00, 1.46448681e-03, 2.41532803e-02, ...,
        1.13488892e+01, 1.58387625e+01, 3.08091631e+01],
       [0.00000000e+00, 1.43791665e-03, 2.22453354e-02, ...,
        1.15004220e+01, 1.58410487e+01, 3.08093478e+01]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ecb6c179-c66c-4fa3-90b1-e3afc84faa99' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ecb6c179-c66c-4fa3-90b1-e3afc84faa99' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>_xclim_adjustment :</span></dt><dd>{&quot;py/object&quot;: &quot;xclim.sdba.adjustment.EmpiricalQuantileMapping&quot;, &quot;py/state&quot;: {&quot;nquantiles&quot;: 15, &quot;kind&quot;: &quot;*&quot;, &quot;group&quot;: {&quot;py/object&quot;: &quot;xclim.sdba.base.Grouper&quot;, &quot;py/state&quot;: {&quot;dim&quot;: &quot;time&quot;, &quot;add_dims&quot;: [&quot;window&quot;], &quot;prop&quot;: &quot;dayofyear&quot;, &quot;name&quot;: &quot;time.dayofyear&quot;, &quot;window&quot;: 31, &quot;interp&quot;: false}}, &quot;hist_calendar&quot;: &quot;noleap&quot;}}</dd><dt><span>adj_params :</span></dt><dd>EmpiricalQuantileMapping(nquantiles=15, kind=&#x27;*&#x27;, group=Grouper(add_dims=[&#x27;window&#x27;], name=&#x27;time.dayofyear&#x27;, window=31, interp=False))</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>More complex adjustment workflows can be created using the multiple tools exposed by xclim in <code class="docutils literal notranslate"><span class="pre">sdba.processing</span></code> and <code class="docutils literal notranslate"><span class="pre">sdba.detrending</span></code>. A more complete description of those is a bit too complex for the purposes of this notebook, but we invite interested users to look at <a class="reference external" href="https://xclim.readthedocs.io/en/stable/notebooks/sdba.html">the documentation</a>.</p>
<p>Let’s make another simple example, using the <code class="docutils literal notranslate"><span class="pre">DetrendedQuantileMapping</span></code> method. Compared to the <code class="docutils literal notranslate"><span class="pre">EmpiricalQuantileMapping</span></code> method, this one will normalize and detrend the inputs before computing the adjustment factors. This ensures a better quantile-to-quantile comparison when the climate change signal is strong. In reality, the same steps could all be performed explicitly, making use of xclim’s modularity, as is shown in the doc examples. It is based on [2].</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract the data.</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert_units_to</span><span class="p">(</span>
    <span class="n">dsref</span><span class="o">.</span><span class="n">tasmax</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">),</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Vancouver&#39;</span><span class="p">),</span>
    <span class="s1">&#39;K&#39;</span>
<span class="p">)</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert_units_to</span><span class="p">(</span>
    <span class="n">dssim</span><span class="o">.</span><span class="n">tasmax</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">),</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Vancouver&#39;</span><span class="p">),</span>
    <span class="s1">&#39;K&#39;</span>
<span class="p">)</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">convert_units_to</span><span class="p">(</span>
    <span class="n">dssim</span><span class="o">.</span><span class="n">tasmax</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;Vancouver&#39;</span><span class="p">),</span>
    <span class="s1">&#39;K&#39;</span>
<span class="p">)</span>


<span class="c1"># Adjustment</span>
<span class="n">DQM</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">sdba</span><span class="o">.</span><span class="n">DetrendedQuantileMapping</span><span class="p">(</span><span class="n">nquantiles</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group_doy_31</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">DQM</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">hist</span><span class="p">)</span>

<span class="n">scen</span> <span class="o">=</span> <span class="n">DQM</span><span class="o">.</span><span class="n">adjust</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ref</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.dayofyear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reference&#39;</span><span class="p">),</span>
<span class="n">hist</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.dayofyear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation - raw&#39;</span><span class="p">)</span>
<span class="n">scen</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1981&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.dayofyear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation - adjusted&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_37_0.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_37_0.png" />
</div>
</div>
<p>Just for fun, let’s compute the annual mean of the daily maximum temperature and plot the three time series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">xclim</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">cf_compliance</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">):</span>
    <span class="n">ref_tg</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">indicators</span><span class="o">.</span><span class="n">atmos</span><span class="o">.</span><span class="n">tx_mean</span><span class="p">(</span><span class="n">tasmax</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
    <span class="n">sim_tg</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">indicators</span><span class="o">.</span><span class="n">atmos</span><span class="o">.</span><span class="n">tx_mean</span><span class="p">(</span><span class="n">tasmax</span><span class="o">=</span><span class="n">sim</span><span class="p">)</span>
    <span class="n">scen_tg</span> <span class="o">=</span> <span class="n">xclim</span><span class="o">.</span><span class="n">indicators</span><span class="o">.</span><span class="n">atmos</span><span class="o">.</span><span class="n">tx_mean</span><span class="p">(</span><span class="n">tasmax</span><span class="o">=</span><span class="n">scen</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ref_tg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reference&#39;</span><span class="p">)</span>
<span class="n">sim_tg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model - Raw&#39;</span><span class="p">)</span>
<span class="n">scen_tg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model - Adjusted&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_39_0.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_39_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="finch-xclim-as-a-service">
<h2>Finch : xclim as a service<a class="headerlink" href="#finch-xclim-as-a-service" title="Permalink to this headline">¶</a></h2>
<p>This final part of the notebook demonstrates the use of <code class="docutils literal notranslate"><span class="pre">finch</span></code> to compute indicators over the web using the Web Processing Service (WPS) standard. When running this notebook on binder, a local server instance of finch is already running on port 5000. We will interact with it using <a class="reference external" href="https://birdy.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">birdy</span></code></a> a lightweight WPS client built upon <a class="reference external" href="https://geopython.github.io/OWSLib/"><code class="docutils literal notranslate"><span class="pre">OWSLib</span></code></a>.</p>
<div class="section" id="what-is-a-wps">
<h3>What is a WPS?<a class="headerlink" href="#what-is-a-wps" title="Permalink to this headline">¶</a></h3>
<p>Standardized by the OGC, WPS is a standard describing web requests and responses to and from geospatial processing services. The standard defines how process execution can be requested, and how the output from that process is handled. <code class="docutils literal notranslate"><span class="pre">finch</span></code> provides such a service, bundling xclim’s indicator and some other tools into individual processes.</p>
<p>It’s possible with WPS to either embed input data in the request, or pass a link to the data. In the latter case, the server will download data locally before performing its calculations. It’s also possible to use DAP links so the web server only streams the data it actually needs. In the following example, we use a subset of the ERA5 reanalysis data, available on xclim’s testdata GitHub repository.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">birdy</span> <span class="kn">import</span> <span class="n">WPSClient</span>

<span class="n">wps</span> <span class="o">=</span> <span class="n">WPSClient</span><span class="p">(</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="p">)</span>
<span class="n">dataurl</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/Ouranosinc/xclim-testdata/raw/main/ERA5/daily_surface_cancities_1990-1993.nc&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As in xclim, processes and their inputs are documented </span>
<span class="c1"># by parsing the indicator&#39;s attributes:</span>
<span class="n">help</span><span class="p">(</span><span class="n">wps</span><span class="o">.</span><span class="n">growing_degree_days</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on method growing_degree_days in module birdy.client.base:

growing_degree_days(tas=None, check_missing=&#39;any&#39;, cf_compliance=&#39;warn&#39;, data_validation=&#39;raise&#39;, thresh=&#39;4.0 degC&#39;, freq=&#39;YS&#39;, missing_options=None, variable=None, output_formats=None) method of birdy.client.base.WPSClient instance
    The sum of degree-days over the threshold temperature.
    
    Parameters
    ----------
    tas : ComplexData:mimetype:`application/x-netcdf`, :mimetype:`application/x-ogc-dods`
        NetCDF Files or archive (tar/zip) containing netCDF files.
    thresh : string
        Threshold temperature on which to base evaluation.
    freq : {&#39;YS&#39;, &#39;MS&#39;, &#39;QS-DEC&#39;, &#39;AS-JUL&#39;}string
        Resampling frequency.
    check_missing : {&#39;any&#39;, &#39;wmo&#39;, &#39;pct&#39;, &#39;at_least_n&#39;, &#39;skip&#39;, &#39;from_context&#39;}string
        Method used to determine which aggregations should be considered missing.
    missing_options : ComplexData:mimetype:`application/json`
        JSON representation of dictionary of missing method parameters.
    cf_compliance : {&#39;log&#39;, &#39;warn&#39;, &#39;raise&#39;}string
        Whether to log, warn or raise when inputs have non-CF-compliant attributes.
    data_validation : {&#39;log&#39;, &#39;warn&#39;, &#39;raise&#39;}string
        Whether to log, warn or raise when inputs fail data validation checks.
    variable : string
        Name of the variable in the NetCDF file.
    
    Returns
    -------
    output_netcdf : ComplexData:mimetype:`application/x-netcdf`
        The indicator values computed on the original input grid.
    output_log : ComplexData:mimetype:`text/plain`
        Collected logs during process run.
    ref : ComplexData:mimetype:`application/metalink+xml; version=4.0`
        Metalink file storing all references to output files.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Through birdy, the indicator call looks a lot like the one from xclim</span>
<span class="c1"># but passing an url instead of an xarray object.</span>
<span class="c1"># Also, the `variable` argument tells which variable from the dataset to use.</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">wps</span><span class="o">.</span><span class="n">growing_degree_days</span><span class="p">(</span>
    <span class="n">dataurl</span><span class="p">,</span>
    <span class="n">thresh</span><span class="o">=</span><span class="s1">&#39;5 degC&#39;</span><span class="p">,</span>
    <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;MS&#39;</span><span class="p">,</span>
    <span class="n">variable</span><span class="o">=</span><span class="s1">&#39;tas&#39;</span>
<span class="p">)</span>

<span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>growing_degree_daysResponse(
    output_netcdf=&#39;http://localhost:5000/outputs/c3603da3-c7d7-11eb-8e02-8cec4b2c9db7/out.nc&#39;,
    output_log=&#39;http://localhost:5000/outputs/c3603da3-c7d7-11eb-8e02-8cec4b2c9db7/log.txt&#39;,
    ref=&#39;http://localhost:5000/outputs/c3603da3-c7d7-11eb-8e02-8cec4b2c9db7/input.meta4&#39;
)
</pre></div>
</div>
</div>
</div>
<p>The response we received is a list of URLs pointing to output files. Birdy makes it easy to open links to datasets directly in xarray:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">asobj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">output_netcdf</span>
<span class="n">out</span><span class="o">.</span><span class="n">growing_degree_days</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;location&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_45_0.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_45_0.png" />
</div>
</div>
</div>
<div class="section" id="chain-computations">
<h3>Chain computations<a class="headerlink" href="#chain-computations" title="Permalink to this headline">¶</a></h3>
<p>As the goal of <code class="docutils literal notranslate"><span class="pre">finch</span></code> is to free the user of most, if not all, computation needs, it includes many other processes for all common climate analysis tasks. For example, here we will take maps of <code class="docutils literal notranslate"><span class="pre">tasmax</span></code> and <code class="docutils literal notranslate"><span class="pre">tasmin</span></code> over southern Québec, subset them with a square bounding box of lon/lat, compute <code class="docutils literal notranslate"><span class="pre">tas</span></code> as the mean of the other two and then finally, compute the growing season length with custom parameters.</p>
<p>All processes will be fed with the output of the previous one, so that no intermediate result is ever downloaded to the client. Only the last output is directly downloaded to file using python’s <code class="docutils literal notranslate"><span class="pre">urllib</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tasmax_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/Ouranosinc/xclim-testdata/raw/main/NRCANdaily/nrcan_canada_daily_tasmax_1990.nc&quot;</span>
<span class="n">tasmin_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/Ouranosinc/xclim-testdata/raw/main/NRCANdaily/nrcan_canada_daily_tasmin_1990.nc&quot;</span>
<span class="n">pr_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/Ouranosinc/xclim-testdata/raw/main/NRCANdaily/nrcan_canada_daily_pr_1990.nc&quot;</span>

<span class="c1"># Subset the maps</span>
<span class="n">resp_tx</span> <span class="o">=</span> <span class="n">wps</span><span class="o">.</span><span class="n">subset_bbox</span><span class="p">(</span><span class="n">tasmax_url</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=-</span><span class="mi">72</span><span class="p">,</span> <span class="n">lon1</span><span class="o">=-</span><span class="mi">68</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="mi">46</span><span class="p">,</span> <span class="n">lat1</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">resp_tn</span> <span class="o">=</span> <span class="n">wps</span><span class="o">.</span><span class="n">subset_bbox</span><span class="p">(</span><span class="n">tasmin_url</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=-</span><span class="mi">72</span><span class="p">,</span> <span class="n">lon1</span><span class="o">=-</span><span class="mi">68</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="mi">46</span><span class="p">,</span> <span class="n">lat1</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">resp_pr</span> <span class="o">=</span> <span class="n">wps</span><span class="o">.</span><span class="n">subset_bbox</span><span class="p">(</span><span class="n">pr_url</span><span class="p">,</span> <span class="n">lon0</span><span class="o">=-</span><span class="mi">72</span><span class="p">,</span> <span class="n">lon1</span><span class="o">=-</span><span class="mi">68</span><span class="p">,</span> <span class="n">lat0</span><span class="o">=</span><span class="mi">46</span><span class="p">,</span> <span class="n">lat1</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Compute tas</span>
<span class="c1"># We don&#39;t need to provide variable names because variables have the same names as the argument names</span>
<span class="n">resp_tg</span> <span class="o">=</span> <span class="n">wps</span><span class="o">.</span><span class="n">tg</span><span class="p">(</span><span class="n">tasmin</span><span class="o">=</span><span class="n">resp_tn</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">tasmax</span><span class="o">=</span><span class="n">resp_tx</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>

<span class="c1"># Compute growing season length, as defined by the period between</span>
<span class="c1"># Start/End when tas is over/under 10°C for 6 consecutive days</span>
<span class="n">resp_lpr</span> <span class="o">=</span> <span class="n">wps</span><span class="o">.</span><span class="n">liquid_precip_ratio</span><span class="p">(</span>
    <span class="n">pr</span><span class="o">=</span><span class="n">resp_pr</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">output</span><span class="p">,</span>
    <span class="n">tas</span><span class="o">=</span><span class="n">resp_tg</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">output_netcdf</span><span class="p">,</span>
    <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;YS&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the liquid precipitation ratio of 1990</span>
<span class="n">out_lpr</span> <span class="o">=</span> <span class="n">resp_lpr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">asobj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">output_netcdf</span>
<span class="n">out_lpr</span><span class="o">.</span><span class="n">liquid_precip_ratio</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7f0194f86700&gt;
</pre></div>
</div>
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_48_1.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_48_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># or we can plot it as a map!</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>

<span class="c1"># Set a CRS transformation:</span>
<span class="n">crs</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>

<span class="c1"># Add some map elements</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>
<span class="n">out_lpr</span><span class="o">.</span><span class="n">liquid_precip_ratio</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;rainbow&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_49_0.png" src="../../_images/PB_02_xclim_Software_ecosystem_for_climate_services_49_0.png" />
</div>
</div>
<p>Output attributes are formatted the same as when xclim is used locally:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out_lpr</span><span class="o">.</span><span class="n">liquid_precip_ratio</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;liquid_precip_ratio&#x27; (time: 1, lat: 48, lon: 48)&gt;
array([[[0.65363 , 0.651616, ..., 0.63733 , 0.629445],
        [0.651229, 0.650147, ..., 0.629233, 0.636435],
        ...,
        [0.798548, 0.797585, ...,      nan,      nan],
        [0.812997, 0.806936, ...,      nan,      nan]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 1990-01-01
  * lat      (lat) float32 49.96 49.88 49.79 49.71 ... 46.29 46.21 46.12 46.04
  * lon      (lon) float32 -71.96 -71.88 -71.79 -71.71 ... -68.21 -68.12 -68.04
Attributes:
    units:          
    cell_methods:   tas: tasmin: time: minimum within days tasmax: time: maxi...
    xclim_history:  pr: \ntas: \n[2021-06-07 17:32:05] liquid_precip_ratio: L...
    long_name:      Ratio of rainfall to total precipitation
    description:    Annual ratio of rainfall to total precipitation. rainfall...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'liquid_precip_ratio'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1</li><li><span class='xr-has-index'>lat</span>: 48</li><li><span class='xr-has-index'>lon</span>: 48</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-7a50913f-1d36-404a-8de2-cc5d41798dea' class='xr-array-in' type='checkbox' checked><label for='section-7a50913f-1d36-404a-8de2-cc5d41798dea' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.6536 0.6516 0.652 0.6528 0.6519 0.6517 ... nan nan nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[[0.65363 , 0.651616, ..., 0.63733 , 0.629445],
        [0.651229, 0.650147, ..., 0.629233, 0.636435],
        ...,
        [0.798548, 0.797585, ...,      nan,      nan],
        [0.812997, 0.806936, ...,      nan,      nan]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-3e4487f0-77eb-404f-93e9-58257462711a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3e4487f0-77eb-404f-93e9-58257462711a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1990-01-01</div><input id='attrs-0d08d56b-f627-4782-8439-2d3c11b9fbdb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0d08d56b-f627-4782-8439-2d3c11b9fbdb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f039c831-7422-443e-bed6-c49900f23824' class='xr-var-data-in' type='checkbox'><label for='data-f039c831-7422-443e-bed6-c49900f23824' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1990-01-01T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>49.96 49.88 49.79 ... 46.12 46.04</div><input id='attrs-bd3de87d-94eb-41ac-8b8b-6e284c857594' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bd3de87d-94eb-41ac-8b8b-6e284c857594' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a82c99a5-5ff4-446b-a93e-2684a9233504' class='xr-var-data-in' type='checkbox'><label for='data-a82c99a5-5ff4-446b-a93e-2684a9233504' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([49.958332, 49.875   , 49.791668, 49.708332, 49.625   , 49.541668,
       49.458332, 49.375   , 49.291668, 49.208332, 49.125   , 49.041668,
       48.958332, 48.875   , 48.791668, 48.708332, 48.625   , 48.541668,
       48.458332, 48.375   , 48.291668, 48.208332, 48.125   , 48.041668,
       47.958332, 47.875   , 47.791668, 47.708332, 47.625   , 47.541668,
       47.458332, 47.375   , 47.291668, 47.208332, 47.125   , 47.041668,
       46.958332, 46.875   , 46.791668, 46.708332, 46.625   , 46.541668,
       46.458332, 46.375   , 46.291668, 46.208332, 46.125   , 46.041668],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-71.96 -71.88 ... -68.12 -68.04</div><input id='attrs-22cf0193-1996-4544-87d3-e668e115d48b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-22cf0193-1996-4544-87d3-e668e115d48b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ccf3b33-9dd4-4857-abcf-c8a16b245a72' class='xr-var-data-in' type='checkbox'><label for='data-1ccf3b33-9dd4-4857-abcf-c8a16b245a72' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-71.958336, -71.875   , -71.79167 , -71.708336, -71.625   , -71.54167 ,
       -71.458336, -71.375   , -71.29167 , -71.208336, -71.125   , -71.04167 ,
       -70.958336, -70.875   , -70.79167 , -70.708336, -70.625   , -70.54167 ,
       -70.458336, -70.375   , -70.29167 , -70.208336, -70.125   , -70.04167 ,
       -69.958336, -69.875   , -69.79167 , -69.708336, -69.625   , -69.54167 ,
       -69.458336, -69.375   , -69.29167 , -69.208336, -69.125   , -69.04167 ,
       -68.958336, -68.875   , -68.79167 , -68.708336, -68.625   , -68.54167 ,
       -68.458336, -68.375   , -68.29167 , -68.208336, -68.125   , -68.04167 ],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-32f50259-454e-4fb1-9650-deeaf33f08c9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-32f50259-454e-4fb1-9650-deeaf33f08c9' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd><dt><span>cell_methods :</span></dt><dd>tas: tasmin: time: minimum within days tasmax: time: maximum within days time: mean within days</dd><dt><span>xclim_history :</span></dt><dd>pr: 
tas: 
[2021-06-07 17:32:05] liquid_precip_ratio: LIQUID_PRECIP_RATIO(pr=&lt;array&gt;, tas=&lt;array&gt;, thresh=&#x27;0 degC&#x27;, freq=&#x27;YS&#x27;, prsn=&lt;class &#x27;NoneType&#x27;&gt;) - xclim version: 0.26.0.</dd><dt><span>long_name :</span></dt><dd>Ratio of rainfall to total precipitation</dd><dt><span>description :</span></dt><dd>Annual ratio of rainfall to total precipitation. rainfall is estimated as precipitation on days where temperature is above 0 degc.</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="id1">
<h3>Ensemble statistics<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>In addition to the indicators and the subsetting processes, finch wraps xclim’s ensemble statistics functionality in all-in-one processes. All indicator are provided in several ensemble-subset processes, where the inputs are subsetted before the indicator is computed and ensemble statistics taken. For example, <code class="docutils literal notranslate"><span class="pre">ensemble_gridpoint_growing_season_length</span></code>, which computes <code class="docutils literal notranslate"><span class="pre">growing_season_length</span></code> over a single gridpoint for all members of the specified ensemble. However, at least for the current version, ensemble datasets are hardcoded in the configuration of the server instance and one can’t send their own list of members.</p>
<p>In order not to overload Ouranos’ servers where these current hardcoded datasets are stored, no example of this is run by default here. But interested users are invited to uncomment the following lines to see for themselves.</p>
<p>The ensemble data used by this example is a bias-adjusted and downscaled product from the Pacific Climate Impacts Consortium (PCIC). It is described <a class="reference external" href="https://www.pacificclimate.org/data/statistically-downscaled-climate-scenarios">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">wps</span><span class="o">.</span><span class="n">ensemble_grid_point_max_n_day_precipitation_amount</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on method ensemble_grid_point_max_n_day_precipitation_amount in module birdy.client.base:

ensemble_grid_point_max_n_day_precipitation_amount(lat, lon, rcp, check_missing=&#39;any&#39;, cf_compliance=&#39;warn&#39;, data_validation=&#39;raise&#39;, start_date=None, end_date=None, ensemble_percentiles=&#39;10,50,90&#39;, dataset_name=None, models=&#39;24MODELS&#39;, window=1, freq=&#39;YS&#39;, missing_options=None, output_format=&#39;netcdf&#39;, output_formats=None) method of birdy.client.base.WPSClient instance
    Calculate the n-day rolling sum of the original daily total precipitation series and determine the maximum value over each period.
    
    Parameters
    ----------
    lat : string
        Latitude coordinate. Accepts a comma separated list of floats for multiple grid cells.
    lon : string
        Longitude coordinate. Accepts a comma separated list of floats for multiple grid cells.
    start_date : string
        Initial date for temporal subsetting. Can be expressed as year (%Y), year-month (%Y-%m) or year-month-day(%Y-%m-%d). Defaults to first day in file.
    end_date : string
        Final date for temporal subsetting. Can be expressed as year (%Y), year-month (%Y-%m) or year-month-day(%Y-%m-%d). Defaults to last day in file.
    ensemble_percentiles : string
        Ensemble percentiles to calculate for input climate simulations. Accepts a comma separated list of integers.
    dataset_name : {&#39;bccaqv2&#39;}string
        Name of the dataset from which to get netcdf files for inputs.
    rcp : {&#39;rcp26&#39;, &#39;rcp45&#39;, &#39;rcp85&#39;}string
        Representative Concentration Pathway (RCP)
    models : {&#39;24MODELS&#39;, &#39;PCIC12&#39;, &#39;BNU-ESM&#39;, &#39;CCSM4&#39;, &#39;CESM1-CAM5&#39;, &#39;CNRM-CM5&#39;, &#39;CSIRO-Mk3-6-0&#39;, &#39;CanESM2&#39;, &#39;FGOALS-g2&#39;, &#39;GFDL-CM3&#39;, ...}string
        When calculating the ensemble, include only these models. By default, all 24 models are used.
    window : integer
        Window size in days.
    freq : {&#39;YS&#39;, &#39;MS&#39;, &#39;QS-DEC&#39;, &#39;AS-JUL&#39;}string
        Resampling frequency.
    check_missing : {&#39;any&#39;, &#39;wmo&#39;, &#39;pct&#39;, &#39;at_least_n&#39;, &#39;skip&#39;, &#39;from_context&#39;}string
        Method used to determine which aggregations should be considered missing.
    missing_options : ComplexData:mimetype:`application/json`
        JSON representation of dictionary of missing method parameters.
    cf_compliance : {&#39;log&#39;, &#39;warn&#39;, &#39;raise&#39;}string
        Whether to log, warn or raise when inputs have non-CF-compliant attributes.
    data_validation : {&#39;log&#39;, &#39;warn&#39;, &#39;raise&#39;}string
        Whether to log, warn or raise when inputs fail data validation checks.
    output_format : {&#39;netcdf&#39;, &#39;csv&#39;}string
        Choose in which format you want to recieve the result
    
    Returns
    -------
    output : ComplexData:mimetype:`application/x-netcdf`, :mimetype:`application/zip`
        The format depends on the &#39;output_format&#39; input parameter.
    output_log : ComplexData:mimetype:`text/plain`
        Collected logs during process run.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Get maximal 5 days precipitation amount for Niagara Falls between 2040 and 2070</span>
<span class="c1">## for 12 rcp45 datasets bias-adjusted and downscaled with BCCAQv2 by PCIC</span>
<span class="c1">## Careful : this call will take a long time to succeed!</span>

<span class="c1">#resp_ens = wps.ensemble_grid_point_max_n_day_precipitation_amount(</span>
<span class="c1">#    lat=43.08,</span>
<span class="c1">#    lon=-79.07,</span>
<span class="c1">#    start_date=&#39;2040-01-01&#39;,</span>
<span class="c1">#    end_date=&#39;2070-12-31&#39;,</span>
<span class="c1">#    ensemble_percentiles=[10, 50, 90],</span>
<span class="c1">#    rcp=&#39;rcp45&#39;,</span>
<span class="c1">#    models=&#39;PCIC12&#39;,</span>
<span class="c1">#    window=5,</span>
<span class="c1">#    freq=&#39;YS&#39;,</span>
<span class="c1">#    data_validation=&#39;warn&#39;,</span>
<span class="c1">#)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#resp_ens.get(asobj=True).output</span>
</pre></div>
</div>
</div>
</div>
<p>This concludes our xclim and finch tour! We hope these tools can be useful for your workflows. The development of both is always on-going, visit us at our GitHub pages for any questions or if you want to contribute!</p>
<p><a class="reference external" href="https://github.com/Ouranosinc/xclim/"><code class="docutils literal notranslate"><span class="pre">xclim</span></code></a></p>
<p><a class="reference external" href="https://github.com/bird-house/finch/"><code class="docutils literal notranslate"><span class="pre">finch</span></code></a></p>
</div>
</div>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>Bias-adjustment<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>[1] Dequé, M. (2007). Frequency of precipitation and temperature extremes over France in an anthropogenic scenario: Model results and statistical correction according to observed values. Global and Planetary Change, 57(1–2), 16–26. <a class="reference external" href="https://doi.org/10.1016/j.gloplacha.2006.11.030">https://doi.org/10.1016/j.gloplacha.2006.11.030</a></p>
<p>[2] Cannon, A. J., Sobie, S. R., &amp; Murdock, T. Q. (2015). Bias correction of GCM precipitation by quantile mapping: How well do methods preserve changes in quantiles and extremes? Journal of Climate, 28(17), 6938–6959. <a class="reference external" href="https://doi.org/10.1175/JCLI-D-14-00754.1">https://doi.org/10.1175/JCLI-D-14-00754.1</a></p>
</div>
<div class="section" id="software-used">
<h2>Software used<a class="headerlink" href="#software-used" title="Permalink to this headline">¶</a></h2>
<p><strong>xarray 0.18.2</strong> : Stephan Hoyer, Joe Hamman, Maximilian Roos, keewis, Deepak Cherian, Clark Fitzgerald, … Benoit Bovy. (2021, May 19). pydata/xarray: v0.18.2 (Version v0.18.2). Zenodo. <a class="reference external" href="http://doi.org/10.5281/zenodo.4774304">http://doi.org/10.5281/zenodo.4774304</a></p>
<p><strong>numpy</strong> : Harris, C.R., Millman, K.J., van der Walt, S.J. et al. Array programming with NumPy. Nature 585, 357–362 (2020). DOI: 0.1038/s41586-020-2649-2</p>
<p><strong>dask</strong> : Dask Development Team (2016). Dask: Library for dynamic task scheduling
URL <a class="reference external" href="https://dask.org">https://dask.org</a></p>
<p><strong>cftime 1.4</strong> : Jeff Whitaker, Constantine Khrulev, Spencer Clark, Joe Hamman, Bill Little, Ryan May, … Stefan. (2021, January 31). Unidata/cftime: version 1.4.0 release (Version v1.4.0rel). Zenodo. <a class="reference external" href="http://doi.org/10.5281/zenodo.4484141">http://doi.org/10.5281/zenodo.4484141</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/ec21_bourgault_etal"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="README.html" title="previous page">xclim : Software ecosystem for climate services</a>
    <a class='right-next' id="next-link" href="../ec21_cherian_etal/DC_01_cf-xarray.html" title="next page">cf-xarray: Scale your analysis across datasets with less data wrangling and more metadata handling</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By EarthCube Office<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>