
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>12.4. Toward autonomous detection of anomalous GNSS data via applied unsupervised artificial intelligence &#8212; EarthCube 2021 Call for Notebooks</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="13. Exploring Research Data Repositories with geoextent." href="../ec21_garzon_etal/README.html" />
    <link rel="prev" title="7. Toward autonomous detection of anomalous GNSS data via applied unsupervised artificial intelligence" href="README.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.webp" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">EarthCube 2021 Call for Notebooks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  EarthCube 2021 Call
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/about.html">
   Call for Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   2021 Notebooks
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Notebook Submissions
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_anil_etal/README.html">
   1. Hydrographic Ocean Data Exploration
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_anil_etal/SA_01_Argo_Data_Exploration.html">
     1.1. Interactive Jupyter notebook for hydrographic ocean data exploration, retrieval and visualization via the Argovis API
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_balwada_etal/README.html">
   2. Interactive Visualization Tools for Ocean Glider Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_balwada_etal/DB_01_Glider_Viz_Panel.html">
     2.2. Glider Viz Panel
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_beckley_etal/README.html">
   3. Programmatic Access to OpenTopography’s Cloud Optimized Geotiff (COG) Global Datasets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_beckley_etal/OT_01_BulkAccessCOGs.html">
     3.1. Programmatic Access to OpenTopography’s Cloud Optimized GeoTIFF (COG) Global Datasets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_bourgault_etal/README.html">
   4. xclim : Software ecosystem for climate services
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_bourgault_etal/PB_02_xclim_Software_ecosystem_for_climate_services.html">
     4.1. xclim: Software ecosystem for climate services
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_cherian_etal/README.html">
   5. cf-xarray-earthcube
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_cherian_etal/DC_01_cf-xarray.html">
     5.1. cf-xarray: Scale your analysis across datasets with less data wrangling and more metadata handling
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_cych_etal/readme.html">
   6. Reanalysis of archived paleointensity data using a new statistical method.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_cych_etal/BC_01%20Bias%20Corrected%20Estimation%20of%20Paleointensity.html">
     6.1. BC_01 Bias Corrected Estimation of Paleointensity
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="README.html">
   7. Toward autonomous detection of anomalous GNSS data via applied unsupervised artificial intelligence
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_garzon_etal/README.html">
   13. Exploring Research Data Repositories with geoextent.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_garzon_etal/showcase/SG_01_Exploring_Research_Data_Repositories_with_geoextent.html">
     13.4. Exploring Research Data Repositories with geoextent
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_gray_etal/README.html">
   14. Leveraging satellite data and pangeo to investigate the role of Gulf Stream frontal dynamics in ocean productivity
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_gray_etal/PG_01_gulf_stream_dynamics_role_in_productivity.html">
     14.3. Leveraging satellite data and pangeo to investigate the role of Gulf Stream frontal dynamics in ocean productivity
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_hu_etal/README.html">
   15. Machine Learning Guided Weather Analogs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_hu_etal/WH_01_Spatio-Temporal_Deep_Analogs_2021.html">
     15.5. WH_01_Spatio-Temporal_Deep_Analogs_2021
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_lopez_etal/README.html">
   16. ITS_LIVE Explorer
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_lopez_etal/notebooks/itslive-notebook-rendered.html">
     16.7. Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_lopez_etal/notebooks/LL_01_ITS_LIVE_global_glacier_velocity_exploration_and_analysis.html">
     16.8.
     <strong>
      ITS_LIVE
     </strong>
     Global Glacier Velocity Exploration and Analysis
     <a class="anchor" id="chapter_1">
     </a>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_martin_etal/README.html">
   17. Frequency-domain analysis of large datasets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_martin_etal/PM_01_Frequency-Domain_Analysis_of_Large_Datasets.html">
     17.1. Frequency-Domain Analysis of Large Datasets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ec21_mason_etal/README.html">
   18. Volcanic Activity Detection
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_maussion_etal/README.html">
   20. OGGM-edu EarthCube notebook
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_maussion_etal/FM_01_OGGM-Edu_learn_and_teach_about_glaciers.html">
     20.3. OGGM-Edu - Jupyter notebooks to learn and teach about glaciers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_potnis_etal/README.html">
   21. JP 01 Real Time Alignment and Distribution of Weather Radar Data with Rain Gauge Data for Deep Learn
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_potnis_etal/JP_01_Real_Time_Alignment_and_Distribution_of_Weather_Radar_Data_with_Rain_Gauge_Data_for_Deep_Learning_using_CHORDS.html">
     21.1. Real Time Alignment and Distribution of Weather Radar Data with Rain Gauge Data for Deep Learning using CHORDS
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ec21_seijo_etal/README.html">
   22. Notebook: Investigating upper ocean variability during tropical cyclones and seasonal sea ice formation and melting: Argovis APIs exposed to co-locate oceanic and atmospheric datasets
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_shi_etal/README.html">
   29. Automated Machine Learning for Earth Science via AutoGluon
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_shi_etal/Xingjian_Shi_01_Automated_Machine_Learning_for_Earth_Science_via_AutoGluon.html">
     29.1. Automated Machine Learning for Earth Science via AutoGluon
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_uchida_etal/README.html">
   30. QG Eliassen-Palm flux
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_uchida_etal/notebooks/TU_05_Diagnosing-the-Eliassen-Palm-flux-from-a-quasi-geostrophic-double-gyre-ensemble.html">
     30.1. Diagnosing the Eliassen-Palm flux from a quasi-geostrophic double gyre ensemble
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ec21_zheng_etal/README.html">
   31. EZ-FeatureTrack
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ec21_zheng_etal/notebooks/WZ_01_mapping_ice_flow_velocity.html">
     31.3. Mapping ice flow velocity using an easy and interactive feature tracking workflow
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/ec21_dye_etal/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   12.4. Toward autonomous detection of anomalous GNSS data via applied unsupervised artificial intelligence
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#authors">
     12.4.1. Authors
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#purpose">
     12.4.2. Purpose
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#technical-contributions">
     12.4.3. Technical contributions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#methodology">
     12.4.4. Methodology
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#results">
     12.4.5. Results
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#funding">
     12.4.6. Funding
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#keywords">
     12.4.7. Keywords
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#citation">
     12.4.8. Citation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#suggested-next-steps">
     12.4.9. Suggested next steps
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acknowledgements">
     12.4.10. Acknowledgements
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#license">
     12.4.11. License
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#glossary">
     12.4.12. Glossary
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   12.5. Setup
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#library-import">
     12.5.1. Library import
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-library-import">
     12.5.2. Local library import
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parameter-definitions">
   12.6. Parameter definitions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-import">
   12.7. Data import
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#important-note-on-imported-data">
     12.7.1. Important note on imported data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-the-instrument-id-and-the-start-and-end-date-of-the-data-to-be-processed-and-analyzed">
     12.7.2. Select the instrument ID and the start and end date of the data to be processed and analyzed
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-data-file-for-use-during-analysis">
     12.7.3. Select data file for use during analysis
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-contents-of-the-selected-file-in-to-a-pandas-object">
     12.7.4. Read contents of the selected file in to a pandas object
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-processing-and-analysis">
   12.8. Data processing and analysis
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resample-the-data-to-fill-in-holes-in-the-time-series">
     12.8.1. Resample the data to fill in holes in the time series
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#make-a-copy-of-the-unmodified-data">
       12.8.1.1. Make a copy of the unmodified data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#alternative-method-make-a-copy-of-unmodified-data-and-resample-the-time-series-to-fill-in-any-missing-time-values-in-the-series">
       12.8.1.2. Alternative method: Make a copy of unmodified data
       <strong>
        and
       </strong>
       resample the time series to fill in any missing time values in the series
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rescale-the-features">
     12.8.2. Rescale the Features
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-the-vector-magnitude">
     12.8.3. Calculate the Vector Magnitude
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-features">
     12.8.4. Plot the Features
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identify-outliers-for-each-feature-with-the-gaussian-mixtures-algorithm">
     12.8.5. Identify outliers for each feature with the Gaussian Mixtures algorithm
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-outliers-for-the-scaled-height-feature">
       12.8.5.1. Find outliers for the Scaled Height feature
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-outliers-for-the-scaled-latitude-feature">
       12.8.5.2. Find outliers for the Scaled Latitude feature
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-outliers-for-the-scaled-longitude-feature">
       12.8.5.3. Find outliers for the Scaled Longitude feature
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#find-outliers-for-the-vector-magnitude-feature">
       12.8.5.4. Find outliers for the Vector Magnitude feature
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#consolidate-the-arrays-of-times-to-remove-in-to-one-object">
       12.8.5.5. Consolidate the arrays of times to remove in to one object
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#create-a-new-pandas-object-with-the-points-identified-by-the-algorithm-removed">
       12.8.5.6. Create a new pandas object with the points identified by the algorithm removed
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-cleaned-data-on-top-of-the-original-data">
       12.8.5.7. Plot the “cleaned” data on top of the original data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identify-anomalies-for-each-feature-using-the-k-means-algorithm">
     12.8.6. Identify anomalies for each feature using the K-means algorithm
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       12.8.6.1. find outliers for the Scaled Height feature
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       12.8.6.2. find outliers for the Scaled Latitude feature
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       12.8.6.3. find outliers for the Scaled Longitude feature
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       12.8.6.4. find outliers for the Vector Magnitude feature
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#training-the-neural-net">
     12.8.7. Training the neural net
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#training-on-unfiltered-data">
       12.8.7.1. Training on unfiltered data
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#generate-the-training-set">
         12.8.7.1.1. Generate the training set
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#create-and-train-the-neural-network-model">
         12.8.7.1.2. Create and train the neural network model
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#use-the-trained-model-to-make-prediction-for-n-steps-ahead-time-increments">
         12.8.7.1.3. Use the trained model to make prediction for
         <em>
          N_STEPS_AHEAD
         </em>
         time increments
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#training-on-data-filtered-using-gaussian-mixtures">
       12.8.7.2. Training on data filtered using Gaussian Mixtures
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         12.8.7.2.1. Generate the training set
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id6">
         12.8.7.2.2. Create and train the neural network model
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         12.8.7.2.3. Use the trained model to make prediction for
         <em>
          N_STEPS_AHEAD
         </em>
         time increments
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#training-on-data-filtered-using-k-means">
       12.8.7.3. Training on data filtered using K-Means
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id8">
         12.8.7.3.1. Generate the training set
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id9">
         12.8.7.3.2. #### Create and train the neural network model
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id10">
         12.8.7.3.3. Use the trained model to make prediction for
         <em>
          N_STEPS_AHEAD
         </em>
         time increments
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plots-of-unfiltered-data">
       12.8.7.4. Plots of unfiltered data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plots-of-gaussian-mixtures-cleaned-filtered-data">
       12.8.7.5. Plots of Gaussian Mixtures cleaned / filtered data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plots-of-k-means-cleaned-filtered-data">
       12.8.7.6. Plots of K-means cleaned / filtered data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-the-accuracy-of-the-prediction-made-by-the-different-trained-models">
     12.8.8. Compare the accuracy of the prediction made by the different trained models
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-mse-of-the-unmodified-data">
       12.8.8.1. The MSE of the unmodified data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-mse-of-the-gaussian-mixtures-cleaned-data">
       12.8.8.2. The MSE of the Gaussian Mixtures cleaned data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-mse-of-the-k-means-cleaned-data">
       12.8.8.3. The MSE of the K-Means cleaned data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#percent-improvement-in-neural-network-predictions">
       12.8.8.4. Percent improvement in neural network predictions
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   12.9. References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="toward-autonomous-detection-of-anomalous-gnss-data-via-applied-unsupervised-artificial-intelligence">
<h1><span class="section-number">12.4. </span>Toward autonomous detection of anomalous GNSS data via applied unsupervised artificial intelligence<a class="headerlink" href="#toward-autonomous-detection-of-anomalous-gnss-data-via-applied-unsupervised-artificial-intelligence" title="Permalink to this headline">¶</a></h1>
<p>Unsupervised Anomaly Detection of TZVOLCANO GNSS Data using Gaussian Mixtures. Once loaded in Binder, please run all the cells to properly initialize values and GUI elements.</p>
<div class="section" id="authors">
<h2><span class="section-number">12.4.1. </span>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<p>Mike Dye, D. Sarah Stamps, Myles Mason</p>
<ul class="simple">
<li><p>Author1 = {“name”: “Mike Dye”, “affiliation”: “Unaffiliated”, “email”: “<a class="reference external" href="mailto:mike&#37;&#52;&#48;mikedye&#46;com">mike<span>&#64;</span>mikedye<span>&#46;</span>com</a>”, “orcid”: “0000-0003-2065-870X”}</p></li>
<li><p>Author2 = {“name”: “Dr. Sarah Stamps”, “affiliation”: “Virginia Tech”, “email”: “<a class="reference external" href="mailto:dstamps&#37;&#52;&#48;vt&#46;edu">dstamps<span>&#64;</span>vt<span>&#46;</span>edu</a>”, “orcid”: “0000-0002-3531-1752”}</p></li>
<li><p>Author3 = {“name”: “Myles Mason”, “affiliation”: “Virginia Tech”, “email”: “<a class="reference external" href="mailto:mylesm18&#37;&#52;&#48;vt&#46;edu">mylesm18<span>&#64;</span>vt<span>&#46;</span>edu</a>”, “orcid”: “0000-0002-8811-8294”}</p></li>
</ul>
<h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Toward-autonomous-detection-of-anomalous-GNSS-data-via-applied-unsupervised-artificial-intelligence" data-toc-modified-id="Toward-autonomous-detection-of-anomalous-GNSS-data-via-applied-unsupervised-artificial-intelligence-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Toward autonomous detection of anomalous GNSS data via applied unsupervised artificial intelligence</a></span><ul class="toc-item"><li><span><a href="#Authors" data-toc-modified-id="Authors-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Authors</a></span></li><li><span><a href="#Purpose" data-toc-modified-id="Purpose-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Purpose</a></span></li><li><span><a href="#Technical-contributions" data-toc-modified-id="Technical-contributions-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Technical contributions</a></span></li><li><span><a href="#Methodology" data-toc-modified-id="Methodology-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>Methodology</a></span></li><li><span><a href="#Results" data-toc-modified-id="Results-1.5"><span class="toc-item-num">1.5&nbsp;&nbsp;</span>Results</a></span></li><li><span><a href="#Funding" data-toc-modified-id="Funding-1.6"><span class="toc-item-num">1.6&nbsp;&nbsp;</span>Funding</a></span></li><li><span><a href="#Keywords" data-toc-modified-id="Keywords-1.7"><span class="toc-item-num">1.7&nbsp;&nbsp;</span>Keywords</a></span></li><li><span><a href="#Citation" data-toc-modified-id="Citation-1.8"><span class="toc-item-num">1.8&nbsp;&nbsp;</span>Citation</a></span></li><li><span><a href="#Suggested-next-steps" data-toc-modified-id="Suggested-next-steps-1.9"><span class="toc-item-num">1.9&nbsp;&nbsp;</span>Suggested next steps</a></span></li><li><span><a href="#Acknowledgements" data-toc-modified-id="Acknowledgements-1.10"><span class="toc-item-num">1.10&nbsp;&nbsp;</span>Acknowledgements</a></span></li><li><span><a href="#License" data-toc-modified-id="License-1.11"><span class="toc-item-num">1.11&nbsp;&nbsp;</span>License</a></span></li><li><span><a href="#Glossary" data-toc-modified-id="Glossary-1.12"><span class="toc-item-num">1.12&nbsp;&nbsp;</span>Glossary</a></span></li></ul></li><li><span><a href="#Setup" data-toc-modified-id="Setup-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Setup</a></span><ul class="toc-item"><li><span><a href="#Library-import" data-toc-modified-id="Library-import-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Library import</a></span></li><li><span><a href="#Local-library-import" data-toc-modified-id="Local-library-import-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Local library import</a></span></li></ul></li><li><span><a href="#Parameter-definitions" data-toc-modified-id="Parameter-definitions-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Parameter definitions</a></span></li><li><span><a href="#Data-import" data-toc-modified-id="Data-import-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Data import</a></span><ul class="toc-item"><li><ul class="toc-item"><li><span><a href="#Important-note-on-imported-data" data-toc-modified-id="Important-note-on-imported-data-4.0.1"><span class="toc-item-num">4.0.1&nbsp;&nbsp;</span>Important note on imported data</a></span></li></ul></li><li><span><a href="#Select-the-instrument-ID-and-the-start-and-end-date-of-the-data-to-be-processed-and-analyzed" data-toc-modified-id="Select-the-instrument-ID-and-the-start-and-end-date-of-the-data-to-be-processed-and-analyzed-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Select the instrument ID and the start and end date of the data to be processed and analyzed</a></span></li><li><span><a href="#Select-data-file-for-use-during-analysis" data-toc-modified-id="Select-data-file-for-use-during-analysis-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Select data file for use during analysis</a></span></li><li><span><a href="#Read-contents-of-the-selected-file-in-to-a-pandas-object" data-toc-modified-id="Read-contents-of-the-selected-file-in-to-a-pandas-object-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>Read contents of the selected file in to a pandas object</a></span></li></ul></li><li><span><a href="#Data-processing-and-analysis" data-toc-modified-id="Data-processing-and-analysis-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Data processing and analysis</a></span><ul class="toc-item"><li><span><a href="#Resample-the-data-to-fill-in-holes-in-the-time-series" data-toc-modified-id="Resample-the-data-to-fill-in-holes-in-the-time-series-5.1"><span class="toc-item-num">5.1&nbsp;&nbsp;</span>Resample the data to fill in holes in the time series</a></span><ul class="toc-item"><li><span><a href="#Make-a-copy-of-the-unmodified-data" data-toc-modified-id="Make-a-copy-of-the-unmodified-data-5.1.1"><span class="toc-item-num">5.1.1&nbsp;&nbsp;</span>Make a copy of the unmodified data</a></span></li><li><span><a href="#Alternative-method:-Make-a-copy-of-unmodified-data-and-resample-the-time-series-to-fill-in-any-missing-time-values-in-the-series" data-toc-modified-id="Alternative-method:-Make-a-copy-of-unmodified-data-and-resample-the-time-series-to-fill-in-any-missing-time-values-in-the-series-5.1.2"><span class="toc-item-num">5.1.2&nbsp;&nbsp;</span>Alternative method: Make a copy of unmodified data <strong>and</strong> resample the time series to fill in any missing time values in the series</a></span></li></ul></li><li><span><a href="#Rescale-the-Features" data-toc-modified-id="Rescale-the-Features-5.2"><span class="toc-item-num">5.2&nbsp;&nbsp;</span>Rescale the Features</a></span></li><li><span><a href="#Calculate-the-Vector-Magnitude" data-toc-modified-id="Calculate-the-Vector-Magnitude-5.3"><span class="toc-item-num">5.3&nbsp;&nbsp;</span>Calculate the Vector Magnitude</a></span></li><li><span><a href="#Plot-the-Features" data-toc-modified-id="Plot-the-Features-5.4"><span class="toc-item-num">5.4&nbsp;&nbsp;</span>Plot the Features</a></span></li><li><span><a href="#Identify-outliers-for-each-feature-with-the-Gaussian-Mixtures-algorithm" data-toc-modified-id="Identify-outliers-for-each-feature-with-the-Gaussian-Mixtures-algorithm-5.5"><span class="toc-item-num">5.5&nbsp;&nbsp;</span>Identify outliers for each feature with the Gaussian Mixtures algorithm</a></span><ul class="toc-item"><li><span><a href="#Find-outliers-for-the-Scaled-Height-feature" data-toc-modified-id="Find-outliers-for-the-Scaled-Height-feature-5.5.1"><span class="toc-item-num">5.5.1&nbsp;&nbsp;</span>Find outliers for the Scaled Height feature</a></span></li><li><span><a href="#Find-outliers-for-the-Scaled-Latitude-feature" data-toc-modified-id="Find-outliers-for-the-Scaled-Latitude-feature-5.5.2"><span class="toc-item-num">5.5.2&nbsp;&nbsp;</span>Find outliers for the Scaled Latitude feature</a></span></li><li><span><a href="#Find-outliers-for-the-Scaled-Longitude-feature" data-toc-modified-id="Find-outliers-for-the-Scaled-Longitude-feature-5.5.3"><span class="toc-item-num">5.5.3&nbsp;&nbsp;</span>Find outliers for the Scaled Longitude feature</a></span></li><li><span><a href="#Find-outliers-for-the-Vector-Magnitude-feature" data-toc-modified-id="Find-outliers-for-the-Vector-Magnitude-feature-5.5.4"><span class="toc-item-num">5.5.4&nbsp;&nbsp;</span>Find outliers for the Vector Magnitude feature</a></span></li><li><span><a href="#Consolidate-the-arrays-of-times-to-remove-in-to-one-object" data-toc-modified-id="Consolidate-the-arrays-of-times-to-remove-in-to-one-object-5.5.5"><span class="toc-item-num">5.5.5&nbsp;&nbsp;</span>Consolidate the arrays of times to remove in to one object</a></span></li><li><span><a href="#Create-a-new-pandas-object-with-the-points-identified-by-the-algorithm-removed" data-toc-modified-id="Create-a-new-pandas-object-with-the-points-identified-by-the-algorithm-removed-5.5.6"><span class="toc-item-num">5.5.6&nbsp;&nbsp;</span>Create a new pandas object with the points identified by the algorithm removed</a></span></li><li><span><a href="#Plot-the-&quot;cleaned&quot;-data-on-top-of-the-original-data" data-toc-modified-id="Plot-the-&quot;cleaned&quot;-data-on-top-of-the-original-data-5.5.7"><span class="toc-item-num">5.5.7&nbsp;&nbsp;</span>Plot the "cleaned" data on top of the original data</a></span></li></ul></li><li><span><a href="#Identify-anomalies-for-each-feature-using-the-K-means-algorithm" data-toc-modified-id="Identify-anomalies-for-each-feature-using-the-K-means-algorithm-5.6"><span class="toc-item-num">5.6&nbsp;&nbsp;</span>Identify anomalies for each feature using the K-means algorithm</a></span><ul class="toc-item"><li><span><a href="#find-outliers-for-the-Scaled-Height-feature" data-toc-modified-id="find-outliers-for-the-Scaled-Height-feature-5.6.1"><span class="toc-item-num">5.6.1&nbsp;&nbsp;</span>find outliers for the Scaled Height feature</a></span></li><li><span><a href="#find-outliers-for-the-Scaled-Latitude-feature" data-toc-modified-id="find-outliers-for-the-Scaled-Latitude-feature-5.6.2"><span class="toc-item-num">5.6.2&nbsp;&nbsp;</span>find outliers for the Scaled Latitude feature</a></span></li><li><span><a href="#find-outliers-for-the-Scaled-Longitude-feature" data-toc-modified-id="find-outliers-for-the-Scaled-Longitude-feature-5.6.3"><span class="toc-item-num">5.6.3&nbsp;&nbsp;</span>find outliers for the Scaled Longitude feature</a></span></li><li><span><a href="#find-outliers-for-the-Vector-Magnitude-feature" data-toc-modified-id="find-outliers-for-the-Vector-Magnitude-feature-5.6.4"><span class="toc-item-num">5.6.4&nbsp;&nbsp;</span>find outliers for the Vector Magnitude feature</a></span></li></ul></li><li><span><a href="#Training-the-neural-net" data-toc-modified-id="Training-the-neural-net-5.7"><span class="toc-item-num">5.7&nbsp;&nbsp;</span>Training the neural net</a></span><ul class="toc-item"><li><span><a href="#Training-on-unfiltered-data" data-toc-modified-id="Training-on-unfiltered-data-5.7.1"><span class="toc-item-num">5.7.1&nbsp;&nbsp;</span>Training on unfiltered data</a></span><ul class="toc-item"><li><span><a href="#Generate-the-training-set" data-toc-modified-id="Generate-the-training-set-5.7.1.1"><span class="toc-item-num">5.7.1.1&nbsp;&nbsp;</span>Generate the training set</a></span></li><li><span><a href="#Create-and-train-the-neural-network-model" data-toc-modified-id="Create-and-train-the-neural-network-model-5.7.1.2"><span class="toc-item-num">5.7.1.2&nbsp;&nbsp;</span>Create and train the neural network model</a></span></li><li><span><a href="#Use-the-trained-model-to-make-prediction-for-N_STEPS_AHEAD-time-increments" data-toc-modified-id="Use-the-trained-model-to-make-prediction-for-N_STEPS_AHEAD-time-increments-5.7.1.3"><span class="toc-item-num">5.7.1.3&nbsp;&nbsp;</span>Use the trained model to make prediction for <em>N_STEPS_AHEAD</em> time increments</a></span></li></ul></li><li><span><a href="#Training-on-data-filtered-using-Gaussian-Mixtures" data-toc-modified-id="Training-on-data-filtered-using-Gaussian-Mixtures-5.7.2"><span class="toc-item-num">5.7.2&nbsp;&nbsp;</span>Training on data filtered using Gaussian Mixtures</a></span><ul class="toc-item"><li><span><a href="#Generate-the-training-set" data-toc-modified-id="Generate-the-training-set-5.7.2.1"><span class="toc-item-num">5.7.2.1&nbsp;&nbsp;</span>Generate the training set</a></span></li><li><span><a href="#Create-and-train-the-neural-network-model" data-toc-modified-id="Create-and-train-the-neural-network-model-5.7.2.2"><span class="toc-item-num">5.7.2.2&nbsp;&nbsp;</span>Create and train the neural network model</a></span></li><li><span><a href="#Use-the-trained-model-to-make-prediction-for-N_STEPS_AHEAD-time-increments" data-toc-modified-id="Use-the-trained-model-to-make-prediction-for-N_STEPS_AHEAD-time-increments-5.7.2.3"><span class="toc-item-num">5.7.2.3&nbsp;&nbsp;</span>Use the trained model to make prediction for <em>N_STEPS_AHEAD</em> time increments</a></span></li></ul></li><li><span><a href="#Training-on-data-filtered-using-K-Means" data-toc-modified-id="Training-on-data-filtered-using-K-Means-5.7.3"><span class="toc-item-num">5.7.3&nbsp;&nbsp;</span>Training on data filtered using K-Means</a></span><ul class="toc-item"><li><span><a href="#Generate-the-training-set" data-toc-modified-id="Generate-the-training-set-5.7.3.1"><span class="toc-item-num">5.7.3.1&nbsp;&nbsp;</span>Generate the training set</a></span></li><li><span><a href="#####-Create-and-train-the-neural-network-model" data-toc-modified-id="####-Create-and-train-the-neural-network-model-5.7.3.2"><span class="toc-item-num">5.7.3.2&nbsp;&nbsp;</span>#### Create and train the neural network model</a></span></li><li><span><a href="#Use-the-trained-model-to-make-prediction-for-N_STEPS_AHEAD-time-increments" data-toc-modified-id="Use-the-trained-model-to-make-prediction-for-N_STEPS_AHEAD-time-increments-5.7.3.3"><span class="toc-item-num">5.7.3.3&nbsp;&nbsp;</span>Use the trained model to make prediction for <em>N_STEPS_AHEAD</em> time increments</a></span></li></ul></li><li><span><a href="#Plots-of-unfiltered-data" data-toc-modified-id="Plots-of-unfiltered-data-5.7.4"><span class="toc-item-num">5.7.4&nbsp;&nbsp;</span>Plots of unfiltered data</a></span></li><li><span><a href="#Plots-of-Gaussian-Mixtures-cleaned-/-filtered-data" data-toc-modified-id="Plots-of-Gaussian-Mixtures-cleaned-/-filtered-data-5.7.5"><span class="toc-item-num">5.7.5&nbsp;&nbsp;</span>Plots of Gaussian Mixtures cleaned / filtered data</a></span></li><li><span><a href="#Plots-of-K-means-cleaned-/-filtered-data" data-toc-modified-id="Plots-of-K-means-cleaned-/-filtered-data-5.7.6"><span class="toc-item-num">5.7.6&nbsp;&nbsp;</span>Plots of K-means cleaned / filtered data</a></span></li></ul></li><li><span><a href="#Compare-the-accuracy-of-the-prediction-made-by-the-different-trained-models" data-toc-modified-id="Compare-the-accuracy-of-the-prediction-made-by-the-different-trained-models-5.8"><span class="toc-item-num">5.8&nbsp;&nbsp;</span>Compare the accuracy of the prediction made by the different trained models</a></span><ul class="toc-item"><li><span><a href="#The-MSE-of-the-unmodified-data" data-toc-modified-id="The-MSE-of-the-unmodified-data-5.8.1"><span class="toc-item-num">5.8.1&nbsp;&nbsp;</span>The MSE of the unmodified data</a></span></li><li><span><a href="#The-MSE-of-the-Gaussian-Mixtures-cleaned-data" data-toc-modified-id="The-MSE-of-the-Gaussian-Mixtures-cleaned-data-5.8.2"><span class="toc-item-num">5.8.2&nbsp;&nbsp;</span>The MSE of the Gaussian Mixtures cleaned data</a></span></li><li><span><a href="#The-MSE-of-the-K-Means-cleaned-data" data-toc-modified-id="The-MSE-of-the-K-Means-cleaned-data-5.8.3"><span class="toc-item-num">5.8.3&nbsp;&nbsp;</span>The MSE of the K-Means cleaned data</a></span></li><li><span><a href="#Percent-improvement-in-neural-network-predictions" data-toc-modified-id="Percent-improvement-in-neural-network-predictions-5.8.4"><span class="toc-item-num">5.8.4&nbsp;&nbsp;</span>Percent improvement in neural network predictions</a></span></li></ul></li></ul></li><li><span><a href="#References" data-toc-modified-id="References-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>References</a></span></li></ul></div></div>
<div class="section" id="purpose">
<h2><span class="section-number">12.4.2. </span>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>This notebook demonstrates a process by which GNSS data (lontitude, latitude, and height) obtained from the TZVOLCANO CHORDS portal (Stamps et al., 2016) can be analyzed with minimal human input to remove data points that are manifestations of high noise, instrumentation error, and other factors that introduce large errors into specific measurements. These prepared and cleaned data are then used to train a neural network that can be used for detecting volcanic activity.</p>
<p>This notebook takes advantage of the Earthcube funded CHORDS infrastructure (Daniels et al., 2016; Kerkez et al., 2016), which powers the TZVOLCANO CHORDS portal. GNSS positioning data (longitude, latitude, and height) are from the active Ol Doinyo Lengai volcano in Tanzania, which are made available through UNAVCO’s real-time GNSS data services. UNAVCO’s real-time GNSS data services provides real-time positions processed by the Trimble Pivot system. Real-time GNSS data from several instruments are streamed into the TZVOLCANO portal using brokering scripts developed by Joshua Robert Jones in Python and D. Sarah Stamps in awk, which makes them instantly available via the CHORDS data API service.</p>
</div>
<div class="section" id="technical-contributions">
<h2><span class="section-number">12.4.3. </span>Technical contributions<a class="headerlink" href="#technical-contributions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Created a python-based API client to download data from a CHORDS portal</p></li>
<li><p>Development of local libraries to download, manipulate, and plot GNSS data (longitude, latitude, and height) obtained from a CHORDS portal that obtains positions from UNAVCO’s real-time GNSS data services</p></li>
<li><p>Identification and removal of statistical outliers in GNSS time-series data using the Gaussian Mixtures Algorithm</p></li>
<li><p>Identification and removal of statistical outliers in GNSS time-series data using the K-means Algorithm</p></li>
<li><p>Implementation of a neural net model which, when trained on these data, can make predictions based on the historical time series</p></li>
</ul>
</div>
<div class="section" id="methodology">
<h2><span class="section-number">12.4.4. </span>Methodology<a class="headerlink" href="#methodology" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Select instrument and date range of positioning data (longitude, latitude, and height) to analyze</p></li>
<li><p>Download selected data set from TZVOLCANO CHORDS portal</p></li>
<li><p>Scale and impute data to prepare them for machine learning algorithms</p></li>
<li><p>Use a Gaussian Mixtures and then a K-means algorithm to identify and remove data points likely to have significant noise from each feature/variable</p></li>
<li><p>Train three Neural networks: one using the unfiltered data and two using the “cleaned” data output from the Gaussian mixtures and K-Means algorithm</p></li>
<li><p>Use predictions made by the these neural nets to make predictions (forecasts) of future data points</p></li>
<li><p>Compare these predictions to actual values from the unmodified data set to quantify the reduction in noise achieved by the filtering algorithm</p></li>
</ul>
</div>
<div class="section" id="results">
<h2><span class="section-number">12.4.5. </span>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>Compared to the neural net trained on the unfiltered data, filtered (or “cleaned”) data output Machine Learning Visualizations (Gaussian Mixtures and K-means) result in trained neural net models that do a significantly better job of generating predictions.</p>
</div>
<div class="section" id="funding">
<h2><span class="section-number">12.4.6. </span>Funding<a class="headerlink" href="#funding" title="Permalink to this headline">¶</a></h2>
<p>The development of this notebook was not directly supported by any awards, however the notebook leverages the EarthCube cyberinfrastructure CHORDS which was funded by the National Science Foundation.</p>
<ul class="simple">
<li><p>Award1 = {“agency”: “US National Science Foundation”, “award_code”: “1440133”, “award_URL”: “<a class="reference external" href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1440133&amp;HistoricalAwards=false">https://www.nsf.gov/awardsearch/showAward?AWD_ID=1440133&amp;HistoricalAwards=false</a>”}</p></li>
<li><p>Award2 = {“agency”: “US National Science Foundation”, “award_code”: “1639750”, “award_URL”: “<a class="reference external" href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1639750&amp;HistoricalAwards=false">https://www.nsf.gov/awardsearch/showAward?AWD_ID=1639750&amp;HistoricalAwards=false</a>”}</p></li>
<li><p>Award3 = {“agency”: “US National Science Foundation”, “award_code”: “1639554”, “award_URL”: “<a class="reference external" href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1639554&amp;HistoricalAwards=false">https://www.nsf.gov/awardsearch/showAward?AWD_ID=1639554&amp;HistoricalAwards=false</a>”}</p></li>
</ul>
</div>
<div class="section" id="keywords">
<h2><span class="section-number">12.4.7. </span>Keywords<a class="headerlink" href="#keywords" title="Permalink to this headline">¶</a></h2>
<p>keywords=[“TZVOLCANO”, “CHORDS”, “UNAVCO”, “Artificial Intelligence”, “Machine Learning”]</p>
</div>
<div class="section" id="citation">
<h2><span class="section-number">12.4.8. </span>Citation<a class="headerlink" href="#citation" title="Permalink to this headline">¶</a></h2>
<p>Dye, Mike, D. Sarah Stamps, Myles Mason (2021), Jupyter Notebook: Toward autonomous detection of anomalous GNSS data via applied unsupervised artificial intelligence, EarthCube Annual Meeting 2021</p>
</div>
<div class="section" id="suggested-next-steps">
<h2><span class="section-number">12.4.9. </span>Suggested next steps<a class="headerlink" href="#suggested-next-steps" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>A Support Vector Machine should be investigated as a possible filtering mechanism.</p></li>
<li><p>CHORDS API should be made more robust and flexible.</p></li>
<li><p>Predictions from the improved trained neural net model should be compared in real-time to incoming GNSS data to attempt to identify emerging volcanic events.</p></li>
<li><p>Test if filtering data with <em>both</em> the Gaussian Mixtures and K-means in combination would further improve the neural net predictions.</p></li>
<li><p>Use this same filtering process on time-series data from other CHORDS portals.</p></li>
<li><p>Update citation with doi</p></li>
<li><p>Investigate and compare the approach used in this notebook with benchmarks from classical time series filtering and prediction *</p></li>
</ul>
<p>* As suggested by anonymous reviewer</p>
</div>
<div class="section" id="acknowledgements">
<h2><span class="section-number">12.4.10. </span>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>CHORDS:
for providing a versatile and practical cyber-infrastructure component</p></li>
<li><p>Virginia Tech:
for enabling an incredibly supportive cutting edge learning and research environment</p></li>
<li><p>EarthCube &amp; Earthcube Office:
for creating the opportunity to create and share notebook and creating a well-designed Jupyter notebook template</p></li>
<li><p>Abbi Devins-Suresh:
for testing this notebook and invaluable feedback</p></li>
</ul>
</div>
<div class="section" id="license">
<h2><span class="section-number">12.4.11. </span>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>This notebook is licensed under the <span class="xref myst">MIT License</span>.</p>
</div>
<div class="section" id="glossary">
<h2><span class="section-number">12.4.12. </span>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h2>
<p>A brief definition of these terms is provided below for terms that may be unfamiliar to those without experience with machine learning, or are used in ways that may be unusual or ambiguous.</p>
<ul class="simple">
<li><p><strong>[Feature](<a class="reference external" href="https://en.wikipedia.org/wiki/Feature_(machine_learning)">https://en.wikipedia.org/wiki/Feature_(machine_learning)</a></strong>:
“a individual property or characteristic of a phenomenon being observed” (Wikipedia contributors, 2021). In this notebook, the imported fields (Time, Height, Longitude, and Latitude) are the initial features. One additional feature is calculated on the fly - the vector magnitude of scaled values of the original fields.</p></li>
<li><p><strong>Impute</strong>:
In machine learning, the replacement of null or missing values with an actual value in order to facilitate processing by an algorithm.</p></li>
<li><p><strong>Anomaly</strong>:
Data that for varying reasons do not occur within the usual ranges. In this notebook, there are (at least) two types of anomalies that may occur: those due to inaccurate measurements and subsequent processing, and those due to actual volcanic events.</p></li>
</ul>
</div>
</div>
<div class="section" id="setup">
<h1><span class="section-number">12.5. </span>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="library-import">
<h2><span class="section-number">12.5.1. </span>Library import<a class="headerlink" href="#library-import" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># System functionality</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Python ≥3.5 is required</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">assert</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data manipulation</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting and Visualizations</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data pipeline, scaling, normalizing, etc</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="c1"># MSE calculation</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Machine Learning Algorithms</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.mixture</span> <span class="kn">import</span> <span class="n">GaussianMixture</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Neural Network Support</span>

<span class="c1"># Scikit-Learn ≥0.20 is required</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="k">assert</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&gt;=</span> <span class="s2">&quot;0.20&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># %tensorflow_version only exists in Colab.</span>
    <span class="o">%</span><span class="k">tensorflow_version</span> 2.x
    <span class="n">IS_COLAB</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="n">IS_COLAB</span> <span class="o">=</span> <span class="kc">False</span>
    
<span class="c1"># TensorFlow ≥2.0 is required</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="k">assert</span> <span class="n">tf</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&gt;=</span> <span class="s2">&quot;2.0&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No GPU was detected. LSTMs and CNNs can be very slow without a GPU.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">IS_COLAB</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Go to Runtime &gt; Change runtime and select a GPU hardware accelerator.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No GPU was detected. LSTMs and CNNs can be very slow without a GPU.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Autoreload extension</span>
<span class="k">if</span> <span class="s1">&#39;autoreload&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">extension_manager</span><span class="o">.</span><span class="n">loaded</span><span class="p">:</span>
    <span class="o">%</span><span class="k">load_ext</span> autoreload
    
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to make this notebook&#39;s output stable across runs</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="local-library-import">
<h2><span class="section-number">12.5.2. </span>Local library import<a class="headerlink" href="#local-library-import" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#####</span>
<span class="c1"># Function definitions are included in this file to improve code readability </span>
<span class="c1"># </span>
<span class="c1"># Many of these functions are based on code from the excellent book</span>
<span class="c1"># Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow, 2nd Edition</span>
<span class="c1"># by Aurélien Géron</span>
<span class="c1">#####</span>

<span class="c1"># Include local library paths</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;./libraries&#39;</span><span class="p">)</span>

<span class="c1"># Import local libraries</span>

<span class="c1"># Misc. functions to support data analysis</span>
<span class="kn">from</span> <span class="nn">TZVOLCANO_utilities</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">TZVOLCANO_plotting</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">TZVOLCANO_gaussian_mixtures</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">TZVOLCANO_kmeans</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">TZVOLCANO_neural_net</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># CHORDS GUI interface (uses ChordsAPI.py)</span>
<span class="kn">from</span> <span class="nn">chords_gui</span> <span class="kn">import</span> <span class="n">chords_gui</span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="parameter-definitions">
<h1><span class="section-number">12.6. </span>Parameter definitions<a class="headerlink" href="#parameter-definitions" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the CHORDS GUI and load the API. DOMAIN is the URL of your CHORDS portal. </span>
<span class="n">DOMAIN</span> <span class="o">=</span> <span class="s1">&#39;tzvolcano.chordsrt.com&#39;</span>
<span class="n">CHORDS</span> <span class="o">=</span> <span class="n">chords_gui</span><span class="p">(</span><span class="n">DOMAIN</span><span class="p">)</span>

<span class="c1"># Define the initial start and end date for the date selector</span>
<span class="n">INITIAL_START_DATE</span> <span class="o">=</span> <span class="s1">&#39;2021-01-01&#39;</span>
<span class="n">INITIAL_END_DATE</span> <span class="o">=</span> <span class="s1">&#39;2021-01-01&#39;</span>


<span class="c1"># Min/max values used to scale the height, lon, and lat</span>
<span class="c1"># This should be either -1, 1 or 0, 1</span>
<span class="n">SCALE_MINIMUM</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">SCALE_MAXIMUM</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1">#####</span>
<span class="c1"># Define important parameters that control the neural net functionality.</span>
<span class="c1">#####</span>
<span class="n">N_STEPS_TRAINING</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="mi">1000</span>      <span class="c1"># The number of data points to use in the training set</span>
<span class="n">N_STEPS_FORECAST</span> <span class="o">=</span> <span class="mi">500</span>           <span class="c1"># The number of data points to display in the predictions graph</span>
<span class="n">N_STEPS_AHEAD</span> <span class="o">=</span> <span class="mi">100</span>              <span class="c1"># the number of steps ahead that the neural net will predict</span>


<span class="c1"># Gaussian Mixtures Parameters</span>
<span class="n">N_COMPONENTS</span> <span class="o">=</span> <span class="mi">1</span>                 <span class="c1"># The number of regions to generate - needs to be 1 for this use case</span>
<span class="n">N_INIT</span> <span class="o">=</span> <span class="mi">10</span>                      
<span class="n">COVARIANCE_TYPE</span> <span class="o">=</span> <span class="s2">&quot;tied&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="data-import">
<h1><span class="section-number">12.7. </span>Data import<a class="headerlink" href="#data-import" title="Permalink to this headline">¶</a></h1>
<p>Data for this notebook is stored in the <a class="reference external" href="http://tzvolcano.chordsrt.com/">TZVOLCANO CHORDS portal</a>. In order to run the notebook, users will need to select a date range, an instrument identifier, and click the “Download File” button. The designated data file is then downloaded to the local server and can be selected for use.</p>
<p>The data is CSV format and is downloaded using the CHORDS API.</p>
<p>Each row of data includes a time, latitude, longitude, and height of instruments deployed on the Ol Doinyo Lengai volcano for the TZVOLCANO initiative. Below is a map of the instrument IDs to the TZVOLCANO designators:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Instrument</span> <span class="n">ID</span>    <span class="n">Instrument</span> <span class="n">Name</span>    <span class="n">Notes</span>
<span class="mi">1</span>                <span class="n">OLO1</span>               <span class="n">Live</span> <span class="n">instrument</span>
<span class="mi">2</span>                <span class="n">OLO3</span>               <span class="n">Live</span> <span class="n">instrument</span>
<span class="mi">4</span>                <span class="n">OLOT</span>               <span class="n">Test</span> <span class="n">instrument</span> <span class="k">with</span> <span class="n">data</span> <span class="kn">from</span> <span class="nn">station</span> <span class="n">BILL_RTX</span>
<span class="mi">5</span>                <span class="n">OLO6</span>               <span class="n">Live</span> <span class="n">instrument</span>
<span class="mi">6</span>                <span class="n">OLO7</span>               <span class="n">Live</span> <span class="n">instrument</span>
<span class="mi">7</span>                <span class="n">OLO8</span>               <span class="n">Live</span> <span class="n">instrument</span>
<span class="mi">8</span>                <span class="n">OLOJ</span>               <span class="n">Test</span> <span class="n">instrument</span> 
<span class="mi">9</span>                <span class="n">OLON</span>               <span class="n">Test</span> <span class="n">instrument</span>
</pre></div>
</div>
<p>The default for the notebook is to use OLO1 (instrument id 1). OLOT (instrument id 4) is a test site that contains data from station BILL_RTX. Data from other instruments may not be available for the default time window.</p>
<p>The default start and end dates are both set to January 1, 2021.</p>
<div class="section" id="important-note-on-imported-data">
<h2><span class="section-number">12.7.1. </span>Important note on imported data<a class="headerlink" href="#important-note-on-imported-data" title="Permalink to this headline">¶</a></h2>
<p>The entire date range is analyzed using the K-Means and the Gaussian Mixtures clustering identification algorithms.</p>
<p>The large number of data points (millions of points) would, however, slow the training of the neural networks to an unusable pace when running on a server without GPU support (such as the servers used by mybinder).</p>
<p>The <strong>N_STEPS_TRAINING</strong> parameter limits the number of data points fed to the neural network. 5,000 - 10,000 points seems to provide enough training data to make passable predictions and is still a small enough data set that training the net takes a reasonable amount of time (several minutes).</p>
</div>
<div class="section" id="select-the-instrument-id-and-the-start-and-end-date-of-the-data-to-be-processed-and-analyzed">
<h2><span class="section-number">12.7.2. </span>Select the instrument ID and the start and end date of the data to be processed and analyzed<a class="headerlink" href="#select-the-instrument-id-and-the-start-and-end-date-of-the-data-to-be-processed-and-analyzed" title="Permalink to this headline">¶</a></h2>
<p style="text-align: center; color: red; font-weight: bold; font-size: 14pt;"> The cell below must be run in order to display the CHORDS GUI! </p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CHORDS</span><span class="o">.</span><span class="n">start_end_widgets</span><span class="p">(</span><span class="n">INITIAL_START_DATE</span><span class="p">,</span> <span class="n">INITIAL_END_DATE</span><span class="p">)</span>

<span class="c1"># Make sure that at least the default data file has been downloaded</span>
<span class="n">number_of_data_files_found</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CHORDS</span><span class="o">.</span><span class="n">get_availiable_files</span><span class="p">())</span>
<span class="k">if</span> <span class="p">(</span><span class="n">number_of_data_files_found</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">CHORDS</span><span class="o">.</span><span class="n">download_csv_file</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ed31d2ed6e7042dfbabc59042b2e9c8d", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6ca5e8951cc54f49bc5b2113c29de090", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "121dca9f33544ed3bfa092511337d223", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "60dc62c9fafc492c86bd17c85c1764d7", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a40304c5fc884b08b78c9c09fe0c54fa", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="select-data-file-for-use-during-analysis">
<h2><span class="section-number">12.7.3. </span>Select data file for use during analysis<a class="headerlink" href="#select-data-file-for-use-during-analysis" title="Permalink to this headline">¶</a></h2>
<p>Choose which of the downloaded CSV files to use for analysis.</p>
<p>These files are retained on the server running the notebook indefinitely.</p>
<p><strong>Note that on shared servers (such as <a class="reference external" href="http://mybinder.org">mybinder.org</a>) very large files may not work properly if they consume all available disk space and or memory</strong></p>
<p style="text-align: center; color: red; font-weight: bold; font-size: 14pt;"> The cell below must be run in order to display the data file selection widget! </p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CHORDS</span><span class="o">.</span><span class="n">select_data_file</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Available Data Files
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "10de1d8af957494db4a5a7dfba3f3a36", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a40304c5fc884b08b78c9c09fe0c54fa", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="read-contents-of-the-selected-file-in-to-a-pandas-object">
<h2><span class="section-number">12.7.4. </span>Read contents of the selected file in to a pandas object<a class="headerlink" href="#read-contents-of-the-selected-file-in-to-a-pandas-object" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">CHORDS</span><span class="o">.</span><span class="n">available_data_files</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no files were found&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span> <span class="o">=</span> <span class="n">CHORDS</span><span class="o">.</span><span class="n">available_data_files</span><span class="o">.</span><span class="n">value</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Imported csv data from&quot;</span> <span class="o">+</span> <span class="n">file_name</span><span class="p">)</span>

<span class="n">unmodified_data</span> <span class="o">=</span> <span class="n">CHORDS</span><span class="o">.</span><span class="n">load_data_from_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imported csv data fromtzvolcano_chordsrt_com_instrument_id_1_2021-01-01_to_2021-01-01.csv
csv_files/tzvolcano_chordsrt_com_instrument_id_1_2021-01-01_to_2021-01-01.csv
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="data-processing-and-analysis">
<h1><span class="section-number">12.8. </span>Data processing and analysis<a class="headerlink" href="#data-processing-and-analysis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="resample-the-data-to-fill-in-holes-in-the-time-series">
<h2><span class="section-number">12.8.1. </span>Resample the data to fill in holes in the time series<a class="headerlink" href="#resample-the-data-to-fill-in-holes-in-the-time-series" title="Permalink to this headline">¶</a></h2>
<div class="section" id="make-a-copy-of-the-unmodified-data">
<h3><span class="section-number">12.8.1.1. </span>Make a copy of the unmodified data<a class="headerlink" href="#make-a-copy-of-the-unmodified-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill in missing points in the time series</span>
<span class="n">resampled_data</span> <span class="o">=</span> <span class="n">unmodified_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Set the &#39;Time&#39; field to be used as the index</span>
<span class="n">resampled_data</span> <span class="o">=</span> <span class="n">resampled_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="c1"># Re-insert the &#39;Time&#39; field, as changing it to be the index removes is as a referenceable field in the pandas object</span>
<span class="n">resampled_data</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resampled_data</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="alternative-method-make-a-copy-of-unmodified-data-and-resample-the-time-series-to-fill-in-any-missing-time-values-in-the-series">
<h3><span class="section-number">12.8.1.2. </span>Alternative method: Make a copy of unmodified data <strong>and</strong> resample the time series to fill in any missing time values in the series<a class="headerlink" href="#alternative-method-make-a-copy-of-unmodified-data-and-resample-the-time-series-to-fill-in-any-missing-time-values-in-the-series" title="Permalink to this headline">¶</a></h3>
<p>The standard approach for anomaly detection recommends imputing missing data points in a time-series. However, in this case the imputing approach was found to reduce the final accuracy of the predictions made by the neural network. The code below is commented out and is not executed. It was retained as documentation in case the imputing approach is helpful for other applications of this overall methodology.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a copy of the unmodified data</span>
<span class="c1"># resampled_data = unmodified_data.copy()</span>

<span class="c1"># Fill in missing points in the time-series, inserting any times missing from the series using NaN as the value</span>
<span class="c1"># resampled_data = resampled_data.set_index(&#39;Time&#39;).sort_index().resample(&#39;1000ms&#39;).ffill()</span>

<span class="c1"># Re-insert the &#39;Time&#39; field, as the resampling process changed it to be the index</span>
<span class="c1"># resampled_data[&#39;Time&#39;] = resampled_data.index</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="rescale-the-features">
<h2><span class="section-number">12.8.2. </span>Rescale the Features<a class="headerlink" href="#rescale-the-features" title="Permalink to this headline">¶</a></h2>
<p>Many clustering algorithms are highly sensitive to min-max ranges - including both the K-means and Gaussian mixtures algorithms. Here a best practice is followed, and before running the clustering algorithms, the data are rescaled.</p>
<p>Details of the scaling procedure can be found by examining the <strong>scale_np_data</strong> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rescale Height, Longitude and Latitude to the range between SCALE_MINIMUM and SCALE_MAXIMUM</span>
<span class="n">scaled_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># Convert the Time variable to Seconds Since Epoch</span>
<span class="n">scaled_data</span><span class="p">[</span><span class="s2">&quot;Seconds Since Epoch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resampled_data</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="c1"># scaled_data[&quot;Time&quot;] = resampled_data[&#39;Time&#39;]</span>

<span class="n">scaled_data</span><span class="p">[</span><span class="s2">&quot;Scaled Height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scale_np_data</span><span class="p">(</span><span class="n">resampled_data</span><span class="p">[</span><span class="s2">&quot;Height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">SCALE_MINIMUM</span><span class="p">,</span> <span class="n">SCALE_MAXIMUM</span><span class="p">)</span>
<span class="n">scaled_data</span><span class="p">[</span><span class="s2">&quot;Scaled Latitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scale_np_data</span><span class="p">(</span><span class="n">resampled_data</span><span class="p">[</span><span class="s2">&quot;Latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">SCALE_MINIMUM</span><span class="p">,</span> <span class="n">SCALE_MAXIMUM</span><span class="p">)</span>
<span class="n">scaled_data</span><span class="p">[</span><span class="s2">&quot;Scaled Longitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scale_np_data</span><span class="p">(</span><span class="n">resampled_data</span><span class="p">[</span><span class="s2">&quot;Longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">SCALE_MINIMUM</span><span class="p">,</span> <span class="n">SCALE_MAXIMUM</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-the-vector-magnitude">
<h2><span class="section-number">12.8.3. </span>Calculate the Vector Magnitude<a class="headerlink" href="#calculate-the-vector-magnitude" title="Permalink to this headline">¶</a></h2>
<p>Treating the individual fields as a vector, calculate the vector magnitude value as a derived feature.</p>
<p>Creating an derived feature (variable) is a common technique in machine learning. It often makes it possible to more easily detect patterns in correlated features. In this case, it makes it easier to identify regions of localized high-noise areas within the time series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fields_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Scaled Height&#39;</span><span class="p">,</span> <span class="s1">&#39;Scaled Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Scaled Longitude&#39;</span><span class="p">]</span>

<span class="n">scaled_data</span><span class="p">[</span><span class="s2">&quot;Vector Magnitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_vector_magnitude</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">fields_list</span><span class="p">,</span> <span class="n">SCALE_MINIMUM</span><span class="p">,</span> <span class="n">SCALE_MAXIMUM</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-the-features">
<h2><span class="section-number">12.8.4. </span>Plot the Features<a class="headerlink" href="#plot-the-features" title="Permalink to this headline">¶</a></h2>
<p>Note the “Vector Magnitude” feature in green. It’s wide range of values makes it easier for the algorithms to identify outliers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span> <span class="c1"># get current axis</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span>

<span class="n">scaled_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Seconds Since Epoch&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Scaled Height&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">scaled_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Seconds Since Epoch&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Scaled Latitude&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">scaled_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Seconds Since Epoch&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Scaled Longitude&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">scaled_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Seconds Since Epoch&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Vector Magnitude&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_49_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_49_0.png" />
</div>
</div>
<p>Note in the plot above, the Vector Magnitude feature in green. The wide range of values should make it easier for the clustering algorithms to identify areas of high noise within the signal.</p>
</div>
<div class="section" id="identify-outliers-for-each-feature-with-the-gaussian-mixtures-algorithm">
<h2><span class="section-number">12.8.5. </span>Identify outliers for each feature with the Gaussian Mixtures algorithm<a class="headerlink" href="#identify-outliers-for-each-feature-with-the-gaussian-mixtures-algorithm" title="Permalink to this headline">¶</a></h2>
<p>In order to save space and make the code more readable, several steps in this process have been abstracted out to functions in an external library.</p>
<p>For each feature, the same processing and analysis is applied:</p>
<ul class="simple">
<li><p>Designate which feature the is being used</p></li>
<li><p>Designate a <strong>density threshold percent</strong> that determines the percentage of data point that will be classified as being outliers</p></li>
<li><p>Perform transformations which scale and impute the data (see note) for the designated feature</p></li>
<li><p>Train a Gaussian Mixtures model with the imputed data</p></li>
<li><p>Generate a plot showing which points are flagged for removal</p></li>
</ul>
<p>A manual part of this process is performed at this point: Determining what value of the density threshold percent yields the best results. The values that appear in this code were arrived at by executing this process, looking at the generated plot, adjusting the  density threshold percent, and then re-running this section of the code. This was performed until the plot indicates that outliers are identified, and that points that should be retained are not flagged for removal.</p>
<p>Note: Imputing the data fills in missing values with the most frequently occurring value for that variable. This is necessary as the algorithm cannot function with missing values for times in the series.</p>
<div class="section" id="find-outliers-for-the-scaled-height-feature">
<h3><span class="section-number">12.8.5.1. </span>Find outliers for the Scaled Height feature<a class="headerlink" href="#find-outliers-for-the-scaled-height-feature" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_name</span> <span class="o">=</span> <span class="s1">&#39;Scaled Height&#39;</span>
<span class="n">scaled_height_density_threshold_percent</span> <span class="o">=</span> <span class="mf">5.2</span>

<span class="n">scaled_height_data_imputed</span> <span class="o">=</span> <span class="n">transform_data_for_gaussian_mixtures</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>

<span class="n">scaled_height_gm</span><span class="p">,</span> <span class="n">scaled_height_anomalies</span> <span class="o">=</span> <span class="n">get_anomalies_using_gaussian_mixtures</span><span class="p">(</span><span class="n">scaled_height_data_imputed</span><span class="p">,</span> <span class="n">scaled_height_density_threshold_percent</span><span class="p">)</span>

<span class="n">plot_gaussian_mixture_anomalies</span><span class="p">(</span><span class="n">scaled_height_gm</span><span class="p">,</span> <span class="n">scaled_height_data_imputed</span><span class="p">,</span> <span class="n">scaled_height_anomalies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./libraries/TZVOLCANO_plotting.py:103: UserWarning: No contour levels were found within the data range.
  linewidths=2, colors=&#39;r&#39;, linestyles=&#39;dashed&#39;)
</pre></div>
</div>
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_53_1.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_53_1.png" />
</div>
</div>
<p>The red highlights in the plot above indicate the data points identified as being outside of the assigned density threshold. These are the points that will be removed in the data filtering and cleaning process.</p>
</div>
<div class="section" id="find-outliers-for-the-scaled-latitude-feature">
<h3><span class="section-number">12.8.5.2. </span>Find outliers for the Scaled Latitude feature<a class="headerlink" href="#find-outliers-for-the-scaled-latitude-feature" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_name</span> <span class="o">=</span> <span class="s1">&#39;Scaled Latitude&#39;</span>
<span class="n">scaled_latitude_density_threshold_percent</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">scaled_latitude_data_imputed</span> <span class="o">=</span> <span class="n">transform_data_for_gaussian_mixtures</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>

<span class="n">scaled_latitude_gm</span><span class="p">,</span> <span class="n">scaled_latitude_anomalies</span> <span class="o">=</span> <span class="n">get_anomalies_using_gaussian_mixtures</span><span class="p">(</span><span class="n">scaled_latitude_data_imputed</span><span class="p">,</span> <span class="n">scaled_latitude_density_threshold_percent</span><span class="p">)</span>

<span class="n">plot_gaussian_mixture_anomalies</span><span class="p">(</span><span class="n">scaled_latitude_gm</span><span class="p">,</span> <span class="n">scaled_latitude_data_imputed</span><span class="p">,</span> <span class="n">scaled_latitude_anomalies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./libraries/TZVOLCANO_plotting.py:103: UserWarning: No contour levels were found within the data range.
  linewidths=2, colors=&#39;r&#39;, linestyles=&#39;dashed&#39;)
</pre></div>
</div>
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_56_1.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_56_1.png" />
</div>
</div>
</div>
<div class="section" id="find-outliers-for-the-scaled-longitude-feature">
<h3><span class="section-number">12.8.5.3. </span>Find outliers for the Scaled Longitude feature<a class="headerlink" href="#find-outliers-for-the-scaled-longitude-feature" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_name</span> <span class="o">=</span> <span class="s1">&#39;Scaled Longitude&#39;</span>
<span class="n">scaled_longitude_density_threshold_percent</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">scaled_longitude_data_imputed</span> <span class="o">=</span> <span class="n">transform_data_for_gaussian_mixtures</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>

<span class="n">scaled_longitude_gm</span><span class="p">,</span> <span class="n">scaled_longitude_anomalies</span> <span class="o">=</span> <span class="n">get_anomalies_using_gaussian_mixtures</span><span class="p">(</span><span class="n">scaled_longitude_data_imputed</span><span class="p">,</span> <span class="n">scaled_longitude_density_threshold_percent</span><span class="p">)</span>

<span class="n">plot_gaussian_mixture_anomalies</span><span class="p">(</span><span class="n">scaled_longitude_gm</span><span class="p">,</span> <span class="n">scaled_longitude_data_imputed</span><span class="p">,</span> <span class="n">scaled_longitude_anomalies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./libraries/TZVOLCANO_plotting.py:103: UserWarning: No contour levels were found within the data range.
  linewidths=2, colors=&#39;r&#39;, linestyles=&#39;dashed&#39;)
</pre></div>
</div>
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_58_1.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_58_1.png" />
</div>
</div>
</div>
<div class="section" id="find-outliers-for-the-vector-magnitude-feature">
<h3><span class="section-number">12.8.5.4. </span>Find outliers for the Vector Magnitude feature<a class="headerlink" href="#find-outliers-for-the-vector-magnitude-feature" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_name</span> <span class="o">=</span> <span class="s1">&#39;Vector Magnitude&#39;</span>
<span class="n">vector_magnitude_density_threshold_percent</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">vector_magnitude_data_imputed</span> <span class="o">=</span> <span class="n">transform_data_for_gaussian_mixtures</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>

<span class="n">vector_magnitude_gm</span><span class="p">,</span> <span class="n">vector_magnitude_anomalies</span> <span class="o">=</span> <span class="n">get_anomalies_using_gaussian_mixtures</span><span class="p">(</span><span class="n">vector_magnitude_data_imputed</span><span class="p">,</span> <span class="n">vector_magnitude_density_threshold_percent</span><span class="p">)</span>

<span class="n">plot_gaussian_mixture_anomalies</span><span class="p">(</span><span class="n">vector_magnitude_gm</span><span class="p">,</span> <span class="n">vector_magnitude_data_imputed</span><span class="p">,</span> <span class="n">vector_magnitude_anomalies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./libraries/TZVOLCANO_plotting.py:103: UserWarning: No contour levels were found within the data range.
  linewidths=2, colors=&#39;r&#39;, linestyles=&#39;dashed&#39;)
</pre></div>
</div>
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_60_1.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_60_1.png" />
</div>
</div>
</div>
<div class="section" id="consolidate-the-arrays-of-times-to-remove-in-to-one-object">
<h3><span class="section-number">12.8.5.5. </span>Consolidate the arrays of times to remove in to one object<a class="headerlink" href="#consolidate-the-arrays-of-times-to-remove-in-to-one-object" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert the list of anomalies to datetime data type so they can be used to filter the scaled data set</span>
<span class="n">scaled_height_times_to_remove</span>    <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">scaled_height_anomalies</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">scaled_longitude_times_to_remove</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">scaled_longitude_anomalies</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">scaled_latitude_times_to_remove</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">scaled_latitude_anomalies</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vector_magnitude_times_to_remove</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">vector_magnitude_anomalies</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;ns&#39;</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># Consolidate the arrays of times to remove in to one object</span>
<span class="n">times_to_remove</span> <span class="o">=</span> <span class="n">scaled_height_times_to_remove</span>
<span class="n">times_to_remove</span> <span class="o">=</span> <span class="n">times_to_remove</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">scaled_longitude_times_to_remove</span><span class="p">)</span>
<span class="n">times_to_remove</span> <span class="o">=</span> <span class="n">times_to_remove</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">scaled_latitude_times_to_remove</span><span class="p">)</span>
<span class="n">times_to_remove</span> <span class="o">=</span> <span class="n">times_to_remove</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">vector_magnitude_times_to_remove</span><span class="p">)</span>
<span class="n">times_to_remove</span> <span class="o">=</span> <span class="n">times_to_remove</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-a-new-pandas-object-with-the-points-identified-by-the-algorithm-removed">
<h3><span class="section-number">12.8.5.6. </span>Create a new pandas object with the points identified by the algorithm removed<a class="headerlink" href="#create-a-new-pandas-object-with-the-points-identified-by-the-algorithm-removed" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove the flagged times from the scaled data set </span>
<span class="n">g_m_cleaned_data</span> <span class="o">=</span> <span class="n">scaled_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">g_m_cleaned_data</span> <span class="o">=</span> <span class="n">g_m_cleaned_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">times_to_remove</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-the-cleaned-data-on-top-of-the-original-data">
<h3><span class="section-number">12.8.5.7. </span>Plot the “cleaned” data on top of the original data<a class="headerlink" href="#plot-the-cleaned-data-on-top-of-the-original-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># get current axis</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.99</span>


<span class="n">scaled_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Seconds Since Epoch&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Vector Magnitude&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">g_m_cleaned_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Seconds Since Epoch&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Vector Magnitude&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Vector Magnitude (Unfiltered) &quot;</span><span class="p">,</span> <span class="s2">&quot;Vector Magnitude (Filtered using Gaussian Mixtures)&quot;</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_66_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_66_0.png" />
</div>
</div>
<p>The plot above shows that the value ranges of the filtered data is much less than seen in the unmodified data. This is a good indicator that training a machine learning algorithm (such as a neural net) should result in a trained algorithm that produces more accurate predictions than if it were to be trained using the unfiltered data.</p>
</div>
</div>
<div class="section" id="identify-anomalies-for-each-feature-using-the-k-means-algorithm">
<h2><span class="section-number">12.8.6. </span>Identify anomalies for each feature using the K-means algorithm<a class="headerlink" href="#identify-anomalies-for-each-feature-using-the-k-means-algorithm" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3><span class="section-number">12.8.6.1. </span>find outliers for the Scaled Height feature<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_to_analyze</span> <span class="o">=</span> <span class="s1">&#39;Scaled Height&#39;</span>
<span class="n">number_of_clusters</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Impute the data </span>
<span class="n">scaled_height_kmeans_data_imputed</span> <span class="o">=</span> <span class="n">transform_data_for_kmeans</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">field_to_analyze</span><span class="p">)</span>

<span class="c1"># Train the K-means model</span>
<span class="n">scaled_height_kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">number_of_clusters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">scaled_height_cluster_labels</span> <span class="o">=</span> <span class="n">scaled_height_kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">scaled_height_kmeans_data_imputed</span><span class="p">)</span>

<span class="c1"># Plot the decision boundaries</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plot_decision_boundaries</span><span class="p">(</span><span class="n">scaled_height_kmeans</span><span class="p">,</span> <span class="n">scaled_height_kmeans_data_imputed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_70_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_70_0.png" />
</div>
</div>
<p>The plot above shows the regions generated by the K-means algorithm. The numbers indicate the index of the associated region.</p>
<p>Some of the regions for this particular K-means plot is a bit messy, yet it can still be used to identify regions in the data that likely contain high noise and should be removed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Based on the labeled regions from the decision boundary plot, decide which regions should be retained</span>
<span class="n">scaled_height_regions_to_retain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3><span class="section-number">12.8.6.2. </span>find outliers for the Scaled Latitude feature<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a K-means cluster </span>
<span class="n">field_to_analyze</span> <span class="o">=</span> <span class="s1">&#39;Scaled Latitude&#39;</span>
<span class="n">number_of_clusters</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Impute and scale the data </span>
<span class="n">scaled_latitude_kmeans_imputed_data</span> <span class="o">=</span> <span class="n">transform_data_for_kmeans</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">field_to_analyze</span><span class="p">)</span>

<span class="c1"># Train the K-means model</span>
<span class="n">scaled_latitude_kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">number_of_clusters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">scaled_latitude_cluster_labels</span> <span class="o">=</span> <span class="n">scaled_latitude_kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">scaled_latitude_kmeans_imputed_data</span><span class="p">)</span>

<span class="c1"># Plot the decision boundaries</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plot_decision_boundaries</span><span class="p">(</span><span class="n">scaled_latitude_kmeans</span><span class="p">,</span> <span class="n">scaled_latitude_kmeans_imputed_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_74_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_74_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Based on the labeled regions from the decision boundary plot, decide which regions should be retained</span>
<span class="n">scaled_latitude_regions_to_retain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3><span class="section-number">12.8.6.3. </span>find outliers for the Scaled Longitude feature<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_to_analyze</span> <span class="o">=</span> <span class="s1">&#39;Scaled Longitude&#39;</span>
<span class="n">number_of_clusters</span> <span class="o">=</span> <span class="mi">5</span>


<span class="c1"># Impute the data </span>
<span class="n">scaled_longitude_kmeans_data_imputed</span> <span class="o">=</span> <span class="n">transform_data_for_kmeans</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">field_to_analyze</span><span class="p">)</span>

<span class="c1"># Train the K-means model</span>
<span class="n">scaled_longitude_kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">number_of_clusters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">41</span><span class="p">)</span>

<span class="n">scaled_longitude_cluster_labels</span> <span class="o">=</span> <span class="n">scaled_longitude_kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">scaled_longitude_kmeans_data_imputed</span><span class="p">)</span>

<span class="c1"># Plot the decision boundaries</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plot_decision_boundaries</span><span class="p">(</span><span class="n">scaled_longitude_kmeans</span><span class="p">,</span> <span class="n">scaled_longitude_kmeans_data_imputed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_77_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_77_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Based on the labeled regions from the decision boundary plot, decide which regions should be retained</span>
<span class="n">scaled_longitude_regions_to_retain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3><span class="section-number">12.8.6.4. </span>find outliers for the Vector Magnitude feature<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_to_analyze</span> <span class="o">=</span> <span class="s1">&#39;Vector Magnitude&#39;</span>
<span class="n">number_of_clusters</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Impute the data </span>
<span class="n">vector_magnitude_kmeans_data_imputed</span> <span class="o">=</span> <span class="n">transform_data_for_kmeans</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">field_to_analyze</span><span class="p">)</span>

<span class="c1"># Train the K-means model</span>
<span class="n">vector_magnitude_kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">number_of_clusters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">vector_magnitude_cluster_labels</span> <span class="o">=</span> <span class="n">vector_magnitude_kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">vector_magnitude_kmeans_data_imputed</span><span class="p">)</span>

<span class="c1"># Plot the decision boundaries</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plot_decision_boundaries</span><span class="p">(</span><span class="n">vector_magnitude_kmeans</span><span class="p">,</span> <span class="n">vector_magnitude_kmeans_data_imputed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_80_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_80_0.png" />
</div>
</div>
<p>K-means did a nice job of locating the lower-noise signal for the derived Vector Magnitude feature - significantly better than for any of the individual un-combined features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Based on the labeled regions from the decision boundary plot, decide which regions should be retained</span>
<span class="n">vector_magnitude_regions_to_retain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a copy of the unfiltered scaled data object and selectively remove points</span>

<span class="n">cleaned_kmeans_data</span> <span class="o">=</span> <span class="n">scaled_data</span>

<span class="c1"># Create a new column in the pandas object for the cluster labels for each dimension</span>
<span class="n">cleaned_kmeans_data</span><span class="p">[</span><span class="s1">&#39;scaled_height_kmeans&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaled_height_cluster_labels</span>
<span class="n">cleaned_kmeans_data</span><span class="p">[</span><span class="s1">&#39;scaled_longitude_kmeans&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaled_longitude_cluster_labels</span>
<span class="n">cleaned_kmeans_data</span><span class="p">[</span><span class="s1">&#39;scaled_latitude_kmeans&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaled_latitude_cluster_labels</span>
<span class="n">cleaned_kmeans_data</span><span class="p">[</span><span class="s1">&#39;vector_magnitude_kmeans&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vector_magnitude_cluster_labels</span>

<span class="c1"># For each dimension, keep only the designated rows</span>
<span class="n">cleaned_kmeans_data</span> <span class="o">=</span> <span class="n">cleaned_kmeans_data</span><span class="p">[</span><span class="n">cleaned_kmeans_data</span><span class="o">.</span><span class="n">scaled_height_kmeans</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">scaled_height_regions_to_retain</span><span class="p">)]</span>
<span class="n">cleaned_kmeans_data</span> <span class="o">=</span> <span class="n">cleaned_kmeans_data</span><span class="p">[</span><span class="n">cleaned_kmeans_data</span><span class="o">.</span><span class="n">scaled_longitude_kmeans</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">scaled_longitude_regions_to_retain</span><span class="p">)]</span>
<span class="n">cleaned_kmeans_data</span> <span class="o">=</span> <span class="n">cleaned_kmeans_data</span><span class="p">[</span><span class="n">cleaned_kmeans_data</span><span class="o">.</span><span class="n">scaled_latitude_kmeans</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">scaled_latitude_regions_to_retain</span><span class="p">)]</span>
<span class="n">cleaned_kmeans_data</span> <span class="o">=</span> <span class="n">cleaned_kmeans_data</span><span class="p">[</span><span class="n">cleaned_kmeans_data</span><span class="o">.</span><span class="n">vector_magnitude_kmeans</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">vector_magnitude_regions_to_retain</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="training-the-neural-net">
<h2><span class="section-number">12.8.7. </span>Training the neural net<a class="headerlink" href="#training-the-neural-net" title="Permalink to this headline">¶</a></h2>
<div class="section" id="training-on-unfiltered-data">
<h3><span class="section-number">12.8.7.1. </span>Training on unfiltered data<a class="headerlink" href="#training-on-unfiltered-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="generate-the-training-set">
<h4><span class="section-number">12.8.7.1.1. </span>Generate the training set<a class="headerlink" href="#generate-the-training-set" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the data in the proper format to train the Neural network</span>

<span class="n">unfiltered_training_data</span><span class="p">,</span> <span class="n">unfiltered_training_labels</span> <span class="o">=</span> <span class="n">get_neural_net_training_sets</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="s1">&#39;Scaled Height&#39;</span><span class="p">,</span> <span class="n">N_STEPS_TRAINING</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-and-train-the-neural-network-model">
<h4><span class="section-number">12.8.7.1.2. </span>Create and train the neural network model<a class="headerlink" href="#create-and-train-the-neural-network-model" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">get_neural_net_model</span><span class="p">(</span><span class="n">N_STEPS_AHEAD</span><span class="p">)</span>

<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">unfiltered_training_data</span><span class="p">,</span> <span class="n">unfiltered_training_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/20
1/1 [==============================] - 4s 4s/step - loss: 0.2224 - last_time_step_mse: 0.2233
Epoch 2/20
1/1 [==============================] - 2s 2s/step - loss: 0.1985 - last_time_step_mse: 0.1986
Epoch 3/20
1/1 [==============================] - 2s 2s/step - loss: 0.1596 - last_time_step_mse: 0.1552
Epoch 4/20
1/1 [==============================] - 2s 2s/step - loss: 0.1034 - last_time_step_mse: 0.0994
Epoch 5/20
1/1 [==============================] - 2s 2s/step - loss: 0.0780 - last_time_step_mse: 0.0902
Epoch 6/20
1/1 [==============================] - 2s 2s/step - loss: 0.0599 - last_time_step_mse: 0.0714
Epoch 7/20
1/1 [==============================] - 2s 2s/step - loss: 0.0318 - last_time_step_mse: 0.0311
Epoch 8/20
1/1 [==============================] - 2s 2s/step - loss: 0.0174 - last_time_step_mse: 0.0173
Epoch 9/20
1/1 [==============================] - 2s 2s/step - loss: 0.0143 - last_time_step_mse: 0.0110
Epoch 10/20
1/1 [==============================] - 2s 2s/step - loss: 0.0120 - last_time_step_mse: 0.0097
Epoch 11/20
1/1 [==============================] - 2s 2s/step - loss: 0.0097 - last_time_step_mse: 0.0089
Epoch 12/20
1/1 [==============================] - 2s 2s/step - loss: 0.0097 - last_time_step_mse: 0.0088
Epoch 13/20
1/1 [==============================] - 2s 2s/step - loss: 0.0110 - last_time_step_mse: 0.0118
Epoch 14/20
1/1 [==============================] - 2s 2s/step - loss: 0.0103 - last_time_step_mse: 0.0133
Epoch 15/20
1/1 [==============================] - 2s 2s/step - loss: 0.0083 - last_time_step_mse: 0.0105
Epoch 16/20
1/1 [==============================] - 2s 2s/step - loss: 0.0072 - last_time_step_mse: 0.0066
Epoch 17/20
1/1 [==============================] - 2s 2s/step - loss: 0.0072 - last_time_step_mse: 0.0083
Epoch 18/20
1/1 [==============================] - 2s 2s/step - loss: 0.0071 - last_time_step_mse: 0.0053
Epoch 19/20
1/1 [==============================] - 2s 2s/step - loss: 0.0058 - last_time_step_mse: 0.0045
Epoch 20/20
1/1 [==============================] - 2s 2s/step - loss: 0.0046 - last_time_step_mse: 0.0049
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="use-the-trained-model-to-make-prediction-for-n-steps-ahead-time-increments">
<h4><span class="section-number">12.8.7.1.3. </span>Use the trained model to make prediction for <em>N_STEPS_AHEAD</em> time increments<a class="headerlink" href="#use-the-trained-model-to-make-prediction-for-n-steps-ahead-time-increments" title="Permalink to this headline">¶</a></h4>
<p>Only use the number of points for the predictions that were used for training the neural net (plus the number of steps ahead that we want to predict)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">number_of_records</span> <span class="o">=</span> <span class="n">N_STEPS_TRAINING</span> <span class="o">+</span> <span class="n">N_STEPS_AHEAD</span>
<span class="n">truncated_scaled_data</span> <span class="o">=</span> <span class="n">scaled_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">number_of_records</span><span class="p">)</span>

<span class="n">unfiltered_forecast_training_data</span><span class="p">,</span> <span class="n">unfiltered_forecast_labels</span> <span class="o">=</span> <span class="n">get_neural_net_forecast_sets</span><span class="p">(</span><span class="n">truncated_scaled_data</span><span class="p">,</span> <span class="s1">&#39;Scaled Height&#39;</span><span class="p">,</span> <span class="n">N_STEPS_TRAINING</span><span class="p">,</span> <span class="n">N_STEPS_FORECAST</span><span class="p">,</span> <span class="n">N_STEPS_AHEAD</span> <span class="p">)</span>

<span class="n">unfiltered_forecast_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">unfiltered_forecast_training_data</span><span class="p">)[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="training-on-data-filtered-using-gaussian-mixtures">
<h3><span class="section-number">12.8.7.2. </span>Training on data filtered using Gaussian Mixtures<a class="headerlink" href="#training-on-data-filtered-using-gaussian-mixtures" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id5">
<h4><span class="section-number">12.8.7.2.1. </span>Generate the training set<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cleaned_g_m_training_data</span><span class="p">,</span> <span class="n">cleaned_g_m_training_labels</span> <span class="o">=</span> <span class="n">get_neural_net_training_sets</span><span class="p">(</span><span class="n">g_m_cleaned_data</span><span class="p">,</span> <span class="s1">&#39;Scaled Height&#39;</span><span class="p">,</span> <span class="n">N_STEPS_TRAINING</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h4><span class="section-number">12.8.7.2.2. </span>Create and train the neural network model<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new set of training data based on the cleansed data</span>
<span class="n">cleaned_model</span> <span class="o">=</span> <span class="n">get_neural_net_model</span><span class="p">(</span><span class="n">N_STEPS_AHEAD</span><span class="p">)</span>

<span class="n">cleaned_history</span> <span class="o">=</span> <span class="n">cleaned_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cleaned_g_m_training_data</span><span class="p">,</span> <span class="n">cleaned_g_m_training_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/20
1/1 [==============================] - 5s 5s/step - loss: 0.1053 - last_time_step_mse: 0.1057
Epoch 2/20
1/1 [==============================] - 2s 2s/step - loss: 0.0903 - last_time_step_mse: 0.0916
Epoch 3/20
1/1 [==============================] - 2s 2s/step - loss: 0.0678 - last_time_step_mse: 0.0680
Epoch 4/20
1/1 [==============================] - 2s 2s/step - loss: 0.0424 - last_time_step_mse: 0.0415
Epoch 5/20
1/1 [==============================] - 2s 2s/step - loss: 0.0382 - last_time_step_mse: 0.0425
Epoch 6/20
1/1 [==============================] - 2s 2s/step - loss: 0.0202 - last_time_step_mse: 0.0201
Epoch 7/20
1/1 [==============================] - 2s 2s/step - loss: 0.0108 - last_time_step_mse: 0.0116
Epoch 8/20
1/1 [==============================] - 2s 2s/step - loss: 0.0086 - last_time_step_mse: 0.0087
Epoch 9/20
1/1 [==============================] - 2s 2s/step - loss: 0.0065 - last_time_step_mse: 0.0053
Epoch 10/20
1/1 [==============================] - 2s 2s/step - loss: 0.0046 - last_time_step_mse: 0.0044
Epoch 11/20
1/1 [==============================] - 2s 2s/step - loss: 0.0047 - last_time_step_mse: 0.0044
Epoch 12/20
1/1 [==============================] - 2s 2s/step - loss: 0.0052 - last_time_step_mse: 0.0039
Epoch 13/20
1/1 [==============================] - 2s 2s/step - loss: 0.0044 - last_time_step_mse: 0.0039
Epoch 14/20
1/1 [==============================] - 2s 2s/step - loss: 0.0032 - last_time_step_mse: 0.0030
Epoch 15/20
1/1 [==============================] - 2s 2s/step - loss: 0.0029 - last_time_step_mse: 0.0026
Epoch 16/20
1/1 [==============================] - 2s 2s/step - loss: 0.0031 - last_time_step_mse: 0.0028
Epoch 17/20
1/1 [==============================] - 2s 2s/step - loss: 0.0030 - last_time_step_mse: 0.0048
Epoch 18/20
1/1 [==============================] - 2s 2s/step - loss: 0.0024 - last_time_step_mse: 0.0023
Epoch 19/20
1/1 [==============================] - 2s 2s/step - loss: 0.0019 - last_time_step_mse: 0.0018
Epoch 20/20
1/1 [==============================] - 2s 2s/step - loss: 0.0018 - last_time_step_mse: 0.0021
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">cleaned_g_m_training_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">N_STEPS_TRAINING</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_97_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_97_0.png" />
</div>
</div>
<p>The plot above shows the cleaned/filtered data. Note that The large spikes have been completely removed.</p>
</div>
<div class="section" id="id7">
<h4><span class="section-number">12.8.7.2.3. </span>Use the trained model to make prediction for <em>N_STEPS_AHEAD</em> time increments<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">number_of_records</span> <span class="o">=</span> <span class="n">N_STEPS_TRAINING</span> <span class="o">+</span> <span class="n">N_STEPS_AHEAD</span>
<span class="n">truncated_g_m_cleaned_data</span> <span class="o">=</span> <span class="n">g_m_cleaned_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">number_of_records</span><span class="p">)</span>

<span class="n">g_m_filtered_forecast_training_data</span><span class="p">,</span> <span class="n">g_m_filtered_forecast_training_labels</span> <span class="o">=</span> <span class="n">get_neural_net_forecast_sets</span><span class="p">(</span><span class="n">truncated_g_m_cleaned_data</span><span class="p">,</span> <span class="s1">&#39;Scaled Height&#39;</span><span class="p">,</span> <span class="n">N_STEPS_TRAINING</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_STEPS_FORECAST</span><span class="p">,</span> <span class="n">N_STEPS_AHEAD</span><span class="p">)</span>

<span class="n">g_m_filtered_forecast_predictions</span> <span class="o">=</span> <span class="n">cleaned_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">g_m_filtered_forecast_training_data</span><span class="p">)[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="training-on-data-filtered-using-k-means">
<h3><span class="section-number">12.8.7.3. </span>Training on data filtered using K-Means<a class="headerlink" href="#training-on-data-filtered-using-k-means" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id8">
<h4><span class="section-number">12.8.7.3.1. </span>Generate the training set<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans_cleaned_training_data</span><span class="p">,</span> <span class="n">kmeans_cleaned_training_labels</span> <span class="o">=</span> <span class="n">get_neural_net_training_sets</span><span class="p">(</span><span class="n">cleaned_kmeans_data</span><span class="p">,</span> <span class="s1">&#39;Scaled Height&#39;</span><span class="p">,</span> <span class="n">N_STEPS_TRAINING</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id9">
<h4><span class="section-number">12.8.7.3.2. </span>#### Create and train the neural network model<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new set of training data based on the cleaned data from the K-means algorithm</span>
<span class="n">kmeans_cleaned_model</span> <span class="o">=</span> <span class="n">get_neural_net_model</span><span class="p">(</span><span class="n">N_STEPS_AHEAD</span><span class="p">)</span>

<span class="n">kmeans_cleaned_history</span> <span class="o">=</span> <span class="n">kmeans_cleaned_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">kmeans_cleaned_training_data</span><span class="p">,</span> <span class="n">kmeans_cleaned_training_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/20
1/1 [==============================] - 5s 5s/step - loss: 0.1281 - last_time_step_mse: 0.1285
Epoch 2/20
1/1 [==============================] - 2s 2s/step - loss: 0.1109 - last_time_step_mse: 0.1125
Epoch 3/20
1/1 [==============================] - 2s 2s/step - loss: 0.0846 - last_time_step_mse: 0.0852
Epoch 4/20
1/1 [==============================] - 2s 2s/step - loss: 0.0528 - last_time_step_mse: 0.0524
Epoch 5/20
1/1 [==============================] - 2s 2s/step - loss: 0.0480 - last_time_step_mse: 0.0523
Epoch 6/20
1/1 [==============================] - 2s 2s/step - loss: 0.0271 - last_time_step_mse: 0.0269
Epoch 7/20
1/1 [==============================] - 2s 2s/step - loss: 0.0136 - last_time_step_mse: 0.0144
Epoch 8/20
1/1 [==============================] - 2s 2s/step - loss: 0.0105 - last_time_step_mse: 0.0109
Epoch 9/20
1/1 [==============================] - 2s 2s/step - loss: 0.0084 - last_time_step_mse: 0.0070
Epoch 10/20
1/1 [==============================] - 2s 2s/step - loss: 0.0059 - last_time_step_mse: 0.0062
Epoch 11/20
1/1 [==============================] - 2s 2s/step - loss: 0.0055 - last_time_step_mse: 0.0050
Epoch 12/20
1/1 [==============================] - 2s 2s/step - loss: 0.0064 - last_time_step_mse: 0.0048
Epoch 13/20
1/1 [==============================] - 2s 2s/step - loss: 0.0060 - last_time_step_mse: 0.0051
Epoch 14/20
1/1 [==============================] - 2s 2s/step - loss: 0.0043 - last_time_step_mse: 0.0041
Epoch 15/20
1/1 [==============================] - 2s 2s/step - loss: 0.0036 - last_time_step_mse: 0.0034
Epoch 16/20
1/1 [==============================] - 2s 2s/step - loss: 0.0038 - last_time_step_mse: 0.0036
Epoch 17/20
1/1 [==============================] - 2s 2s/step - loss: 0.0038 - last_time_step_mse: 0.0065
Epoch 18/20
1/1 [==============================] - 2s 2s/step - loss: 0.0033 - last_time_step_mse: 0.0032
Epoch 19/20
1/1 [==============================] - 2s 2s/step - loss: 0.0025 - last_time_step_mse: 0.0025
Epoch 20/20
1/1 [==============================] - 2s 2s/step - loss: 0.0022 - last_time_step_mse: 0.0024
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id10">
<h4><span class="section-number">12.8.7.3.3. </span>Use the trained model to make prediction for <em>N_STEPS_AHEAD</em> time increments<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">number_of_records</span> <span class="o">=</span> <span class="n">N_STEPS_TRAINING</span> <span class="o">+</span> <span class="n">N_STEPS_AHEAD</span>
<span class="n">truncated_kmeans_cleaned_data</span> <span class="o">=</span> <span class="n">cleaned_kmeans_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">number_of_records</span><span class="p">)</span>

<span class="n">kmeans_filtered_forecast_training_data</span><span class="p">,</span> <span class="n">kmeans_filtered_forecast_training_labels</span> <span class="o">=</span> <span class="n">get_neural_net_forecast_sets</span><span class="p">(</span><span class="n">truncated_kmeans_cleaned_data</span><span class="p">,</span> <span class="s1">&#39;Scaled Height&#39;</span><span class="p">,</span> <span class="n">N_STEPS_TRAINING</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_STEPS_FORECAST</span><span class="p">,</span> <span class="n">N_STEPS_AHEAD</span><span class="p">)</span>

<span class="n">kmeans_filtered_forecast_predictions</span> <span class="o">=</span> <span class="n">kmeans_cleaned_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">kmeans_filtered_forecast_training_data</span><span class="p">)[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="plots-of-unfiltered-data">
<h3><span class="section-number">12.8.7.4. </span>Plots of unfiltered data<a class="headerlink" href="#plots-of-unfiltered-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the entire training set </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">unfiltered_training_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">N_STEPS_TRAINING</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_109_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_109_0.png" />
</div>
</div>
<p>This is the plot for the unfiltered data. Note the large spikes!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the last n_step_forecast</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plot_multiple_forecasts</span><span class="p">(</span><span class="n">unfiltered_forecast_training_data</span><span class="p">,</span> <span class="n">unfiltered_forecast_labels</span><span class="p">,</span> <span class="n">unfiltered_forecast_predictions</span><span class="p">,</span> <span class="n">N_STEPS_FORECAST</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_111_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_111_0.png" />
</div>
</div>
<p>This plot compares how well the model did at predicting future time series points. The actual values from the time series are shown in red underneath the dark blue Xs indicating predictions made by the neural net trained on the unfiltered (uncleaned) data. Note that the forecast points aren’t particularly tightly clustered around the actual values.</p>
</div>
<div class="section" id="plots-of-gaussian-mixtures-cleaned-filtered-data">
<h3><span class="section-number">12.8.7.5. </span>Plots of Gaussian Mixtures cleaned / filtered data<a class="headerlink" href="#plots-of-gaussian-mixtures-cleaned-filtered-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the entire training set for comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">cleaned_g_m_training_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">N_STEPS_TRAINING</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_114_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_114_0.png" />
</div>
</div>
<p>The plot of the data cleaned by the Gaussian Mixtures algorithm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plot_multiple_forecasts</span><span class="p">(</span><span class="n">g_m_filtered_forecast_training_data</span><span class="p">,</span> <span class="n">g_m_filtered_forecast_training_labels</span><span class="p">,</span> <span class="n">g_m_filtered_forecast_predictions</span><span class="p">,</span> <span class="n">N_STEPS_FORECAST</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_116_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_116_0.png" />
</div>
</div>
<p>The comparison plot for the predictions made by the neural network trained on data filtered by the Gaussian Mixtures algorithm. The forecast points are much closer to the actual values than in the corresponding plot for the unfiltered data!</p>
</div>
<div class="section" id="plots-of-k-means-cleaned-filtered-data">
<h3><span class="section-number">12.8.7.6. </span>Plots of K-means cleaned / filtered data<a class="headerlink" href="#plots-of-k-means-cleaned-filtered-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the entire training set for comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plot_series</span><span class="p">(</span><span class="n">kmeans_cleaned_training_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">N_STEPS_TRAINING</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_119_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_119_0.png" />
</div>
</div>
<p>The plot of the data cleaned by the K-means algorithm. Note that visually it appears to be even more smooth than the plot of the data filtered using Gaussian Mixtures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plot_multiple_forecasts</span><span class="p">(</span><span class="n">kmeans_filtered_forecast_training_data</span><span class="p">,</span> <span class="n">kmeans_filtered_forecast_training_labels</span><span class="p">,</span> <span class="n">kmeans_filtered_forecast_predictions</span><span class="p">,</span> <span class="n">N_STEPS_FORECAST</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_121_0.png" src="../../_images/MD_01_TZVOLCANO_Unsupervised_AI_Anomaly_Detection_121_0.png" />
</div>
</div>
<p>The comparison plot for the predictions made by neural network trained on the data filtered by the K-mean algorithm. The forecast points are again closer to the actual values… but perhaps not quite as close as seen for the Gaussian Mixtures filtered data.</p>
</div>
</div>
<div class="section" id="compare-the-accuracy-of-the-prediction-made-by-the-different-trained-models">
<h2><span class="section-number">12.8.8. </span>Compare the accuracy of the prediction made by the different trained models<a class="headerlink" href="#compare-the-accuracy-of-the-prediction-made-by-the-different-trained-models" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-mse-of-the-unmodified-data">
<h3><span class="section-number">12.8.8.1. </span>The MSE of the unmodified data<a class="headerlink" href="#the-mse-of-the-unmodified-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">unfiltered_forecast_labels</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">unfiltered_forecast_predictions</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="n">mse</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean squared error for the unmodified data: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean squared error for the unmodified data: 0.0052735237
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-mse-of-the-gaussian-mixtures-cleaned-data">
<h3><span class="section-number">12.8.8.2. </span>The MSE of the Gaussian Mixtures cleaned data<a class="headerlink" href="#the-mse-of-the-gaussian-mixtures-cleaned-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g_m_cleaned_mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">g_m_filtered_forecast_training_labels</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">g_m_filtered_forecast_predictions</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean squared error for the data cleaned using Gaussian Mixtures: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">g_m_cleaned_mse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean squared error for the data cleaned using Gaussian Mixtures: 0.0017369246
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-mse-of-the-k-means-cleaned-data">
<h3><span class="section-number">12.8.8.3. </span>The MSE of the K-Means cleaned data<a class="headerlink" href="#the-mse-of-the-k-means-cleaned-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans_cleaned_mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">kmeans_filtered_forecast_training_labels</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">kmeans_filtered_forecast_predictions</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean squared error for the data cleaned using K-Means: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kmeans_cleaned_mse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean squared error for the data cleaned using K-Means: 0.0023650725
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="percent-improvement-in-neural-network-predictions">
<h3><span class="section-number">12.8.8.4. </span>Percent improvement in neural network predictions<a class="headerlink" href="#percent-improvement-in-neural-network-predictions" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g_m_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">g_m_cleaned_mse</span><span class="o">/</span><span class="n">mse</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
<span class="n">kmeans_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">kmeans_cleaned_mse</span><span class="o">/</span><span class="n">mse</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">For this run, the removal of the identified data points  results in a &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">g_m_diff</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;% (Gaussian Mixtures)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">kmeans_diff</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;% (K-means)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;reduced error rate in predicting values using the trained neural net</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For this run, the removal of the identified data points  results in a 
67% (Gaussian Mixtures)
55% (K-means)
reduced error rate in predicting values using the trained neural net
</pre></div>
</div>
</div>
</div>
<p>Both the Gaussian Mixtures and the K-means approach seem to significantly improve the prediction accuracy of the neural networks.</p>
</div>
</div>
</div>
<div class="section" id="references">
<h1><span class="section-number">12.9. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<p>Daniels, M. D., Kerkez, B., Chandrasekar, V., Graves, S., Stamps, D. S., Martin, C., Dye, M., Gooch, R., Bartos, M., Jones, J., Keiser, K., 2016, Cloud-Hosted Real-time Data Services for the Geosciences (CHORDS) software (Version 0.9). UCAR/NCAR - Earth Observing Laboratory. <a class="reference external" href="https://doi.org/10.5065/d6v1236q">https://doi.org/10.5065/d6v1236q</a></p>
<p>Kerkez, B., Daniels, M., Graves, S., Chandrasekar, V., Keiser, K., Martin, C., … Vernon, F. (2016). Cloud Hosted Real‐time Data Services for the Geosciences (CHORDS). Geoscience Data Journal, 3(1), 4–8. doi:10.1002/gdj3.36</p>
<p>Stamps, D. S., Saria, E., Ji, K. H., Jones, J. R., Ntambila, D., Daniels, M. D., &amp; Mencin, D. (2016). Real-time data from the Tanzania Volcano Observatory at the Ol Doinyo Lengai volcano in Tanzania (TZVOLCANO). UCAR/NCAR - Earth Observing Laboratory. <a class="reference external" href="https://doi.org/10.5065/d6p849bm">https://doi.org/10.5065/d6p849bm</a></p>
<p>Géron, A. (2019). Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems (2nd ed.). O’Reilly.</p>
<p>Wikipedia contributors. (2021, February 3). Feature (machine learning). Wikipedia. <a class="reference external" href="https://en.wikipedia.org/wiki/Feature_(machine_learning)#cite_note-ml-1">https://en.wikipedia.org/wiki/Feature_(machine_learning)#cite_note-ml-1</a></p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/ec21_dye_etal"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="README.html" title="previous page"><span class="section-number">7. </span>Toward autonomous detection of anomalous GNSS data via applied unsupervised artificial intelligence</a>
    <a class='right-next' id="next-link" href="../ec21_garzon_etal/README.html" title="next page"><span class="section-number">13. </span>Exploring Research Data Repositories with geoextent.</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By EarthCube Office<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>